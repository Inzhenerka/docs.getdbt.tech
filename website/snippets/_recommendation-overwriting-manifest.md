Чтобы предотвратить перезапись `manifest.json` до того, как dbt прочитает его для определения изменений, обновите ваш workflow, используя один из следующих методов:

- Переместите `manifest.json` в отдельную папку (например, `state/`) после того, как dbt сгенерирует его в папке `target/`. Это гарантирует, что dbt будет ссылаться на корректно сохранённое состояние, а не сравнивать текущее состояние с только что перезаписанной версией. Также это позволяет избежать проблем, возникающих при установке `--state` и `--target-path` в одно и то же место, что может приводить к неидемпотентному поведению.

- Записывайте manifest в другой `--target-path` на этапе сборки (где dbt обычно генерирует `target/manifest.json`) либо сохраните его до того, как он будет перезаписан в ходе выполнения задания, чтобы избежать проблем с определением изменений. Это позволяет dbt корректно обнаруживать изменения вместо сравнения текущего состояния с только что перезаписанной версией.

- Передайте флаг `--no-write-json` на этапе воспроизведения:  
  `dbt ls --no-write-json --select state:modified --state target`.
