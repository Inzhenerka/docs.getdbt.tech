Чтобы `manifest.json` не перезаписывался до того, как dbt прочитает его для определения изменений, обновите ваш workflow одним из следующих способов:

- Переместите `manifest.json` в отдельную папку (например, `state/`) после того, как dbt сгенерирует его в папке `target/`. Это гарантирует, что dbt будет ссылаться на корректно сохранённое состояние, вместо сравнения текущего состояния с только что перезаписанной версией. Это также помогает избежать проблем, возникающих при указании `--state` и `--target-path` на одну и ту же директорию, что может приводить к неидемпотентному поведению.


- Записывайте manifest в другой `--target-path` на этапе сборки (когда dbt генерирует `target/manifest.json`) или до того, как он будет перезаписан во время выполнения job, чтобы избежать проблем с определением изменений. Это позволит dbt обнаруживать изменения, вместо сравнения текущего состояния с только что перезаписанной версией.
- Передайте флаг `--no-write-json`: `dbt ls --no-write-json --select state:modified --state target` на этапе воспроизведения.
