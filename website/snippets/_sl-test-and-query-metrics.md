Для работы с метриками в dbt у вас есть несколько инструментов для валидации или выполнения команд. Вот как вы можете тестировать и запрашивать метрики в зависимости от вашей настройки:

- [**Пользователи dbt Cloud IDE**](#dbt-cloud-ide-users) &mdash; Выполняйте [команды MetricFlow](/docs/build/metricflow-commands#metricflow-commands) непосредственно в [dbt Cloud IDE](/docs/cloud/dbt-cloud-ide/develop-in-the-cloud) для запроса/предварительного просмотра метрик. Просматривайте метрики визуально на вкладке **Lineage**.
- [**Пользователи dbt Cloud CLI**](#dbt-cloud-cli-users) &mdash; [dbt Cloud CLI](/docs/cloud/cloud-cli-installation) позволяет вам выполнять [команды MetricFlow](/docs/build/metricflow-commands#metricflow-commands) для запроса и предварительного просмотра метрик непосредственно в вашем интерфейсе командной строки.
- **Пользователи dbt Core** &mdash; Используйте MetricFlow CLI для выполнения команд. Хотя это руководство сосредоточено на пользователях dbt Cloud, пользователи dbt Core могут найти подробные инструкции по настройке MetricFlow CLI на странице [команд MetricFlow](/docs/build/metricflow-commands#metricflow-commands). Обратите внимание, что для использования dbt Semantic Layer вам необходимо иметь [аккаунт Team или Enterprise](https://www.getdbt.com/).

Кроме того, вы можете выполнять команды с помощью SQL-клиентов, таких как DataGrip, DBeaver или RazorSQL.

### Пользователи dbt Cloud IDE

Вы можете использовать префикс `dbt sl` перед именем команды для их выполнения в dbt Cloud. Например, чтобы перечислить все метрики, выполните `dbt sl list metrics`. Для полного списка доступных команд MetricFlow в dbt Cloud IDE обратитесь к странице [команд MetricFlow](/docs/build/metricflow-commands#metricflow-commandss).

Кнопка **Status** в dbt Cloud IDE (расположена в правом нижнем углу редактора) отображает статус **Error**, если в определении вашей метрики или семантической модели есть ошибка. Вы можете нажать на кнопку, чтобы увидеть конкретную проблему и решить ее.

После просмотра убедитесь, что вы зафиксировали и объединили свои изменения в вашем проекте.

<Lightbox src="/img/docs/dbt-cloud/semantic-layer/sl-ide-dag.jpg" title="Проверьте ваши метрики, используя вкладку Lineage в IDE." />

### Пользователи dbt Cloud CLI

Этот раздел предназначен для пользователей dbt Cloud CLI. Команды MetricFlow интегрированы с dbt Cloud, что означает, что вы можете выполнять команды MetricFlow, как только установите dbt Cloud CLI. Ваш аккаунт автоматически управляет версионным контролем для вас.

Следуйте следующим шагам, чтобы начать:

1. Установите [dbt Cloud CLI](/docs/cloud/cloud-cli-installation) (если вы еще этого не сделали). Затем перейдите в директорию вашего проекта dbt.
2. Выполните команду dbt, такую как `dbt parse`, `dbt run`, `dbt compile` или `dbt build`. Если вы этого не сделаете, вы получите сообщение об ошибке, начинающееся с: "убедитесь, что вы выполнили артефакты...".
3. MetricFlow строит семантический граф и генерирует файл `semantic_manifest.json` в dbt Cloud, который хранится в директории `/target`. Если вы используете пример Jaffle Shop, выполните `dbt seed && dbt run`, чтобы убедиться, что необходимые данные находятся в вашей платформе данных перед продолжением.

:::tip Выполните dbt parse, чтобы отразить изменения в метриках
Когда вы вносите изменения в метрики, убедитесь, что вы выполнили `dbt parse` как минимум для обновления dbt Semantic Layer. Это обновляет файл `semantic_manifest.json`, отражая ваши изменения при запросе метрик. Выполняя `dbt parse`, вам не нужно будет перестраивать все модели.
:::

4. Выполните `dbt sl --help`, чтобы подтвердить, что у вас установлен MetricFlow и что вы можете просмотреть доступные команды.
5. Выполните `dbt sl query --metrics <metric_name> --group-by <dimension_name>`, чтобы запросить метрики и измерения. Например, чтобы запросить `order_total` и `order_count` (обе метрики), а затем сгруппировать их по `order_date` (измерение), выполните:

   ```sql
   dbt sl query --metrics order_total,order_count --group-by order_date
   ```
6. Убедитесь, что значения метрик соответствуют вашим ожиданиям. Чтобы лучше понять, как генерируется метрика, вы можете просмотреть сгенерированный SQL, если введете `--compile` в командной строке.
7. Зафиксируйте и объедините изменения в коде, содержащие определения метрик.