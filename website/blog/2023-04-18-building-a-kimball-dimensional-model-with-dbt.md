---
title: "–°–æ–∑–¥–∞–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–Ω–æ–π –º–æ–¥–µ–ª–∏ –ö–∏–º–±–∞–ª–ª–∞ —Å –ø–æ–º–æ—â—å—é dbt"
description: "–û—Å–≤–æ–π—Ç–µ —Ä–∞–∑–º–µ—Ä–Ω–æ–µ –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ dbt —Å –ø–æ–º–æ—â—å—é —ç—Ç–æ–≥–æ –ø–æ—à–∞–≥–æ–≤–æ–≥–æ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–∞ –æ—Ç –î–∂–æ–Ω–∞—Ç–∞–Ω–∞ –ù–µ–æ –∏–∑ Canva."
slug: kimball-dimensional-model

authors: [jonathan_neo]

tags: [–∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–æ–µ —Ä–µ–º–µ—Å–ª–æ, dbt —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–∞]
hide_table_of_contents: false

date: 2023-04-20
is_featured: true
---

<Term id="dimensional-modeling">–†–∞–∑–º–µ—Ä–Ω–æ–µ –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏–µ</Term> ‚Äî —ç—Ç–æ –æ–¥–Ω–∞ –∏–∑ –º–Ω–æ–≥–∏—Ö —Ç–µ—Ö–Ω–∏–∫ –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö, –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–∞–º–∏ –ø–æ –¥–∞–Ω–Ω—ã–º –¥–ª—è –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ –∏ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∏. –î—Ä—É–≥–∏–µ —Ç–µ—Ö–Ω–∏–∫–∏ –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –≤–∫–ª—é—á–∞—é—Ç Data Vault (DV), Third Normal Form (3NF) –∏ One Big Table (OBT), —á—Ç–æ–±—ã –Ω–∞–∑–≤–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ.

<Lightbox src="/img/blog/2023-04-18-building-a-kimball-dimensional-model-with-dbt/data-modelling.png" width="85%" title="–¢–µ—Ö–Ω–∏–∫–∏ –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –Ω–∞ —à–∫–∞–ª–µ –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏ –∏ –¥–µ–Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏"/>

–•–æ—Ç—è –∞–∫—Ç—É–∞–ª—å–Ω–æ—Å—Ç—å —Ä–∞–∑–º–µ—Ä–Ω–æ–≥–æ –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏—è [–æ–±—Å—É–∂–¥–∞–µ—Ç—Å—è —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–∞–º–∏ –ø–æ –¥–∞–Ω–Ω—ã–º](https://discourse.getdbt.com/t/is-kimball-dimensional-modeling-still-relevant-in-a-modern-data-warehouse/225/6), –æ–Ω–æ –ø–æ-–ø—Ä–µ–∂–Ω–µ–º—É –æ—Å—Ç–∞–µ—Ç—Å—è –æ–¥–Ω–æ–π –∏–∑ –Ω–∞–∏–±–æ–ª–µ–µ —à–∏—Ä–æ–∫–æ –ø—Ä–∏–º–µ–Ω—è–µ–º—ã—Ö —Ç–µ—Ö–Ω–∏–∫ –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∏.

–ù–µ—Å–º–æ—Ç—Ä—è –Ω–∞ —Å–≤–æ—é –ø–æ–ø—É–ª—è—Ä–Ω–æ—Å—Ç—å, —Ä–µ—Å—É—Ä—Å—ã –ø–æ —Å–æ–∑–¥–∞–Ω–∏—é —Ä–∞–∑–º–µ—Ä–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º dbt –æ—Å—Ç–∞—é—Ç—Å—è —Å–∫—É–¥–Ω—ã–º–∏ –∏ –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–µ—Ç–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏. –≠—Ç–æ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø—Ä–∏–∑–≤–∞–Ω–æ —Ä–µ—à–∏—Ç—å —ç—Ç—É –ø—Ä–æ–±–ª–µ–º—É, –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–∏–≤ –æ–∫–æ–Ω—á–∞—Ç–µ–ª—å–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ —Ä–∞–∑–º–µ—Ä–Ω–æ–º—É –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏—é —Å dbt.

–ö –∫–æ–Ω—Ü—É —ç—Ç–æ–≥–æ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–∞ –≤—ã:

- –ü–æ–π–º–µ—Ç–µ –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏ —Ä–∞–∑–º–µ—Ä–Ω–æ–≥–æ –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏—è
- –ù–∞—Å—Ç—Ä–æ–∏—Ç–µ –º–∞–∫–µ—Ç–Ω—ã–π –ø—Ä–æ–µ–∫—Ç dbt –∏ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö
- –û–ø—Ä–µ–¥–µ–ª–∏—Ç–µ –±–∏–∑–Ω–µ—Å-–ø—Ä–æ—Ü–µ—Å—Å –¥–ª—è –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏—è
- –û–ø—Ä–µ–¥–µ–ª–∏—Ç–µ —Ç–∞–±–ª–∏—Ü—ã —Ñ–∞–∫—Ç–æ–≤ –∏ –∏–∑–º–µ—Ä–µ–Ω–∏–π
- –°–æ–∑–¥–∞–¥–∏—Ç–µ —Ç–∞–±–ª–∏—Ü—ã –∏–∑–º–µ—Ä–µ–Ω–∏–π
- –°–æ–∑–¥–∞–¥–∏—Ç–µ —Ç–∞–±–ª–∏—Ü—É —Ñ–∞–∫—Ç–æ–≤
- –ó–∞–¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä—É–µ—Ç–µ –æ—Ç–Ω–æ—à–µ–Ω–∏—è —Ä–∞–∑–º–µ—Ä–Ω–æ–π –º–æ–¥–µ–ª–∏
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç–µ —Ä–∞–∑–º–µ—Ä–Ω—É—é –º–æ–¥–µ–ª—å

<!--truncate-->

## –†–∞–∑–º–µ—Ä–Ω–æ–µ –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏–µ

–†–∞–∑–º–µ—Ä–Ω–æ–µ –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏–µ ‚Äî —ç—Ç–æ —Ç–µ—Ö–Ω–∏–∫–∞, –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–Ω–∞—è –†–∞–ª—å—Ñ–æ–º –ö–∏–º–±–∞–ª–ª–æ–º –≤ 1996 –≥–æ–¥—É –≤ –µ–≥–æ –∫–Ω–∏–≥–µ [The Data Warehouse Toolkit](https://www.kimballgroup.com/data-warehouse-business-intelligence-resources/books/data-warehouse-dw-toolkit/).

–¶–µ–ª—å —Ä–∞–∑–º–µ—Ä–Ω–æ–≥–æ –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏—è ‚Äî –≤–∑—è—Ç—å —Å—ã—Ä—ã–µ –¥–∞–Ω–Ω—ã–µ –∏ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞—Ç—å –∏—Ö –≤ —Ç–∞–±–ª–∏—Ü—ã —Ñ–∞–∫—Ç–æ–≤ –∏ –∏–∑–º–µ—Ä–µ–Ω–∏–π, –∫–æ—Ç–æ—Ä—ã–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é—Ç –±–∏–∑–Ω–µ—Å.

<Lightbox src="/img/blog/2023-04-18-building-a-kimball-dimensional-model-with-dbt/3nf-to-dimensional-model.png" title="–°—ã—Ä—ã–µ –¥–∞–Ω–Ω—ã–µ 3NF –≤ —Ä–∞–∑–º–µ—Ä–Ω—É—é –º–æ–¥–µ–ª—å"/>

–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ —Ä–∞–∑–º–µ—Ä–Ω–æ–≥–æ –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏—è:

- **–ü—Ä–æ—Å—Ç–∞—è –º–æ–¥–µ–ª—å –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∏**: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º —Ä–∞–∑–º–µ—Ä–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π –Ω–µ –Ω—É–∂–Ω–æ –≤—ã–ø–æ–ª–Ω—è—Ç—å —Å–ª–æ–∂–Ω—ã–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è –ø—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ —Ä–∞–∑–º–µ—Ä–Ω–æ–π –º–æ–¥–µ–ª–∏ –¥–ª—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∏. –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π –º–µ–∂–¥—É —Ç–∞–±–ª–∏—Ü–∞–º–∏ —Ñ–∞–∫—Ç–æ–≤ –∏ –∏–∑–º–µ—Ä–µ–Ω–∏–π —É–ø—Ä–æ—â–∞–µ—Ç—Å—è –∑–∞ —Å—á–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Å—É—Ä—Ä–æ–≥–∞—Ç–Ω—ã—Ö –∫–ª—é—á–µ–π.
- <Term id="dry">–ù–µ –ø–æ–≤—Ç–æ—Ä—è–π—Å—è</Term>: –ò–∑–º–µ—Ä–µ–Ω–∏—è –º–æ–≥—É—Ç –±—ã—Ç—å –ª–µ–≥–∫–æ –ø–æ–≤—Ç–æ—Ä–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω—ã —Å –¥—Ä—É–≥–∏–º–∏ —Ç–∞–±–ª–∏—Ü–∞–º–∏ —Ñ–∞–∫—Ç–æ–≤, —á—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è —É—Å–∏–ª–∏–π –∏ –ª–æ–≥–∏–∫–∏ –∫–æ–¥–∞. –ü–æ–≤—Ç–æ—Ä–Ω–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –∏–∑–º–µ—Ä–µ–Ω–∏—è –Ω–∞–∑—ã–≤–∞—é—Ç—Å—è —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω—ã–º–∏ –∏–∑–º–µ—Ä–µ–Ω–∏—è–º–∏.
- **–ë—ã—Å—Ç—Ä–æ–µ –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö**: –ê–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–µ –∑–∞–ø—Ä–æ—Å—ã, –≤—ã–ø–æ–ª–Ω—è–µ–º—ã–µ –ø—Ä–æ—Ç–∏–≤ —Ä–∞–∑–º–µ—Ä–Ω–æ–π –º–æ–¥–µ–ª–∏, –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ –±—ã—Å—Ç—Ä–µ–µ, —á–µ–º –º–æ–¥–µ–ª—å 3NF, –ø–æ—Å–∫–æ–ª—å–∫—É –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö, —Ç–∞–∫–∏–µ –∫–∞–∫ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è –∏ –∞–≥—Ä–µ–≥–∞—Ü–∏–∏, —É–∂–µ –ø—Ä–∏–º–µ–Ω–µ–Ω—ã.
- **–¢–µ—Å–Ω–æ–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ –±–∏–∑–Ω–µ—Å-–ø—Ä–æ—Ü–µ—Å—Å–∞–º–∏**: –ë–∏–∑–Ω–µ—Å-–ø—Ä–æ—Ü–µ—Å—Å—ã –∏ –º–µ—Ç—Ä–∏–∫–∏ –º–æ–¥–µ–ª–∏—Ä—É—é—Ç—Å—è –∏ —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞—é—Ç—Å—è –∫–∞–∫ —á–∞—Å—Ç—å —Ä–∞–∑–º–µ—Ä–Ω–æ–≥–æ –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏—è. –≠—Ç–æ –ø–æ–º–æ–≥–∞–µ—Ç –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å, —á—Ç–æ —Å–º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –ª–µ–≥–∫–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å.

–¢–µ–ø–µ—Ä—å, –∫–æ–≥–¥–∞ –º—ã –ø–æ–Ω–∏–º–∞–µ–º –æ–±—â–∏–µ –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏ –∏ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ —Ä–∞–∑–º–µ—Ä–Ω–æ–≥–æ –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏—è, –¥–∞–≤–∞–π—Ç–µ –ø–µ—Ä–µ–π–¥–µ–º –∫ –ø—Ä–∞–∫—Ç–∏–∫–µ –∏ —Å–æ–∑–¥–∞–¥–∏–º –Ω–∞—à—É –ø–µ—Ä–≤—É—é —Ä–∞–∑–º–µ—Ä–Ω—É—é –º–æ–¥–µ–ª—å —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º dbt.

## –ß–∞—Å—Ç—å 1: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞ dbt –∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

### –®–∞–≥ 1: –ü–µ—Ä–µ–¥ –Ω–∞—á–∞–ª–æ–º —Ä–∞–±–æ—Ç—ã

–ü–µ—Ä–µ–¥ –Ω–∞—á–∞–ª–æ–º —Ä–∞–±–æ—Ç—ã:

- –£ –≤–∞—Å –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –ª–∏–±–æ DuckDB, –ª–∏–±–æ PostgreSQL. –í—ã–±–µ—Ä–∏—Ç–µ –æ–¥–∏–Ω –∏ –∑–∞–≥—Ä—É–∑–∏—Ç–µ –∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö, –∏—Å–ø–æ–ª—å–∑—É—è –æ–¥–Ω—É –∏–∑ —Å–ª–µ–¥—É—é—â–∏—Ö —Å—Å—ã–ª–æ–∫:
    - –ó–∞–≥—Ä—É–∑–∏—Ç—å [DuckDB](https://duckdb.org/docs/installation/index)
    - –ó–∞–≥—Ä—É–∑–∏—Ç—å [PostgreSQL](https://www.postgresql.org/download/)
- –£ –≤–∞—Å –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω Python 3.8 –∏–ª–∏ –≤—ã—à–µ
- –£ –≤–∞—Å –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ –≤–µ—Ä—Å–∏—è dbt 1.3.0 –∏–ª–∏ –≤—ã—à–µ
- –í—ã –¥–æ–ª–∂–Ω—ã –∏–º–µ—Ç—å –±–∞–∑–æ–≤–æ–µ –ø–æ–Ω–∏–º–∞–Ω–∏–µ [SQL](https://www.sqltutorial.org/)
- –í—ã –¥–æ–ª–∂–Ω—ã –∏–º–µ—Ç—å –±–∞–∑–æ–≤–æ–µ –ø–æ–Ω–∏–º–∞–Ω–∏–µ [dbt](https://docs.getdbt.tech/guides)

### –®–∞–≥ 2: –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è

–ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ [—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π github](https://github.com/Data-Engineer-Camp/dbt-dimensional-modelling), –≤—ã–ø–æ–ª–Ω–∏–≤ —ç—Ç—É –∫–æ–º–∞–Ω–¥—É –≤ –≤–∞—à–µ–º —Ç–µ—Ä–º–∏–Ω–∞–ª–µ:

```text
git clone https://github.com/Data-Engineer-Camp/dbt-dimensional-modelling.git
cd dbt-dimensional-modelling/adventureworks
```

### –®–∞–≥ 3: –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∞–¥–∞–ø—Ç–µ—Ä–æ–≤ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö dbt

–í –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –≤—ã–±—Ä–∞–Ω–Ω–æ–π –≤–∞–º–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π –∞–¥–∞–ø—Ç–µ—Ä –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö:

```text
# —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –∞–¥–∞–ø—Ç–µ—Ä–∞ –¥–ª—è duckdb
python -m pip install dbt-duckdb

# –ò–õ–ò

# —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –∞–¥–∞–ø—Ç–µ—Ä–∞ –¥–ª—è postgresql
python -m pip install dbt-postgres
```

### –®–∞–≥ 4: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—Ä–æ—Ñ–∏–ª—è dbt

–ü—Ä–æ—Ñ–∏–ª—å dbt (—Å–º. `adventureworks/profiles.yml`) —É–∂–µ –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ –Ω–∞—Å—Ç—Ä–æ–µ–Ω –¥–ª—è –≤–∞—Å. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –ø—Ä–∞–≤–∏–ª—å–Ω–æ –Ω–∞ –æ—Å–Ω–æ–≤–µ –≤–∞—à–∏—Ö —É—á–µ—Ç–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö:

```yaml
adventureworks:
  target: duckdb # –æ—Å—Ç–∞–≤—å—Ç–µ —ç—Ç–æ –∫–∞–∫ duckdb –∏–ª–∏ –∏–∑–º–µ–Ω–∏—Ç–µ –Ω–∞ –≤—ã–±—Ä–∞–Ω–Ω—É—é –≤–∞–º–∏ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö

  # –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö: duckdb, postgres 
  outputs:
    duckdb: 
     type: duckdb
     path: target/adventureworks.duckdb
     threads: 12

    postgres:  
      type: postgres
      host: localhost
      user: postgres
      password: postgres
      port: 5432
      dbname: adventureworks # —Å–æ–∑–¥–∞–π—Ç–µ —ç—Ç—É –ø—É—Å—Ç—É—é –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö –∑–∞—Ä–∞–Ω–µ–µ 
      schema: dbo
      threads: 12
```

### –®–∞–≥ 5: –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π dbt

–ú—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º –ø–∞–∫–µ—Ç—ã, —Ç–∞–∫–∏–µ –∫–∞–∫ [dbt_utils](https://hub.getdbt.com/dbt-labs/dbt_utils/latest/), –≤ —ç—Ç–æ–º –ø—Ä–æ–µ–∫—Ç–µ, –∏ –Ω–∞–º –Ω—É–∂–Ω–æ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ –¥–ª—è —ç—Ç–æ–≥–æ –ø–∞–∫–µ—Ç–∞, –≤—ã–ø–æ–ª–Ω–∏–≤ –∫–æ–º–∞–Ω–¥—É:

```
dbt deps 
```

### –®–∞–≥ 6: –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –≤–∞—à–µ–π –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

–ú—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º [dbt seeds](https://docs.getdbt.tech/docs/build/seeds) (—Å–º. `adventureworks/seeds/*`) –¥–ª—è –≤—Å—Ç–∞–≤–∫–∏ –¥–∞–Ω–Ω—ã—Ö AdventureWorks –≤ –≤–∞—à—É –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö:

```text
# –∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ duckdb 
dbt seed --target duckdb

# –∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ postgres
dbt seed --target postgres
```

### –®–∞–≥ 7: –ò–∑—É—á–µ–Ω–∏–µ —Å—Ö–µ–º—ã –∏—Å—Ç–æ—á–Ω–∏–∫–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

–í—Å–µ –¥–∞–Ω–Ω—ã–µ, —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –±–∏–∑–Ω–µ—Å–æ–º, —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö OLTP. –î–∏–∞–≥—Ä–∞–º–º–∞ —Å—É—â–Ω–æ—Å—Ç–µ–π –∏ —Å–≤—è–∑–µ–π (ERD) –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–∞ –≤–∞–º.

–ò–∑—É—á–∏—Ç–µ —Å—Ö–µ–º—É –∏—Å—Ç–æ—á–Ω–∏–∫–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –Ω–∏–∂–µ, —É–¥–µ–ª—è—è –æ—Å–æ–±–æ–µ –≤–Ω–∏–º–∞–Ω–∏–µ:

- –¢–∞–±–ª–∏—Ü–∞–º
- –ö–ª—é—á–∞–º
- –û—Ç–Ω–æ—à–µ–Ω–∏—è–º

<Lightbox src="/img/blog/2023-04-18-building-a-kimball-dimensional-model-with-dbt/source-schema.png" width="85%" title="–°—Ö–µ–º–∞ –∏—Å—Ç–æ—á–Ω–∏–∫–∞"/>

### –®–∞–≥ 8: –ó–∞–ø—Ä–æ—Å —Ç–∞–±–ª–∏—Ü

–ü–æ–ª—É—á–∏—Ç–µ –ª—É—á—à–µ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –æ —Ç–æ–º, –∫–∞–∫ –≤—ã–≥–ª—è–¥—è—Ç –∑–∞–ø–∏—Å–∏, –≤—ã–ø–æ–ª–Ω—è—è –æ–ø–µ—Ä–∞—Ç–æ—Ä—ã select —Å –ø–æ–º–æ—â—å—é SQL-—Ä–µ–¥–∞–∫—Ç–æ—Ä–∞ –≤–∞—à–µ–π –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö.

–ù–∞–ø—Ä–∏–º–µ—Ä:

```sql
select * from sales.salesorderheader limit 10; 
```

–í—ã–≤–æ–¥:

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ salesorderid ‚îÇ shipmethodid ‚îÇ billtoaddressid ‚îÇ ‚Ä¶ ‚îÇ salespersonid ‚îÇ      shipdate       ‚îÇ accountnumber  ‚îÇ
‚îÇ    int32     ‚îÇ    int32     ‚îÇ      int32      ‚îÇ   ‚îÇ     int32     ‚îÇ      timestamp      ‚îÇ    varchar     ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ        43659 ‚îÇ            5 ‚îÇ             985 ‚îÇ ‚Ä¶ ‚îÇ           279 ‚îÇ 2011-06-07 00:00:00 ‚îÇ 10-4020-000676 ‚îÇ
‚îÇ        43660 ‚îÇ            5 ‚îÇ             921 ‚îÇ ‚Ä¶ ‚îÇ           279 ‚îÇ 2011-06-07 00:00:00 ‚îÇ 10-4020-000117 ‚îÇ
‚îÇ        43661 ‚îÇ            5 ‚îÇ             517 ‚îÇ ‚Ä¶ ‚îÇ           282 ‚îÇ 2011-06-07 00:00:00 ‚îÇ 10-4020-000442 ‚îÇ
‚îÇ        43662 ‚îÇ            5 ‚îÇ             482 ‚îÇ ‚Ä¶ ‚îÇ           282 ‚îÇ 2011-06-07 00:00:00 ‚îÇ 10-4020-000227 ‚îÇ
‚îÇ        43663 ‚îÇ            5 ‚îÇ            1073 ‚îÇ ‚Ä¶ ‚îÇ           276 ‚îÇ 2011-06-07 00:00:00 ‚îÇ 10-4020-000510 ‚îÇ
‚îÇ        43664 ‚îÇ            5 ‚îÇ             876 ‚îÇ ‚Ä¶ ‚îÇ           280 ‚îÇ 2011-06-07 00:00:00 ‚îÇ 10-4020-000397 ‚îÇ
‚îÇ        43665 ‚îÇ            5 ‚îÇ             849 ‚îÇ ‚Ä¶ ‚îÇ           283 ‚îÇ 2011-06-07 00:00:00 ‚îÇ 10-4020-000146 ‚îÇ
‚îÇ        43666 ‚îÇ            5 ‚îÇ            1074 ‚îÇ ‚Ä¶ ‚îÇ           276 ‚îÇ 2011-06-07 00:00:00 ‚îÇ 10-4020-000511 ‚îÇ
‚îÇ        43667 ‚îÇ            5 ‚îÇ             629 ‚îÇ ‚Ä¶ ‚îÇ           277 ‚îÇ 2011-06-07 00:00:00 ‚îÇ 10-4020-000646 ‚îÇ
‚îÇ        43668 ‚îÇ            5 ‚îÇ             529 ‚îÇ ‚Ä¶ ‚îÇ           282 ‚îÇ 2011-06-07 00:00:00 ‚îÇ 10-4020-000514 ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ 10 rows                                                                             23 columns (6 shown) ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

–ö–æ–≥–¥–∞ –≤—ã —É—Å–ø–µ—à–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏–ª–∏ –ø—Ä–æ–µ–∫—Ç dbt –∏ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö, –º—ã –º–æ–∂–µ–º –ø–µ—Ä–µ–π—Ç–∏ –∫ —Å–ª–µ–¥—É—é—â–µ–π —á–∞—Å—Ç–∏, —á—Ç–æ–±—ã –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å —Ç–∞–±–ª–∏—Ü—ã, –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –¥–ª—è —Ä–∞–∑–º–µ—Ä–Ω–æ–π –º–æ–¥–µ–ª–∏.

## –ß–∞—Å—Ç—å 2: –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –±–∏–∑–Ω–µ—Å-–ø—Ä–æ—Ü–µ—Å—Å–∞

–¢–µ–ø–µ—Ä—å, –∫–æ–≥–¥–∞ –≤—ã –Ω–∞—Å—Ç—Ä–æ–∏–ª–∏ –ø—Ä–æ–µ–∫—Ç dbt, –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö –∏ –≤–∑–≥–ª—è–Ω—É–ª–∏ –Ω–∞ —Å—Ö–µ–º—É, –ø—Ä–∏—à–ª–æ –≤—Ä–µ–º—è –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –±–∏–∑–Ω–µ—Å-–ø—Ä–æ—Ü–µ—Å—Å.

–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –±–∏–∑–Ω–µ—Å-–ø—Ä–æ—Ü–µ—Å—Å–∞ –æ—Å—É—â–µ—Å—Ç–≤–ª—è–µ—Ç—Å—è –≤ —Å–æ—Ç—Ä—É–¥–Ω–∏—á–µ—Å—Ç–≤–µ —Å –±–∏–∑–Ω–µ—Å-–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º. –ë–∏–∑–Ω–µ—Å-–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∏–º–µ–µ—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç –≤–æ–∫—Ä—É–≥ –±–∏–∑–Ω–µ—Å-—Ü–µ–ª–µ–π –∏ –±–∏–∑–Ω–µ—Å-–ø—Ä–æ—Ü–µ—Å—Å–æ–≤ –∏ –º–æ–∂–µ—Ç –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–∏—Ç—å –≤–∞–º —ç—Ç—É –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é.

<Lightbox src="/img/blog/2023-04-18-building-a-kimball-dimensional-model-with-dbt/conversation.png" title="–†–∞–∑–≥–æ–≤–æ—Ä –º–µ–∂–¥—É –±–∏–∑–Ω–µ—Å-–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º –∏ –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–º –∏–Ω–∂–µ–Ω–µ—Ä–æ–º"/>

–ü–æ–≥–æ–≤–æ—Ä–∏–≤ —Å –≥–µ–Ω–µ—Ä–∞–ª—å–Ω—ã–º –¥–∏—Ä–µ–∫—Ç–æ—Ä–æ–º AdventureWorks, –≤—ã —É–∑–Ω–∞–µ—Ç–µ —Å–ª–µ–¥—É—é—â—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é:

> AdventureWorks –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç –≤–µ–ª–æ—Å–∏–ø–µ–¥—ã –∏ –ø—Ä–æ–¥–∞–µ—Ç –∏—Ö –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—è–º (B2C) –∏ –±–∏–∑–Ω–µ—Å–∞–º (B2B). –í–µ–ª–æ—Å–∏–ø–µ–¥—ã –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –∫–ª–∏–µ–Ω—Ç–∞–º –ø–æ –≤—Å–µ–º—É –º–∏—Ä—É. –ö–∞–∫ –≥–µ–Ω–µ—Ä–∞–ª—å–Ω—ã–π –¥–∏—Ä–µ–∫—Ç–æ—Ä –∫–æ–º–ø–∞–Ω–∏–∏, —è —Ö–æ—Ç–µ–ª –±—ã –∑–Ω–∞—Ç—å, —Å–∫–æ–ª—å–∫–æ –¥–æ—Ö–æ–¥–∞ –º—ã –ø–æ–ª—É—á–∏–ª–∏ –∑–∞ –≥–æ–¥, –∑–∞–∫–∞–Ω—á–∏–≤–∞—é—â–∏–π—Å—è –≤ 2011 –≥–æ–¥—É, —Å —Ä–∞–∑–±–∏–≤–∫–æ–π –ø–æ:
- –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –∏ –ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –ø—Ä–æ–¥—É–∫—Ç–∞
- –ö–ª–∏–µ–Ω—Ç—É
- –°—Ç–∞—Ç—É—Å—É –∑–∞–∫–∞–∑–∞
- –°—Ç—Ä–∞–Ω–µ, —à—Ç–∞—Ç—É –∏ –≥–æ—Ä–æ–¥—É –¥–æ—Å—Ç–∞–≤–∫–∏

–ù–∞ –æ—Å–Ω–æ–≤–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏, –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω–æ–π –±–∏–∑–Ω–µ—Å-–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º, –≤—ã –æ–ø—Ä–µ–¥–µ–ª–∏–ª–∏, —á—Ç–æ –±–∏–∑–Ω–µ—Å-–ø—Ä–æ—Ü–µ—Å—Å, –æ –∫–æ—Ç–æ—Ä–æ–º –∏–¥–µ—Ç —Ä–µ—á—å, ‚Äî —ç—Ç–æ ***–ü—Ä–æ—Ü–µ—Å—Å –ø—Ä–æ–¥–∞–∂***. –í —Å–ª–µ–¥—É—é—â–µ–π —á–∞—Å—Ç–∏ –≤—ã —Å–æ–±–∏—Ä–∞–µ—Ç–µ—Å—å —Ä–∞–∑—Ä–∞–±–æ—Ç–∞—Ç—å —Ä–∞–∑–º–µ—Ä–Ω—É—é –º–æ–¥–µ–ª—å –¥–ª—è –ø—Ä–æ—Ü–µ—Å—Å–∞ –ø—Ä–æ–¥–∞–∂.

## –ß–∞—Å—Ç—å 3: –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü —Ñ–∞–∫—Ç–æ–≤ –∏ –∏–∑–º–µ—Ä–µ–Ω–∏–π

–ù–∞ –æ—Å–Ω–æ–≤–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏, –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω–æ–π –≤ –ø—Ä–µ–¥—ã–¥—É—â–µ–π —á–∞—Å—Ç–∏, –º—ã —Ö–æ—Ç–∏–º —Å–æ–∑–¥–∞—Ç—å —Ä–∞–∑–º–µ—Ä–Ω—É—é –º–æ–¥–µ–ª—å, –∫–æ—Ç–æ—Ä–∞—è –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç –ø—Ä–æ—Ü–µ—Å—Å –ø—Ä–æ–¥–∞–∂ –±–∏–∑–Ω–µ—Å–∞ –∏ —Ç–∞–∫–∂–µ –ø–æ–∑–≤–æ–ª—è–µ—Ç –∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –ø–æ:

- –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –∏ –ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –ø—Ä–æ–¥—É–∫—Ç–∞
- –ö–ª–∏–µ–Ω—Ç—É
- –°—Ç–∞—Ç—É—Å—É –∑–∞–∫–∞–∑–∞
- –°—Ç—Ä–∞–Ω–µ, —à—Ç–∞—Ç—É –∏ –≥–æ—Ä–æ–¥—É –¥–æ—Å—Ç–∞–≤–∫–∏
- –î–∞—Ç–µ (–≥–æ–¥, –º–µ—Å—è—Ü, –¥–µ–Ω—å)

### –¢–∞–±–ª–∏—Ü—ã —Ñ–∞–∫—Ç–æ–≤

:::info
[–¢–∞–±–ª–∏—Ü—ã —Ñ–∞–∫—Ç–æ–≤](https://www.kimballgroup.com/data-warehouse-business-intelligence-resources/kimball-techniques/dimensional-modeling-techniques/facts-for-measurement/) ‚Äî —ç—Ç–æ —Ç–∞–±–ª–∏—Ü—ã –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö, –∫–æ—Ç–æ—Ä—ã–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é—Ç –±–∏–∑–Ω–µ—Å-–ø—Ä–æ—Ü–µ—Å—Å –≤ —Ä–µ–∞–ª—å–Ω–æ–º –º–∏—Ä–µ. –ö–∞–∂–¥–∞—è –∑–∞–ø–∏—Å—å –≤ —Ç–∞–±–ª–∏—Ü–µ —Ñ–∞–∫—Ç–æ–≤ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç –±–∏–∑–Ω–µ—Å-—Å–æ–±—ã—Ç–∏–µ, —Ç–∞–∫–æ–µ –∫–∞–∫:

- –ü—Ä–æ–¥–∞–∂–∞ —Ç–æ–≤–∞—Ä–∞
- –ö–ª–∏–∫ –Ω–∞ —Å–∞–π—Ç–µ
- –ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–µ–Ω–Ω—ã–π –∑–∞–∫–∞–∑
:::

–í —Å—Ö–µ–º–µ –ø—Ä–æ–¥–∞–∂ –µ—Å—Ç—å –¥–≤–µ —Ç–∞–±–ª–∏—Ü—ã, –∫–æ—Ç–æ—Ä—ã–µ –ø—Ä–∏–≤–ª–µ–∫–∞—é—Ç –Ω–∞—à–µ –≤–Ω–∏–º–∞–Ω–∏–µ. –≠—Ç–∏ –¥–≤–µ —Ç–∞–±–ª–∏—Ü—ã –º–æ–≥—É—Ç –±—ã—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω—ã –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Ç–∞–±–ª–∏—Ü—ã —Ñ–∞–∫—Ç–æ–≤ –¥–ª—è –ø—Ä–æ—Ü–µ—Å—Å–∞ –ø—Ä–æ–¥–∞–∂:

- –¢–∞–±–ª–∏—Ü–∞ `sales.salesorderheader` —Å–æ–¥–µ—Ä–∂–∏—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –∫—Ä–µ–¥–∏—Ç–Ω–æ–π –∫–∞—Ä—Ç–µ, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω–æ–π –≤ –∑–∞–∫–∞–∑–µ, –∞–¥—Ä–µ—Å–µ –¥–æ—Å—Ç–∞–≤–∫–∏ –∏ –∫–ª–∏–µ–Ω—Ç–µ. –ö–∞–∂–¥–∞—è –∑–∞–ø–∏—Å—å –≤ —ç—Ç–æ–π —Ç–∞–±–ª–∏—Ü–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç –∑–∞–≥–æ–ª–æ–≤–æ–∫ –∑–∞–∫–∞–∑–∞, —Å–æ–¥–µ—Ä–∂–∞—â–∏–π –æ–¥–Ω—É –∏–ª–∏ –Ω–µ—Å–∫–æ–ª—å–∫–æ –¥–µ—Ç–∞–ª–µ–π –∑–∞–∫–∞–∑–∞.
- –¢–∞–±–ª–∏—Ü–∞ `sales.salesorderdetail` —Å–æ–¥–µ—Ä–∂–∏—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –∑–∞–∫–∞–∑–∞–Ω–Ω–æ–º –ø—Ä–æ–¥—É–∫—Ç–µ, –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ –∑–∞–∫–∞–∑–∞ –∏ —Ü–µ–Ω–µ –∑–∞ –µ–¥–∏–Ω–∏—Ü—É, –∫–æ—Ç–æ—Ä—ã–µ –º—ã –º–æ–∂–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞ –¥–æ—Ö–æ–¥–∞. –ö–∞–∂–¥–∞—è –∑–∞–ø–∏—Å—å –≤ —ç—Ç–æ–π —Ç–∞–±–ª–∏—Ü–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç –æ–¥–Ω—É –¥–µ—Ç–∞–ª—å –∑–∞–∫–∞–∑–∞.

<Lightbox src="/img/blog/2023-04-18-building-a-kimball-dimensional-model-with-dbt/sales-order-header-detail.png" width="85%" title="–ó–∞–≥–æ–ª–æ–≤–æ–∫ –∏ –¥–µ—Ç–∞–ª–∏ –∑–∞–∫–∞–∑–∞ –Ω–∞ –ø—Ä–æ–¥–∞–∂—É"/>

–î–∞–≤–∞–π—Ç–µ –æ–ø—Ä–µ–¥–µ–ª–∏–º —Ç–∞–±–ª–∏—Ü—É —Ñ–∞–∫—Ç–æ–≤ –ø–æ–¥ –Ω–∞–∑–≤–∞–Ω–∏–µ–º `fct_sales`, –∫–æ—Ç–æ—Ä–∞—è –æ–±—ä–µ–¥–∏–Ω—è–µ—Ç `sales.salesorderheader` –∏ `sales.salesorderdetail`. –ö–∞–∂–¥–∞—è –∑–∞–ø–∏—Å—å –≤ —Ç–∞–±–ª–∏—Ü–µ —Ñ–∞–∫—Ç–æ–≤ (—Ç–∞–∫–∂–µ –∏–∑–≤–µ—Å—Ç–Ω–∞—è –∫–∞–∫ [–∑–µ—Ä–Ω–æ](https://www.kimballgroup.com/data-warehouse-business-intelligence-resources/kimball-techniques/dimensional-modeling-techniques/grain/)) ‚Äî —ç—Ç–æ –¥–µ—Ç–∞–ª—å –∑–∞–∫–∞–∑–∞.

<Lightbox src="/img/blog/2023-04-18-building-a-kimball-dimensional-model-with-dbt/fct_sales.png" width="85%" title="–¢–∞–±–ª–∏—Ü–∞ fct_sales"/>

### –¢–∞–±–ª–∏—Ü—ã –∏–∑–º–µ—Ä–µ–Ω–∏–π

:::info
[–¢–∞–±–ª–∏—Ü—ã –∏–∑–º–µ—Ä–µ–Ω–∏–π](https://www.kimballgroup.com/data-warehouse-business-intelligence-resources/kimball-techniques/dimensional-modeling-techniques/dimensions-for-context/) –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–ª—è –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω–æ–π –∏–ª–∏ –æ–ø–∏—Å–∞—Ç–µ–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –¥–ª—è —Å–æ–±—ã—Ç–∏—è –±–∏–∑–Ω–µ—Å-–ø—Ä–æ—Ü–µ—Å—Å–∞. –ü—Ä–∏–º–µ—Ä—ã –∏–∑–º–µ—Ä–µ–Ω–∏–π –≤–∫–ª—é—á–∞—é—Ç:

- –î–µ—Ç–∞–ª–∏ –∫–ª–∏–µ–Ω—Ç–∞: –ö—Ç–æ —è–≤–ª—è–µ—Ç—Å—è –∫–ª–∏–µ–Ω—Ç–æ–º –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–≥–æ –Ω–æ–º–µ—Ä–∞ –∑–∞–∫–∞–∑–∞?
- –î–µ—Ç–∞–ª–∏ –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏—è –∫–ª–∏–∫–∞ –Ω–∞ —Å–∞–π—Ç–µ: –ù–∞ –∫–∞–∫—É—é –∫–Ω–æ–ø–∫—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∏–º–∞–µ—Ç?
- –î–µ—Ç–∞–ª–∏ –ø—Ä–æ–¥—É–∫—Ç–∞: –ö–∞–∫–æ–≤—ã –¥–µ—Ç–∞–ª–∏ –ø—Ä–æ–¥—É–∫—Ç–∞, –¥–æ–±–∞–≤–ª–µ–Ω–Ω–æ–≥–æ –≤ –∫–æ—Ä–∑–∏–Ω—É?
:::

–ù–∞ –æ—Å–Ω–æ–≤–µ –±–∏–∑–Ω–µ—Å-–≤–æ–ø—Ä–æ—Å–æ–≤, –Ω–∞ –∫–æ—Ç–æ—Ä—ã–µ –Ω–∞—à –±–∏–∑–Ω–µ—Å-–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Ö–æ—Ç–µ–ª –±—ã –ø–æ–ª—É—á–∏—Ç—å –æ—Ç–≤–µ—Ç—ã, –º—ã –º–æ–∂–µ–º –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ç–∞–±–ª–∏—Ü, –∫–æ—Ç–æ—Ä—ã–µ —Å–æ–¥–µ—Ä–∂–∞—Ç –ø–æ–ª–µ–∑–Ω—É—é –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –¥–ª—è –Ω–∞—à–µ–≥–æ –±–∏–∑–Ω–µ—Å-–ø—Ä–æ—Ü–µ—Å—Å–∞:

- `person.address`
- `person.countryregion`
- `production.product`
- `production.productcategory`
- `sales.customer`
- `sales.store`
- –ò –º–Ω–æ–≥–∏–µ –¥—Ä—É–≥–∏–µ ‚Ä¶

–°—É—â–µ—Å—Ç–≤—É—é—Ç —Ä–∞–∑–Ω—ã–µ —Å–ø–æ—Å–æ–±—ã —Å–æ–∑–¥–∞–Ω–∏—è —Ç–∞–±–ª–∏—Ü –∏–∑–º–µ—Ä–µ–Ω–∏–π. –ú—ã –º–æ–≥–ª–∏ –±—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –æ—Ç–Ω–æ—à–µ–Ω–∏—è –º–µ–∂–¥—É —Ç–∞–±–ª–∏—Ü–∞–º–∏, –∫–∞–∫ –ø–æ–∫–∞–∑–∞–Ω–æ –Ω–∞ –¥–∏–∞–≥—Ä–∞–º–º–µ –Ω–∏–∂–µ.

<Lightbox src="/img/blog/2023-04-18-building-a-kimball-dimensional-model-with-dbt/snowflake-schema.png" width="85%" title="–°—Ö–µ–º–∞ —Å–Ω–µ–∂–∏–Ω–∫–∏"/>

–≠—Ç–æ –∏–∑–≤–µ—Å—Ç–Ω–æ –∫–∞–∫ –¥–∏–∑–∞–π–Ω —Å—Ö–µ–º—ã —Å–Ω–µ–∂–∏–Ω–∫–∏, –≥–¥–µ —Ç–∞–±–ª–∏—Ü–∞ —Ñ–∞–∫—Ç–æ–≤ —è–≤–ª—è–µ—Ç—Å—è —Ü–µ–Ω—Ç—Ä–æ–º —Å–Ω–µ–∂–∏–Ω–∫–∏, –∏ –æ—Ç —Ü–µ–Ω—Ç—Ä–∞ —Å–Ω–µ–∂–∏–Ω–∫–∏ –æ—Ç—Ö–æ–¥—è—Ç –º–Ω–æ–≥–∏–µ —Ñ—Ä–∞–∫—Ç–∞–ª—ã. –û–¥–Ω–∞–∫–æ —ç—Ç–æ –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ –º–Ω–æ–∂–µ—Å—Ç–≤—É —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π, –∫–æ—Ç–æ—Ä—ã–µ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω—ã –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª–µ–º —Ä–∞–∑–º–µ—Ä–Ω–æ–π –º–æ–¥–µ–ª–∏.

–í–º–µ—Å—Ç–æ —ç—Ç–æ–≥–æ –º—ã –º–æ–∂–µ–º –¥–µ–Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞—Ç—å —Ç–∞–±–ª–∏—Ü—ã –∏–∑–º–µ—Ä–µ–Ω–∏–π, –≤—ã–ø–æ–ª–Ω—è—è —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è.

<Lightbox src="/img/blog/2023-04-18-building-a-kimball-dimensional-model-with-dbt/star-schema.png" width="85%" title="–°—Ö–µ–º–∞ –∑–≤–µ–∑–¥—ã"/>

–≠—Ç–æ –∏–∑–≤–µ—Å—Ç–Ω–æ –∫–∞–∫ —Å—Ö–µ–º–∞ –∑–≤–µ–∑–¥—ã, –∏ —ç—Ç–æ—Ç –ø–æ–¥—Ö–æ–¥ —É–º–µ–Ω—å—à–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π, –∫–æ—Ç–æ—Ä—ã–µ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω—ã –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª–µ–º —Ä–∞–∑–º–µ—Ä–Ω–æ–π –º–æ–¥–µ–ª–∏.

–ò—Å–ø–æ–ª—å–∑—É—è –ø–æ–¥—Ö–æ–¥ —Å—Ö–µ–º—ã –∑–≤–µ–∑–¥—ã, –º—ã –º–æ–∂–µ–º –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å 6 –∏–∑–º–µ—Ä–µ–Ω–∏–π, –∫–æ—Ç–æ—Ä—ã–µ –ø–æ–º–æ–≥—É—Ç –Ω–∞–º –æ—Ç–≤–µ—Ç–∏—Ç—å –Ω–∞ –±–∏–∑–Ω–µ—Å-–≤–æ–ø—Ä–æ—Å—ã:

<Lightbox src="/img/blog/2023-04-18-building-a-kimball-dimensional-model-with-dbt/dimension-tables.png" width="85%" title="–¢–∞–±–ª–∏—Ü—ã –∏–∑–º–µ—Ä–µ–Ω–∏–π"/>

- `dim_product`: —Ç–∞–±–ª–∏—Ü–∞ –∏–∑–º–µ—Ä–µ–Ω–∏–π, –æ–±—ä–µ–¥–∏–Ω—è—é—â–∞—è `product`, `productsubcategory`, `productcategory`
- `dim_address`: —Ç–∞–±–ª–∏—Ü–∞ –∏–∑–º–µ—Ä–µ–Ω–∏–π, –æ–±—ä–µ–¥–∏–Ω—è—é—â–∞—è `address`, `stateprovince`, `countryregion`
- `dim_customer`: —Ç–∞–±–ª–∏—Ü–∞ –∏–∑–º–µ—Ä–µ–Ω–∏–π, –æ–±—ä–µ–¥–∏–Ω—è—é—â–∞—è `customer`, `person`, `store`
- `dim_credit_card`: —Ç–∞–±–ª–∏—Ü–∞ –∏–∑–º–µ—Ä–µ–Ω–∏–π, —Å–æ–∑–¥–∞–Ω–Ω–∞—è –∏–∑ `creditcard`
- `dim_order_status`: —Ç–∞–±–ª–∏—Ü–∞ –∏–∑–º–µ—Ä–µ–Ω–∏–π, —Å–æ–∑–¥–∞–Ω–Ω–∞—è –ø—É—Ç–µ–º –≤—ã–±–æ—Ä–∞ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö —Å—Ç–∞—Ç—É—Å–æ–≤ –∏–∑ `salesorderheader`
- `dim_date`: —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ –∏–∑–º–µ—Ä–µ–Ω–∏–π, —Å–æ–¥–µ—Ä–∂–∞—â–∞—è –∞—Ç—Ä–∏–±—É—Ç—ã –¥–∞—Ç—ã —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –ø–∞–∫–µ—Ç–∞ [dbt_date](https://hub.getdbt.com/calogica/dbt_date/latest/).

:::note
–ú—ã –≤—Ä—É—á–Ω—É—é –∑–∞–ø–æ–ª–Ω–∏–ª–∏ —Ç–∞–±–ª–∏—Ü—É `dim_date`, —Ç–∞–∫ –∫–∞–∫ DuckDB –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è –ø–∞–∫–µ—Ç–æ–º dbt_date.
:::

–í —Å–ª–µ–¥—É—é—â–µ–π —á–∞—Å—Ç–∏ –º—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º dbt –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Ç–∞–±–ª–∏—Ü —Ñ–∞–∫—Ç–æ–≤ –∏ –∏–∑–º–µ—Ä–µ–Ω–∏–π, –∫–æ—Ç–æ—Ä—ã–µ –º—ã –æ–ø—Ä–µ–¥–µ–ª–∏–ª–∏.

## –ß–∞—Å—Ç—å 4: –°–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü –∏–∑–º–µ—Ä–µ–Ω–∏–π

–î–∞–≤–∞–π—Ç–µ —Å–Ω–∞—á–∞–ª–∞ —Å–æ–∑–¥–∞–¥–∏–º `dim_product`. –û—Å—Ç–∞–ª—å–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã –∏–∑–º–µ—Ä–µ–Ω–∏–π –±—É–¥—É—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–µ –∂–µ —à–∞–≥–∏, –∫–æ—Ç–æ—Ä—ã–µ –º—ã —Å–æ–±–∏—Ä–∞–µ–º—Å—è –ø—Ä–æ–π—Ç–∏.

### –®–∞–≥ 1: –°–æ–∑–¥–∞–Ω–∏–µ —Ñ–∞–π–ª–æ–≤ –º–æ–¥–µ–ª–µ–π

–î–∞–≤–∞–π—Ç–µ —Å–æ–∑–¥–∞–¥–∏–º –Ω–æ–≤—ã–µ —Ñ–∞–π–ª—ã –º–æ–¥–µ–ª–µ–π dbt, –∫–æ—Ç–æ—Ä—ã–µ –±—É–¥—É—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å –Ω–∞—à –∫–æ–¥ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è. –í –∫–∞—Ç–∞–ª–æ–≥–µ `adventureworks/models/marts/` —Å–æ–∑–¥–∞–π—Ç–µ –¥–≤–∞ —Ñ–∞–π–ª–∞:

- `dim_product.sql`: –≠—Ç–æ—Ç —Ñ–∞–π–ª –±—É–¥–µ—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å –Ω–∞—à SQL-–∫–æ–¥ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è.
- `dim_product.yml`: –≠—Ç–æ—Ç —Ñ–∞–π–ª –±—É–¥–µ—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å –Ω–∞—à—É –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é –∏ —Ç–µ—Å—Ç—ã –¥–ª—è `dim_product`.

```
adventureworks/models/
‚îî‚îÄ‚îÄ marts
    ‚îú‚îÄ‚îÄ dim_product.sql
    ‚îú‚îÄ‚îÄ dim_product.yml
```

### –®–∞–≥ 2: –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∏–∑ –≤—ã—à–µ—Å—Ç–æ—è—â–∏—Ö —Ç–∞–±–ª–∏—Ü

–í `dim_product.sql` –≤—ã –º–æ–∂–µ—Ç–µ –≤—ã–±—Ä–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –∏–∑ –≤—ã—à–µ—Å—Ç–æ—è—â–∏—Ö —Ç–∞–±–ª–∏—Ü, –∏—Å–ø–æ–ª—å–∑—É—è –û–±—â–∏–µ –¢–∞–±–ª–∏—á–Ω—ã–µ –í—ã—Ä–∞–∂–µ–Ω–∏—è (CTE).

```sql
with stg_product as (
    select *
    from {{ ref('product') }}
),

stg_product_subcategory as (
    select *
    from {{ ref('productsubcategory') }}
),

stg_product_category as (
    select *
    from {{ ref('productcategory') }}
)

... 
```

–ú—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º —Ñ—É–Ω–∫—Ü–∏—é `ref`, —á—Ç–æ–±—ã —Å—Å—ã–ª–∞—Ç—å—Å—è –Ω–∞ –≤—ã—à–µ—Å—Ç–æ—è—â–∏–µ —Ç–∞–±–ª–∏—Ü—ã –∏ —Å–æ–∑–¥–∞–≤–∞—Ç—å <Term id="dag">–æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∞—Ü–∏–∫–ª–∏—á–µ—Å–∫–∏–π –≥—Ä–∞—Ñ (DAG)</Term> –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π.

### –®–∞–≥ 3: –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π

–î–∞–ª–µ–µ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è –º–µ–∂–¥—É <Term id="cte">CTE</Term> —Ç–∞–±–ª–∏—Ü–∞–º–∏, –∏—Å–ø–æ–ª—å–∑—É—è —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ –∫–ª—é—á–∏ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è.

```sql
...

select
    ... 
from stg_product
left join stg_product_subcategory on stg_product.productsubcategoryid = stg_product_subcategory.productsubcategoryid
left join stg_product_category on stg_product_subcategory.productcategoryid = stg_product_category.productcategoryid
```

### –®–∞–≥ 4: –°–æ–∑–¥–∞–Ω–∏–µ —Å—É—Ä—Ä–æ–≥–∞—Ç–Ω–æ–≥–æ –∫–ª—é—á–∞

:::info
[–°—É—Ä—Ä–æ–≥–∞—Ç–Ω—ã–µ –∫–ª—é—á–∏](https://www.kimballgroup.com/1998/05/surrogate-keys/) –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—é—Ç –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—è–º —Ä–∞–∑–º–µ—Ä–Ω–æ–π –º–æ–¥–µ–ª–∏ –ø—Ä–æ—Å—Ç–æ–π –≤ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ –∫–ª—é—á –¥–ª—è —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Ç–∞–±–ª–∏—Ü —Ñ–∞–∫—Ç–æ–≤ –∏ –∏–∑–º–µ—Ä–µ–Ω–∏–π, –±–µ–∑ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –ø–æ–Ω–∏–º–∞–Ω–∏—è –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –±–∏–∑–Ω–µ—Å-–∫–æ–Ω—Ç–µ–∫—Å—Ç–∞.
:::

–°—É—â–µ—Å—Ç–≤—É–µ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø–æ–¥—Ö–æ–¥–æ–≤ –∫ —Å–æ–∑–¥–∞–Ω–∏—é <Term id="surrogate-key">—Å—É—Ä—Ä–æ–≥–∞—Ç–Ω–æ–≥–æ –∫–ª—é—á–∞</Term>:

- **–•–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—É—Ä—Ä–æ–≥–∞—Ç–Ω–æ–≥–æ –∫–ª—é—á–∞**: —Å—É—Ä—Ä–æ–≥–∞—Ç–Ω—ã–π –∫–ª—é—á, –∫–æ—Ç–æ—Ä—ã–π —Å–æ–∑–¥–∞–µ—Ç—Å—è –ø—É—Ç–µ–º —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –∫–ª—é—á–µ–π —Ç–∞–±–ª–∏—Ü—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä, `md5(key_1, key_2, key_3)`).
- **–ò–Ω–∫—Ä–µ–º–µ–Ω—Ç–Ω—ã–π —Å—É—Ä—Ä–æ–≥–∞—Ç–Ω—ã–π –∫–ª—é—á**: —Å—É—Ä—Ä–æ–≥–∞—Ç–Ω—ã–π –∫–ª—é—á, –∫–æ—Ç–æ—Ä—ã–π —Å–æ–∑–¥–∞–µ—Ç—Å—è —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —á–∏—Å–ª–∞, –∫–æ—Ç–æ—Ä–æ–µ –≤—Å–µ–≥–¥–∞ —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç—Å—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, `row_number()`).
- **–ö–æ–Ω–∫–∞—Ç–µ–Ω–∞—Ü–∏—è —Å—É—Ä—Ä–æ–≥–∞—Ç–Ω–æ–≥–æ –∫–ª—é—á–∞**: —Å—É—Ä—Ä–æ–≥–∞—Ç–Ω—ã–π –∫–ª—é—á, –∫–æ—Ç–æ—Ä—ã–π —Å–æ–∑–¥–∞–µ—Ç—Å—è –ø—É—Ç–µ–º –∫–æ–Ω–∫–∞—Ç–µ–Ω–∞—Ü–∏–∏ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö —Å—Ç–æ–ª–±—Ü–æ–≤ –∫–ª—é—á–µ–π (–Ω–∞–ø—Ä–∏–º–µ—Ä, `concat(key_1, key_2, key_3)`).

–ú—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º, –ø–æ–∂–∞–ª—É–π, —Å–∞–º—ã–π –ø—Ä–æ—Å—Ç–æ–π –ø–æ–¥—Ö–æ–¥, –∫–æ—Ç–æ—Ä—ã–π –∑–∞–∫–ª—é—á–∞–µ—Ç—Å—è –≤ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö —Å—Ç–æ–ª–±—Ü–æ–≤ –∫–ª—é—á–µ–π —Ç–∞–±–ª–∏—Ü—ã –∏–∑–º–µ—Ä–µ–Ω–∏–π. –≠—Ç–æ—Ç –ø–æ–¥—Ö–æ–¥ —É—Å—Ç—Ä–∞–Ω—è–µ—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å —Ç–∞–±–ª–∏—Ü–∞–º–∏ –∏–∑–º–µ—Ä–µ–Ω–∏–π –ø—Ä–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Å—É—Ä—Ä–æ–≥–∞—Ç–Ω–æ–≥–æ –∫–ª—é—á–∞ –¥–ª—è —Ç–∞–±–ª–∏—Ü —Ñ–∞–∫—Ç–æ–≤ –ø–æ–∑–∂–µ.

–î–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Å—É—Ä—Ä–æ–≥–∞—Ç–Ω–æ–≥–æ –∫–ª—é—á–∞ –º—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º –º–∞–∫—Ä–æ—Å dbt, –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ–º—ã–π –ø–∞–∫–µ—Ç–æ–º `dbt_utils`, –ø–æ–¥ –Ω–∞–∑–≤–∞–Ω–∏–µ–º `generate_surrogate_key()`. –ú–∞–∫—Ä–æ—Å –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Å—É—Ä—Ä–æ–≥–∞—Ç–Ω–æ–≥–æ –∫–ª—é—á–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â—É—é —Ñ—É–Ω–∫—Ü–∏—é —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è –∏–∑ –≤–∞—à–µ–π –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Å—É—Ä—Ä–æ–≥–∞—Ç–Ω–æ–≥–æ –∫–ª—é—á–∞ –∏–∑ —Å–ø–∏—Å–∫–∞ —Å—Ç–æ–ª–±—Ü–æ–≤ –∫–ª—é—á–µ–π (–Ω–∞–ø—Ä–∏–º–µ—Ä, `md5()`, `hash()`). –ü–æ–¥—Ä–æ–±–Ω–µ–µ –æ [–º–∞–∫—Ä–æ—Å–µ generate_surrogate_key](https://docs.getdbt.tech/blog/sql-surrogate-keys).

```sql
...

select
    {{ dbt_utils.generate_surrogate_key(['stg_product.productid']) }} as product_key, 
    ... 
from stg_product
left join stg_product_subcategory on stg_product.productsubcategoryid = stg_product_subcategory.productsubcategoryid
left join stg_product_category on stg_product_subcategory.productcategoryid = stg_product_category.productcategoryid
```

### –®–∞–≥ 5: –í—ã–±–æ—Ä —Å—Ç–æ–ª–±—Ü–æ–≤ —Ç–∞–±–ª–∏—Ü—ã –∏–∑–º–µ—Ä–µ–Ω–∏–π

–¢–µ–ø–µ—Ä—å –≤—ã –º–æ–∂–µ—Ç–µ –≤—ã–±—Ä–∞—Ç—å —Å—Ç–æ–ª–±—Ü—ã —Ç–∞–±–ª–∏—Ü—ã –∏–∑–º–µ—Ä–µ–Ω–∏–π, —á—Ç–æ–±—ã –æ–Ω–∏ –º–æ–≥–ª–∏ –±—ã—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω—ã –≤–º–µ—Å—Ç–µ —Å —Ç–∞–±–ª–∏—Ü–µ–π —Ñ–∞–∫—Ç–æ–≤ –ø–æ–∑–∂–µ. –ú—ã –≤—ã–±–∏—Ä–∞–µ–º —Å—Ç–æ–ª–±—Ü—ã, –∫–æ—Ç–æ—Ä—ã–µ –ø–æ–º–æ–≥—É—Ç –Ω–∞–º –æ—Ç–≤–µ—Ç–∏—Ç—å –Ω–∞ —Ä–∞–Ω–µ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–µ –±–∏–∑–Ω–µ—Å-–≤–æ–ø—Ä–æ—Å—ã.

```sql
...

select
    {{ dbt_utils.generate_surrogate_key(['stg_product.productid']) }} as product_key, 
    stg_product.productid,
    stg_product.name as product_name,
    stg_product.productnumber,
    stg_product.color,
    stg_product.class,
    stg_product_subcategory.name as product_subcategory_name,
    stg_product_category.name as product_category_name
from stg_product
left join stg_product_subcategory on stg_product.productsubcategoryid = stg_product_subcategory.productsubcategoryid
left join stg_product_category on stg_product_subcategory.productcategoryid = stg_product_category.productcategoryid
```

### –®–∞–≥ 6: –í—ã–±–æ—Ä —Ç–∏–ø–∞ –º–∞—Ç–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏–∏

–í—ã –º–æ–∂–µ—Ç–µ –≤—ã–±—Ä–∞—Ç—å –æ–¥–∏–Ω –∏–∑ —Å–ª–µ–¥—É—é—â–∏—Ö —Ç–∏–ø–æ–≤ –º–∞—Ç–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏–∏, –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã—Ö dbt:

- View
- Table
- Incremental

–û–±—ã—á–Ω–æ —Ç–∞–±–ª–∏—Ü—ã –∏–∑–º–µ—Ä–µ–Ω–∏–π –º–∞—Ç–µ—Ä–∏–∞–ª–∏–∑—É—é—Ç—Å—è –∫–∞–∫ `table` –∏–ª–∏ `view`, —Ç–∞–∫ –∫–∞–∫ –æ–±—ä–µ–º—ã –¥–∞–Ω–Ω—ã—Ö –≤ —Ç–∞–±–ª–∏—Ü–∞—Ö –∏–∑–º–µ—Ä–µ–Ω–∏–π –æ–±—ã—á–Ω–æ –Ω–µ –æ—á–µ–Ω—å –±–æ–ª—å—à–∏–µ. –í —ç—Ç–æ–º –ø—Ä–∏–º–µ—Ä–µ –º—ã –≤—ã–±—Ä–∞–ª–∏ `table` –∏ —É—Å—Ç–∞–Ω–æ–≤–∏–ª–∏ —Ç–∏–ø –º–∞—Ç–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –¥–ª—è –≤—Å–µ—Ö —Ä–∞–∑–º–µ—Ä–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π –≤ —Å—Ö–µ–º–µ `marts` –∫–∞–∫ `table` –≤ `dbt_project.yml`.

```sql
models:
  adventureworks:
    marts:
      +materialized: table
      +schema: marts
```

### –®–∞–≥ 7: –°–æ–∑–¥–∞–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ –∏ —Ç–µ—Å—Ç–æ–≤ –º–æ–¥–µ–ª–∏

–í–º–µ—Å—Ç–µ —Å –Ω–∞—à–µ–π –º–æ–¥–µ–ª—å—é `dim_product.sql` –º—ã –º–æ–∂–µ–º –∑–∞–ø–æ–ª–Ω–∏—Ç—å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π —Ñ–∞–π–ª `dim_product.yml`, —á—Ç–æ–±—ã –∑–∞–¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –Ω–∞—à—É –º–æ–¥–µ–ª—å.

```yaml
version: 2

models:
  - name: dim_product
    columns:
      - name: product_key 
        description: –°—É—Ä—Ä–æ–≥–∞—Ç–Ω—ã–π –∫–ª—é—á –ø—Ä–æ–¥—É–∫—Ç–∞
        tests:
          - not_null
          - unique
      - name: productid 
        description: –ï—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω—ã–π –∫–ª—é—á –ø—Ä–æ–¥—É–∫—Ç–∞
        tests:
          - not_null
          - unique
      - name: product_name 
        description: –ù–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–æ–¥—É–∫—Ç–∞
        tests:
          - not_null
```

### –®–∞–≥ 8: –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π dbt

–í—ã–ø–æ–ª–Ω–∏—Ç–µ –∫–æ–º–∞–Ω–¥—ã [dbt run](https://docs.getdbt.tech/reference/commands/run) –∏ [dbt test](https://docs.getdbt.tech/reference/commands/run), —á—Ç–æ–±—ã –∑–∞–ø—É—Å—Ç–∏—Ç—å –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –≤–∞—à–∏ –º–æ–¥–µ–ª–∏ dbt:

```
dbt run && dbt test 
```

–¢–µ–ø–µ—Ä—å –º—ã –∑–∞–≤–µ—Ä—à–∏–ª–∏ –≤—Å–µ —à–∞–≥–∏ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Ç–∞–±–ª–∏—Ü—ã –∏–∑–º–µ—Ä–µ–Ω–∏–π. –ú—ã –º–æ–∂–µ–º –ø–æ–≤—Ç–æ—Ä–∏—Ç—å —Ç–µ –∂–µ —à–∞–≥–∏ –¥–ª—è –≤—Å–µ—Ö —Ç–∞–±–ª–∏—Ü –∏–∑–º–µ—Ä–µ–Ω–∏–π, –∫–æ—Ç–æ—Ä—ã–µ –º—ã –æ–ø—Ä–µ–¥–µ–ª–∏–ª–∏ —Ä–∞–Ω–µ–µ. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—ã —Å–æ–∑–¥–∞–ª–∏ –≤—Å–µ —Ç–∞–±–ª–∏—Ü—ã –∏–∑–º–µ—Ä–µ–Ω–∏–π, –ø—Ä–µ–∂–¥–µ —á–µ–º –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç—å –∫ —Å–ª–µ–¥—É—é—â–µ–π —á–∞—Å—Ç–∏.

## –ß–∞—Å—Ç—å 5: –°–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã —Ñ–∞–∫—Ç–æ–≤

–ü–æ—Å–ª–µ —Ç–æ–≥–æ –∫–∞–∫ –º—ã —Å–æ–∑–¥–∞–ª–∏ –≤—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ —Ç–∞–±–ª–∏—Ü—ã –∏–∑–º–µ—Ä–µ–Ω–∏–π, –º—ã –º–æ–∂–µ–º —Å–æ–∑–¥–∞—Ç—å —Ç–∞–±–ª–∏—Ü—É —Ñ–∞–∫—Ç–æ–≤ –¥–ª—è `fct_sales`.

### –®–∞–≥ 1: –°–æ–∑–¥–∞–Ω–∏–µ —Ñ–∞–π–ª–æ–≤ –º–æ–¥–µ–ª–µ–π

–î–∞–≤–∞–π—Ç–µ —Å–æ–∑–¥–∞–¥–∏–º –Ω–æ–≤—ã–µ —Ñ–∞–π–ª—ã –º–æ–¥–µ–ª–µ–π dbt, –∫–æ—Ç–æ—Ä—ã–µ –±—É–¥—É—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å –Ω–∞—à –∫–æ–¥ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è. –í –∫–∞—Ç–∞–ª–æ–≥–µ `adventureworks/models/marts/` —Å–æ–∑–¥–∞–π—Ç–µ –¥–≤–∞ —Ñ–∞–π–ª–∞:

- `fct_sales.sql`: –≠—Ç–æ—Ç —Ñ–∞–π–ª –±—É–¥–µ—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å –Ω–∞—à SQL-–∫–æ–¥ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è.
- `fct_sales.yml`: –≠—Ç–æ—Ç —Ñ–∞–π–ª –±—É–¥–µ—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å –Ω–∞—à—É –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é –∏ —Ç–µ—Å—Ç—ã –¥–ª—è `fct_sales`.

```
adventureworks/models/
‚îî‚îÄ‚îÄ marts
    ‚îú‚îÄ‚îÄ fct_sales.sql
    ‚îú‚îÄ‚îÄ fct_sales.yml
```

### –®–∞–≥ 2: –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∏–∑ –≤—ã—à–µ—Å—Ç–æ—è—â–∏—Ö —Ç–∞–±–ª–∏—Ü

–ß—Ç–æ–±—ã –æ—Ç–≤–µ—Ç–∏—Ç—å –Ω–∞ –±–∏–∑–Ω–µ—Å-–≤–æ–ø—Ä–æ—Å—ã, –Ω–∞–º –Ω—É–∂–Ω—ã —Å—Ç–æ–ª–±—Ü—ã –∫–∞–∫ –∏–∑ `salesorderheader`, —Ç–∞–∫ –∏ –∏–∑ `salesorderdetail`. –î–∞–≤–∞–π—Ç–µ –æ—Ç—Ä–∞–∑–∏–º —ç—Ç–æ –≤ `fct_sales.sql`:

```sql
with stg_salesorderheader as (
    select
        salesorderid,
        customerid,
        creditcardid,
        shiptoaddressid,
        status as order_status,
        cast(orderdate as date) as orderdate
    from {{ ref('salesorderheader') }}
),

stg_salesorderdetail as (
    select
        salesorderid,
        salesorderdetailid,
        productid,
        orderqty,
        unitprice,
        unitprice * orderqty as revenue
    from {{ ref('salesorderdetail') }}
)

... 
```

### –®–∞–≥ 3: –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π

–ó–µ—Ä–Ω–æ —Ç–∞–±–ª–∏—Ü—ã `fct_sales` ‚Äî —ç—Ç–æ –æ–¥–Ω–∞ –∑–∞–ø–∏—Å—å –≤ —Ç–∞–±–ª–∏—Ü–µ SalesOrderDetail, –∫–æ—Ç–æ—Ä–∞—è –æ–ø–∏—Å—ã–≤–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ–¥—É–∫—Ç–∞ –≤ SalesOrderHeader. –ü–æ—ç—Ç–æ–º—É –º—ã –≤—ã–ø–æ–ª–Ω—è–µ–º —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –º–µ–∂–¥—É `salesorderheader` –∏ `salesorderdetail`, —á—Ç–æ–±—ã –¥–æ—Å—Ç–∏—á—å —ç—Ç–æ–≥–æ –∑–µ—Ä–Ω–∞.

```sql
... 

select
    ... 
from stg_salesorderdetail
inner join stg_salesorderheader on stg_salesorderdetail.salesorderid = stg_salesorderheader.salesorderid
```

### –®–∞–≥ 4: –°–æ–∑–¥–∞–Ω–∏–µ —Å—É—Ä—Ä–æ–≥–∞—Ç–Ω–æ–≥–æ –∫–ª—é—á–∞

–î–∞–ª–µ–µ –º—ã —Å–æ–∑–¥–∞–µ–º —Å—É—Ä—Ä–æ–≥–∞—Ç–Ω—ã–π –∫–ª—é—á –¥–ª—è —É–Ω–∏–∫–∞–ª—å–Ω–æ–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∫–∞–∂–¥–æ–π —Å—Ç—Ä–æ–∫–∏ –≤ —Ç–∞–±–ª–∏—Ü–µ —Ñ–∞–∫—Ç–æ–≤. –ö–∞–∂–¥–∞—è —Å—Ç—Ä–æ–∫–∞ –≤ —Ç–∞–±–ª–∏—Ü–µ `fct_sales` –º–æ–∂–µ—Ç –±—ã—Ç—å —É–Ω–∏–∫–∞–ª—å–Ω–æ –∏–¥–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–∞ —Å –ø–æ–º–æ—â—å—é `salesorderid` –∏ `salesorderdetailid`, –ø–æ—ç—Ç–æ–º—É –º—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º –æ–±–∞ —Å—Ç–æ–ª–±—Ü–∞ –≤ –º–∞–∫—Ä–æ—Å–µ `generate_surrogate_key()`.

```sql
... 

select
    {{ dbt_utils.generate_surrogate_key(['stg_salesorderdetail.salesorderid', 'salesorderdetailid']) }} as sales_key,
		... 
from stg_salesorderdetail
inner join stg_salesorderheader on stg_salesorderdetail.salesorderid = stg_salesorderheader.salesorderid
```

### –®–∞–≥ 5: –í—ã–±–æ—Ä —Å—Ç–æ–ª–±—Ü–æ–≤ —Ç–∞–±–ª–∏—Ü—ã —Ñ–∞–∫—Ç–æ–≤

–¢–µ–ø–µ—Ä—å –≤—ã –º–æ–∂–µ—Ç–µ –≤—ã–±—Ä–∞—Ç—å —Å—Ç–æ–ª–±—Ü—ã —Ç–∞–±–ª–∏—Ü—ã —Ñ–∞–∫—Ç–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –ø–æ–º–æ–≥—É—Ç –Ω–∞–º –æ—Ç–≤–µ—Ç–∏—Ç—å –Ω–∞ —Ä–∞–Ω–µ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–µ –±–∏–∑–Ω–µ—Å-–≤–æ–ø—Ä–æ—Å—ã. –ú—ã —Ö–æ—Ç–∏–º –∏–º–µ—Ç—å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —Ä–∞—Å—Å—á–∏—Ç–∞—Ç—å —Å—É–º–º—É –¥–æ—Ö–æ–¥–∞, –∏ –ø–æ—ç—Ç–æ–º—É –º—ã –≤–∫–ª—é—á–∞–µ–º —Å—Ç–æ–ª–±–µ—Ü –¥–æ—Ö–æ–¥–∞ –Ω–∞ –∫–∞–∂–¥—É—é –¥–µ—Ç–∞–ª—å –∑–∞–∫–∞–∑–∞, –∫–æ—Ç–æ—Ä—ã–π –±—ã–ª —Ä–∞—Å—Å—á–∏—Ç–∞–Ω –≤—ã—à–µ –∫–∞–∫ `unitprice * orderqty as revenue`.

```sql
...

select
    {{ dbt_utils.generate_surrogate_key(['stg_salesorderdetail.salesorderid', 'salesorderdetailid']) }} as sales_key,
    stg_salesorderdetail.salesorderid,
    stg_salesorderdetail.salesorderdetailid,
    stg_salesorderdetail.unitprice,
    stg_salesorderdetail.orderqty,
    stg_salesorderdetail.revenue
from stg_salesorderdetail
inner join stg_salesorderheader on stg_salesorderdetail.salesorderid = stg_salesorderheader.salesorderid
```

### –®–∞–≥ 6: –°–æ–∑–¥–∞–Ω–∏–µ –≤–Ω–µ—à–Ω–∏—Ö —Å—É—Ä—Ä–æ–≥–∞—Ç–Ω—ã—Ö –∫–ª—é—á–µ–π

–ú—ã —Ö–æ—Ç–∏–º –∏–º–µ—Ç—å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –Ω–∞—à—É —Ç–∞–±–ª–∏—Ü—É —Ñ–∞–∫—Ç–æ–≤ –≤ —Ä–∞–∑—Ä–µ–∑–µ —Ç–∞–±–ª–∏—Ü –∏–∑–º–µ—Ä–µ–Ω–∏–π, –∫–æ—Ç–æ—Ä—ã–µ –º—ã —Å–æ–∑–¥–∞–ª–∏ –Ω–∞ –ø—Ä–µ–¥—ã–¥—É—â–µ–º —à–∞–≥–µ. –ü–æ—ç—Ç–æ–º—É –Ω–∞–º –Ω—É–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å –≤–Ω–µ—à–Ω–∏–µ —Å—É—Ä—Ä–æ–≥–∞—Ç–Ω—ã–µ –∫–ª—é—á–∏, –∫–æ—Ç–æ—Ä—ã–µ –±—É–¥—É—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –¥–ª—è —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Ç–∞–±–ª–∏—Ü—ã —Ñ–∞–∫—Ç–æ–≤ —Å —Ç–∞–±–ª–∏—Ü–∞–º–∏ –∏–∑–º–µ—Ä–µ–Ω–∏–π.

–ú—ã –¥–æ—Å—Ç–∏–≥–∞–µ–º —ç—Ç–æ–≥–æ, –ø—Ä–∏–º–µ–Ω—è—è –º–∞–∫—Ä–æ—Å `generate_surrogate_key()` –∫ —Ç–µ–º –∂–µ —É–Ω–∏–∫–∞–ª—å–Ω—ã–º —Å—Ç–æ–ª–±—Ü–∞–º –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –º—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏ —Ä–∞–Ω–µ–µ –ø—Ä–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Å—É—Ä—Ä–æ–≥–∞—Ç–Ω—ã—Ö –∫–ª—é—á–µ–π –≤ —Ç–∞–±–ª–∏—Ü–∞—Ö –∏–∑–º–µ—Ä–µ–Ω–∏–π.

```sql
...

select
    {{ dbt_utils.generate_surrogate_key(['stg_salesorderdetail.salesorderid', 'salesorderdetailid']) }} as sales_key,
    {{ dbt_utils.generate_surrogate_key(['productid']) }} as product_key,
    {{ dbt_utils.generate_surrogate_key(['customerid']) }} as customer_key,
    {{ dbt_utils.generate_surrogate_key(['creditcardid']) }} as creditcard_key,
    {{ dbt_utils.generate_surrogate_key(['shiptoaddressid']) }} as ship_address_key,
    {{ dbt_utils.generate_surrogate_key(['order_status']) }} as order_status_key,
    {{ dbt_utils.generate_surrogate_key(['orderdate']) }} as order_date_key,
    stg_salesorderdetail.salesorderid,
    stg_salesorderdetail.salesorderdetailid,
    stg_salesorderdetail.unitprice,
    stg_salesorderdetail.orderqty,
    stg_salesorderdetail.revenue
from stg_salesorderdetail
inner join stg_salesorderheader on stg_salesorderdetail.salesorderid = stg_salesorderheader.salesorderid
```

### –®–∞–≥ 7: –í—ã–±–æ—Ä —Ç–∏–ø–∞ –º–∞—Ç–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏–∏

–í—ã –º–æ–∂–µ—Ç–µ –≤—ã–±—Ä–∞—Ç—å –æ–¥–∏–Ω –∏–∑ —Å–ª–µ–¥—É—é—â–∏—Ö —Ç–∏–ø–æ–≤ –º–∞—Ç–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏–∏, –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã—Ö dbt:

- View
- Table
- Incremental

–û–±—ã—á–Ω–æ —Ç–∞–±–ª–∏—Ü—ã —Ñ–∞–∫—Ç–æ–≤ –º–∞—Ç–µ—Ä–∏–∞–ª–∏–∑—É—é—Ç—Å—è –∫–∞–∫ `incremental` –∏–ª–∏ `table` –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –æ–±—ä–µ–º–∞ –¥–∞–Ω–Ω—ã—Ö. [–ö–∞–∫ –ø—Ä–∞–≤–∏–ª–æ](https://docs.getdbt.tech/docs/build/incremental-overview#when-to-use-an-incremental-model), –µ—Å–ª–∏ –≤—ã –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç–µ –º–∏–ª–ª–∏–æ–Ω—ã –∏–ª–∏ –º–∏–ª–ª–∏–∞—Ä–¥—ã —Å—Ç—Ä–æ–∫, —Ç–æ –≤–∞–º —Å–ª–µ–¥—É–µ—Ç –Ω–∞—á–∞—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –º–∞—Ç–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—é `incremental`. –í —ç—Ç–æ–º –ø—Ä–∏–º–µ—Ä–µ –º—ã –≤—ã–±—Ä–∞–ª–∏ `table` –¥–ª—è –ø—Ä–æ—Å—Ç–æ—Ç—ã.

### –®–∞–≥ 8: –°–æ–∑–¥–∞–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ –∏ —Ç–µ—Å—Ç–æ–≤ –º–æ–¥–µ–ª–∏

–í–º–µ—Å—Ç–µ —Å –Ω–∞—à–µ–π –º–æ–¥–µ–ª—å—é `fct_sales.sql` –º—ã –º–æ–∂–µ–º –∑–∞–ø–æ–ª–Ω–∏—Ç—å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π —Ñ–∞–π–ª `fct_sales.yml`, —á—Ç–æ–±—ã –∑–∞–¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –Ω–∞—à—É –º–æ–¥–µ–ª—å.

```yaml
version: 2

models:
  - name: fct_sales
    columns:

      - name: sales_key
        description: –°—É—Ä—Ä–æ–≥–∞—Ç–Ω—ã–π –∫–ª—é—á –ø—Ä–æ–¥–∞–∂
        tests:
          - not_null
          - unique

      - name: product_key
        description: –í–Ω–µ—à–Ω–∏–π –∫–ª—é—á –ø—Ä–æ–¥—É–∫—Ç–∞
        tests:
          - not_null

      - name: customer_key
        description: –í–Ω–µ—à–Ω–∏–π –∫–ª—é—á –∫–ª–∏–µ–Ω—Ç–∞
        tests:
          - not_null 
      
      ... 

      - name: orderqty
        description: –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ–¥—É–∫—Ç–∞ 
        tests:
          - not_null

      - name: revenue
        description: –î–æ—Ö–æ–¥, –ø–æ–ª—É—á–µ–Ω–Ω—ã–π –ø—É—Ç–µ–º —É–º–Ω–æ–∂–µ–Ω–∏—è unitprice –∏ orderqty
```

### –®–∞–≥ 9: –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π dbt

–í—ã–ø–æ–ª–Ω–∏—Ç–µ –∫–æ–º–∞–Ω–¥—ã [dbt run](https://docs.getdbt.tech/reference/commands/run) –∏ [dbt test](https://docs.getdbt.tech/reference/commands/run), —á—Ç–æ–±—ã –∑–∞–ø—É—Å—Ç–∏—Ç—å –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –≤–∞—à–∏ –º–æ–¥–µ–ª–∏ dbt:

```
dbt run && dbt test 
```

–û—Ç–ª–∏—á–Ω–∞—è —Ä–∞–±–æ—Ç–∞, –≤—ã —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–ª–∏ —Å–≤–æ–∏ –ø–µ—Ä–≤—ã–µ —Ç–∞–±–ª–∏—Ü—ã —Ñ–∞–∫—Ç–æ–≤ –∏ –∏–∑–º–µ—Ä–µ–Ω–∏–π! –ù–∞—à–∞ —Ä–∞–∑–º–µ—Ä–Ω–∞—è –º–æ–¥–µ–ª—å —Ç–µ–ø–µ—Ä—å –∑–∞–≤–µ—Ä—à–µ–Ω–∞!! üéâ

## –ß–∞—Å—Ç—å 6: –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ç–Ω–æ—à–µ–Ω–∏–π —Ä–∞–∑–º–µ—Ä–Ω–æ–π –º–æ–¥–µ–ª–∏

–î–∞–≤–∞–π—Ç–µ —É–ø—Ä–æ—Å—Ç–∏–º –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—è–º –Ω–∞—à–µ–π —Ä–∞–∑–º–µ—Ä–Ω–æ–π –º–æ–¥–µ–ª–∏ –ø–æ–Ω–∏–º–∞–Ω–∏–µ –æ—Ç–Ω–æ—à–µ–Ω–∏–π –º–µ–∂–¥—É —Ç–∞–±–ª–∏—Ü–∞–º–∏, —Å–æ–∑–¥–∞–≤ [–î–∏–∞–≥—Ä–∞–º–º—É —Å—É—â–Ω–æ—Å—Ç–µ–π –∏ —Å–≤—è–∑–µ–π (ERD)](https://www.visual-paradigm.com/guide/data-modeling/what-is-entity-relationship-diagram/).

<Lightbox src="/img/blog/2023-04-18-building-a-kimball-dimensional-model-with-dbt/target-schema.png" width="85%" title="–ò—Ç–æ–≥–æ–≤–∞—è ERD —Ä–∞–∑–º–µ—Ä–Ω–æ–π –º–æ–¥–µ–ª–∏"/>

ERD –ø–æ–∑–≤–æ–ª–∏—Ç –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—è–º –Ω–∞—à–µ–π —Ä–∞–∑–º–µ—Ä–Ω–æ–π –º–æ–¥–µ–ª–∏ –±—ã—Å—Ç—Ä–æ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –∫–ª—é—á–∏ –∏ —Ç–∏–ø –æ—Ç–Ω–æ—à–µ–Ω–∏–π (–æ–¥–∏–Ω-–∫-–æ–¥–Ω–æ–º—É, –æ–¥–∏–Ω-–∫–æ-–º–Ω–æ–≥–∏–º), –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Ç–∞–±–ª–∏—Ü.

## –ß–∞—Å—Ç—å 7: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–Ω–æ–π –º–æ–¥–µ–ª–∏

–ù–∞–∫–æ–Ω–µ—Ü, –º—ã –º–æ–∂–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –Ω–∞—à—É —Ä–∞–∑–º–µ—Ä–Ω—É—é –º–æ–¥–µ–ª—å, –ø–æ–¥–∫–ª—é—á–∏–≤ –Ω–∞—à —Å–∫–ª–∞–¥ –¥–∞–Ω–Ω—ã—Ö –∫ –Ω–∞—à–∏–º –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞–º –±–∏–∑–Ω–µ—Å-–∞–Ω–∞–ª–∏—Ç–∏–∫–∏ (BI), —Ç–∞–∫–∏–º –∫–∞–∫ Tableau, Power BI –∏ Looker.

–ë–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö BI-–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ –∏–º–µ—é—Ç –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–π —Å–ª–æ–π, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –æ—Ç–Ω–æ—à–µ–Ω–∏—è –º–µ–∂–¥—É —Ç–∞–±–ª–∏—Ü–∞–º–∏, —á—Ç–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ, –µ—Å–ª–∏ –º—ã —Ö–æ—Ç–∏–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ä–∞–∑–º–µ—Ä–Ω—ã–µ –º–æ–¥–µ–ª–∏ –Ω–∞–ø—Ä—è–º—É—é –±–µ–∑ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–π –¥–∞–Ω–Ω—ã—Ö.

–í Looker, –Ω–∞–ø—Ä–∏–º–µ—Ä, –º—ã –º–æ–∂–µ–º –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –æ—Ç–Ω–æ—à–µ–Ω–∏—è, –∏—Å–ø–æ–ª—å–∑—É—è [LookML](https://cloud.google.com/looker/docs/what-is-lookml):

```
explore: fct_order {
  join: dim_user {
    sql_on: ${fct_order.user_key} = ${dim_user.user_key} ;;
    relationship: many_to_one
  }
}
```

–ï—Å–ª–∏ –≤–∞—à BI-–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –Ω–µ –∏–º–µ–µ—Ç —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–æ–≥–æ —Å–ª–æ—è, –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—â–µ–≥–æ –æ—Ç–Ω–æ—à–µ–Ω–∏—è, —Ç–æ –≤–∞–º –ø—Ä–∏–¥–µ—Ç—Å—è –æ—Ç—Ä–∞–∑–∏—Ç—å —ç—Ç–æ –æ—Ç–Ω–æ—à–µ–Ω–∏–µ, —Å–æ–∑–¥–∞–≤ One Big Table (OBT), –∫–æ—Ç–æ—Ä—ã–π —Å–æ–µ–¥–∏–Ω—è–µ—Ç —Ç–∞–±–ª–∏—Ü—É —Ñ–∞–∫—Ç–æ–≤ —Å–æ –≤—Å–µ–º–∏ –µ–µ —Ç–∞–±–ª–∏—Ü–∞–º–∏ –∏–∑–º–µ—Ä–µ–Ω–∏–π.

```sql
with f_sales as (
    select * from {{ ref('fct_sales') }}
),

d_customer as (
    select * from {{ ref('dim_customer') }}
),

d_credit_card as (
    select * from {{ ref('dim_credit_card') }}
),

d_address as (
    select * from {{ ref('dim_address') }}
),

d_order_status as (
    select * from {{ ref('dim_order_status') }}
),

d_product as (
    select * from {{ ref('dim_product') }}
),

d_date as (
    select * from {{ ref('dim_date') }}
)

select
    {{ dbt_utils.star(from=ref('fct_sales'), relation_alias='f_sales', except=[
        "product_key", "customer_key", "creditcard_key", "ship_address_key", "order_status_key", "order_date_key"
    ]) }},
    {{ dbt_utils.star(from=ref('dim_product'), relation_alias='d_product', except=["product_key"]) }},
    {{ dbt_utils.star(from=ref('dim_customer'), relation_alias='d_customer', except=["customer_key"]) }},
    {{ dbt_utils.star(from=ref('dim_credit_card'), relation_alias='d_credit_card', except=["creditcard_key"]) }},
    {{ dbt_utils.star(from=ref('dim_address'), relation_alias='d_address', except=["address_key"]) }},
    {{ dbt_utils.star(from=ref('dim_order_status'), relation_alias='d_order_status', except=["order_status_key"]) }},
    {{ dbt_utils.star(from=ref('dim_date'), relation_alias='d_date', except=["date_key"]) }}
from f_sales
left join d_product on f_sales.product_key = d_product.product_key
left join d_customer on f_sales.customer_key = d_customer.customer_key
left join d_credit_card on f_sales.creditcard_key = d_credit_card.creditcard_key
left join d_address on f_sales.ship_address_key = d_address.address_key
left join d_order_status on f_sales.order_status_key = d_order_status.order_status_key
left join d_date on f_sales.order_date_key = d_date.date_key
```

–í –ø—Ä–∏–≤–µ–¥–µ–Ω–Ω–æ–º –≤—ã—à–µ OBT –º—ã –≤—ã–ø–æ–ª–Ω—è–µ–º —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è –º–µ–∂–¥—É —Ç–∞–±–ª–∏—Ü–µ–π —Ñ–∞–∫—Ç–æ–≤ –∏ —Ç–∞–±–ª–∏—Ü–∞–º–∏ –∏–∑–º–µ—Ä–µ–Ω–∏–π, –∏—Å–ø–æ–ª—å–∑—É—è —Å—É—Ä—Ä–æ–≥–∞—Ç–Ω—ã–µ –∫–ª—é—á–∏.

–ò—Å–ø–æ–ª—å–∑—É—è `dbt_utils.star()`, –º—ã –≤—ã–±–∏—Ä–∞–µ–º –≤—Å–µ —Å—Ç–æ–ª–±—Ü—ã, –∫—Ä–æ–º–µ —Å—Ç–æ–ª–±—Ü–æ–≤ —Å—É—Ä—Ä–æ–≥–∞—Ç–Ω—ã—Ö –∫–ª—é—á–µ–π, —Ç–∞–∫ –∫–∞–∫ —Å—É—Ä—Ä–æ–≥–∞—Ç–Ω—ã–µ –∫–ª—é—á–∏ –Ω–µ –∏–º–µ—é—Ç –Ω–∏–∫–∞–∫–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è, –∫—Ä–æ–º–µ –∫–∞–∫ –±—ã—Ç—å –ø–æ–ª–µ–∑–Ω—ã–º–∏ –¥–ª—è —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π.

–ó–∞—Ç–µ–º –º—ã –º–æ–∂–µ–º –ø–æ—Å—Ç—Ä–æ–∏—Ç—å OBT, –∑–∞–ø—É—Å—Ç–∏–≤ `dbt run`. –í–∞—à DAG dbt —Ç–µ–ø–µ—Ä—å –¥–æ–ª–∂–µ–Ω –≤—ã–≥–ª—è–¥–µ—Ç—å —Ç–∞–∫:

<Lightbox src="/img/blog/2023-04-18-building-a-kimball-dimensional-model-with-dbt/dbt-dag.png" width="85%" title="–ò—Ç–æ–≥–æ–≤—ã–π DAG dbt"/>

–ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º, –≤—ã –¥–æ—à–ª–∏ –¥–æ –∫–æ–Ω—Ü–∞ —ç—Ç–æ–≥–æ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–∞. –ï—Å–ª–∏ –≤—ã —Ö–æ—Ç–∏—Ç–µ —É–∑–Ω–∞—Ç—å –±–æ–ª—å—à–µ, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞, –æ–∑–Ω–∞–∫–æ–º—å—Ç–µ—Å—å —Å —É—á–µ–±–Ω—ã–º–∏ —Ä–µ—Å—É—Ä—Å–∞–º–∏ –Ω–∏–∂–µ –ø–æ —Ä–∞–∑–º–µ—Ä–Ω–æ–º—É –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏—é.

## –£—á–µ–±–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã

- [–£—á–µ–±–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã –≥—Ä—É–ø–ø—ã –ö–∏–º–±–∞–ª–ª–∞](https://www.kimballgroup.com/data-warehouse-business-intelligence-resources/kimball-techniques/dimensional-modeling-techniques/)
- [–ö–Ω–∏–≥–∞ The Data Warehouse toolkit](https://www.kimballgroup.com/data-warehouse-business-intelligence-resources/books/data-warehouse-dw-toolkit/)
- [–û–±—Å—É–∂–¥–µ–Ω–∏–µ dbt –æ —Ç–æ–º, –∞–∫—Ç—É–∞–ª—å–Ω–æ –ª–∏ –µ—â–µ —Ä–∞–∑–º–µ—Ä–Ω–æ–µ –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏–µ](https://discourse.getdbt.com/t/is-kimball-dimensional-modeling-still-relevant-in-a-modern-data-warehouse/225)
- [–ì–ª–æ—Å—Å–∞—Ä–∏–π dbt –ø–æ —Ä–∞–∑–º–µ—Ä–Ω–æ–º—É –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏—é](https://docs.getdbt.tech/terms/dimensional-modeling)

–ï—Å–ª–∏ —É –≤–∞—Å –µ—Å—Ç—å –≤–æ–ø—Ä–æ—Å—ã –ø–æ –º–∞—Ç–µ—Ä–∏–∞–ª—É, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞, —Å–≤—è–∂–∏—Ç–µ—Å—å —Å–æ –º–Ω–æ–π –≤ —Å–æ–æ–±—â–µ—Å—Ç–≤–µ dbt Slack (@Jonathan Neo) –∏–ª–∏ –Ω–∞ [LinkedIn](https://www.linkedin.com/in/jonneo/).

*–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ –∞–≤—Ç–æ—Ä–∞: –ú–∞—Ç–µ—Ä–∏–∞–ª—ã –≤ —ç—Ç–æ–π —Å—Ç–∞—Ç—å–µ –±—ã–ª–∏ —Å–æ–∑–¥–∞–Ω—ã [Data Engineer Camp](https://dataengineercamp.com/), 16-–Ω–µ–¥–µ–ª—å–Ω—ã–º –±—É—Ç–∫–µ–º–ø–æ–º –ø–æ –∏–Ω–∂–µ–Ω–µ—Ä–∏–∏ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª–æ–≤, –∂–µ–ª–∞—é—â–∏—Ö –ø–µ—Ä–µ–π—Ç–∏ –≤ –∏–Ω–∂–µ–Ω–µ—Ä–∏—é –¥–∞–Ω–Ω—ã—Ö –∏ –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫—É—é –∏–Ω–∂–µ–Ω–µ—Ä–∏—é. –°—Ç–∞—Ç—å—è –±—ã–ª–∞ –Ω–∞–ø–∏—Å–∞–Ω–∞ –î–∂–æ–Ω–∞—Ç–∞–Ω–æ–º –ù–µ–æ, —Å —Ä–µ–¥–∞–∫—Ü–∏–æ–Ω–Ω—ã–º –∏ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–º —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ–º –æ—Ç [–ö–µ–Ω–Ω–∏ –ù–∏–Ω–≥–∞](https://www.linkedin.com/in/kenny-ning/) –∏ —Ä–µ–¥–∞–∫—Ü–∏–æ–Ω–Ω—ã–º –æ–±–∑–æ—Ä–æ–º –æ—Ç [–ü–æ–ª–∞ –•–∞–ª–ª–∞—Å—Ç–µ](https://www.linkedin.com/in/paulhallaste/) –∏ [–î–∂–æ—à–∞ –î–µ–≤–ª–∏–Ω–∞](https://www.linkedin.com/in/josh-devlin/).*