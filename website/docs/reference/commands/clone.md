---
title: "О команде dbt clone"
sidebar_label: "clone"
id: "clone"
---

Команда `dbt clone` клонирует выбранные узлы из [указанного состояния](/reference/node-selection/syntax#establishing-state) в целевую схему(ы). Эта команда использует материализацию `clone`:
- Если ваша платформа данных поддерживает клонирование таблиц без копирования (Snowflake, Databricks или BigQuery), и эта модель существует как таблица в исходной среде, dbt создаст ее в вашей целевой среде как клон.
- В противном случае dbt создаст простое представление указателя (`select * from` исходного объекта).
- По умолчанию `dbt clone` не будет воссоздавать уже существующие отношения в текущей цели. Чтобы переопределить это, используйте флаг `--full-refresh`.
- Вы можете указать большее количество [потоков](/docs/running-a-dbt-project/using-threads), чтобы уменьшить время выполнения, так как отдельные операторы клонирования независимы друг от друга.

Команда `clone` полезна для:
- непрерывного развертывания blue/green (на хранилищах данных, которые поддерживают клонирование таблиц без копирования)
- клонирования текущего состояния производства в схемы разработки
- обработки инкрементальных моделей в CI-заданиях dbt Cloud (на хранилищах данных, которые поддерживают клонирование таблиц без копирования)
- тестирования изменений кода на зависимостях downstream в вашем BI инструменте

```bash
# клонировать все мои модели из указанного состояния в мои целевые схемы
dbt clone --state path/to/artifacts

# клонировать одну_конкретную_модель из моих моделей из указанного состояния в мои целевые схемы
dbt clone --select "one_specific_model" --state path/to/artifacts

# клонировать все мои модели из указанного состояния в мои целевые схемы и воссоздать все уже существующие отношения в текущей цели
dbt clone --state path/to/artifacts --full-refresh

# клонировать все мои модели из указанного состояния в мои целевые схемы, выполняя до 50 операторов клонирования параллельно
dbt clone --state path/to/artifacts --threads 50
```

### Когда использовать `dbt clone` вместо [отложенного выполнения](/reference/node-selection/defer)?

В отличие от отложенного выполнения, `dbt clone` требует вычислительных ресурсов и создания дополнительных объектов в вашем хранилище данных. Во многих случаях отложенное выполнение является более дешевым и простым вариантом по сравнению с `dbt clone`. Однако `dbt clone` охватывает дополнительные случаи использования, когда отложенное выполнение может быть невозможно.

Например, создавая реальные объекты в хранилище данных, `dbt clone` позволяет вам тестировать изменения кода на зависимостях downstream _вне dbt_ (например, в BI инструменте).

В качестве другого примера, вы можете `clone` ваши измененные инкрементальные модели в качестве первого шага вашего CI задания в dbt Cloud, чтобы избежать дорогостоящих сборок `full-refresh` для хранилищ, которые поддерживают клонирование без копирования.

## Клонирование в dbt Cloud

Вы можете клонировать узлы между состояниями в dbt Cloud, используя команду `dbt clone`. Это доступно в [dbt Cloud IDE](/docs/cloud/dbt-cloud-ide/develop-in-the-cloud) и [dbt Cloud CLI](/docs/cloud/cloud-cli-installation) и зависит от функции [`--defer`](/reference/node-selection/defer). Для получения дополнительной информации об отложенном выполнении в dbt Cloud, прочитайте [Использование отложенного выполнения в dbt Cloud](/docs/cloud/about-cloud-develop-defer).

- **Использование dbt Cloud CLI** &mdash; Команда `dbt clone` в dbt Cloud CLI автоматически включает флаг `--defer`. Это означает, что вы можете использовать команду `dbt clone` без дополнительной настройки.

- **Использование dbt Cloud IDE** &mdash; Чтобы использовать команду `dbt clone` в dbt Cloud IDE, выполните следующие шаги перед запуском команды `dbt clone`:

  - Настройте вашу **Производственную среду** и выполните успешный запуск задания.
  - Включите **Отложенное выполнение в производство**, переключив тумблер в правом нижнем углу панели команд.
    <Lightbox src="/img/docs/dbt-cloud/defer-toggle.jpg" width="80%" title="Выберите переключатель 'Отложенное выполнение в производство' в правом нижнем углу панели команд, чтобы включить отложенное выполнение в dbt Cloud IDE."/>
  - Запустите команду `dbt clone` из панели команд.
  
Посмотрите [этот пост в блоге разработчиков](https://docs.getdbt.com/blog/to-defer-or-to-clone) для получения дополнительной информации о лучших практиках, когда использовать `dbt clone` по сравнению с отложенным выполнением.