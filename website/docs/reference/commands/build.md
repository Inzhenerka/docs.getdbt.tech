---
title: "О команде dbt build"
sidebar_label: "build"
id: "build"
---

Команда `dbt build` выполняет следующие действия:
- запускает модели
- тестирует тесты
- создает снимки
- загружает начальные данные

В порядке DAG для выбранных ресурсов или для всего проекта.

## Подробности

**Артефакты:** Задача `build` создаст один [манифест](/reference/artifacts/manifest-json) и один [артефакт результатов выполнения](/reference/artifacts/run-results-json). Результаты выполнения будут содержать информацию обо всех моделях, тестах, начальных данных и снимках, которые были выбраны для сборки, объединенные в один файл.

**Пропуск при ошибках:** Тесты на вышестоящих ресурсах блокируют выполнение нижестоящих ресурсов, и сбой теста приведет к полному пропуску этих нижестоящих ресурсов. Например, если `model_b` зависит от `model_a`, и тест `unique` на `model_a` не проходит, то `model_b` будет `SKIP`.
- Не хотите, чтобы тест вызывал пропуск? Настройте его [серьезность или пороги](/reference/resource-configs/severity) на `warn` вместо `error`.
- В случае теста с несколькими родителями, где один родитель зависит от другого (например, тест `relationships` между `model_a` и `model_b`), этот тест будет блокировать и пропускать только детей самого нижнего родителя (`model_b`).

**Выбор ресурсов:** Задача `build` поддерживает стандартный синтаксис выбора (`--select`, `--exclude`, `--selector`), а также флаг `--resource-type`, который предлагает финальную фильтрацию (так же, как и `list`). Какие бы ресурсы ни были выбраны, именно они будут запущены/протестированы/сделаны снимки/загружены.
- Помните, что тесты поддерживают косвенный выбор, поэтому `dbt build -s model_a` будет как запускать, так и тестировать `model_a`. Что это значит? Любые тесты, которые напрямую зависят от `model_a`, будут включены, при условии, что эти тесты не зависят от других невыбранных родителей. См. [выбор тестов](/reference/node-selection/test-selection-examples) для получения подробностей и примеров.

**Флаги:** Задача `build` поддерживает все те же флаги, что и `run`, `test`, `snapshot` и `seed`. Для флагов, которые общие для нескольких задач (например, `--full-refresh`), `build` будет использовать одно и то же значение для всех выбранных типов ресурсов (например, как модели, так и начальные данные будут полностью обновлены).

<VersionBlock firstVersion="1.8">

### Флаг `--empty`

Команда `build` поддерживает флаг `--empty` для создания схемных "сухих" запусков. Флаг `--empty` ограничивает ссылки и источники до нуля строк. dbt все равно выполнит SQL модели против целевого хранилища данных, но избегает дорогих чтений входных данных. Это проверяет зависимости и гарантирует, что ваши модели будут правильно собраны.

import SQLCompilationError from '/snippets/_render-method.md';

<SQLCompilationError />

## Тесты

Когда команда `dbt build` выполняется с применением юнит-тестов, модели обрабатываются в соответствии с их родословной и зависимостями. Тесты выполняются следующим образом:

- [Юнит-тесты](/docs/build/unit-tests) выполняются на SQL модели.
- Модель материализуется.
- [Тесты данных](/docs/build/data-tests) выполняются на модели.

Это экономит средства на хранилище, так как модель будет материализована только в случае успешного прохождения юнит-тестов.

Юнит-тесты и тесты данных могут быть выбраны с помощью `--select test_type:unit` или `--select test_type:data` для `dbt build` (то же самое для флага `--exclude`).

</VersionBlock>

### Примеры

```
$ dbt build
Запуск с dbt=0.21.0-b2
Найдено 1 модель, 4 теста, 1 снимок, 1 анализ, 341 макрос, 0 операций, 1 файл начальных данных, 2 источника, 2 экспозиции

18:49:43 | Параллелизм: 1 поток (target='dev')
18:49:43 |
18:49:43 | 1 из 7 НАЧАЛ загрузка файла начальных данных dbt_jcohen.my_seed............................ [RUN]
18:49:43 | 1 из 7 ОК загружен файл начальных данных dbt_jcohen.my_seed........................ [INSERT 2 за 0.09с]
18:49:43 | 2 из 7 НАЧАЛ создание представления модели dbt_jcohen.my_model.......................... [RUN]
18:49:43 | 2 из 7 ОК создано представление модели dbt_jcohen.my_model..................... [CREATE VIEW за 0.12с]
18:49:43 | 3 из 7 НАЧАЛ тест not_null_my_seed_id................................ [RUN]
18:49:43 | 3 из 7 ПРОЙДЕН not_null_my_seed_id...................................... [PASS за 0.05с]
18:49:43 | 4 из 7 НАЧАЛ тест unique_my_seed_id.................................. [RUN]
18:49:43 | 4 из 7 ПРОЙДЕН unique_my_seed_id........................................ [PASS за 0.03с]
18:49:43 | 5 из 7 НАЧАЛ создание снимка snapshots.my_snapshot.......................... [RUN]
18:49:43 | 5 из 7 ОК создан снимок snapshots.my_snapshot.......................... [INSERT 0 5 за 0.27с]
18:49:43 | 6 из 7 НАЧАЛ тест not_null_my_model_id............................... [RUN]
18:49:43 | 6 из 7 ПРОЙДЕН not_null_my_model_id..................................... [PASS за 0.03с]
18:49:43 | 7 из 7 НАЧАЛ тест unique_my_model_id................................. [RUN]
18:49:43 | 7 из 7 ПРОЙДЕН unique_my_model_id....................................... [PASS за 0.02с]
18:49:43 |
18:49:43 | Завершено выполнение 1 начальных данных, 1 представления модели, 4 тестов, 1 снимка за 1.01с.

Завершено успешно

Готово. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
```