---
title: "Логи"
id: "logs"
sidebar: "logs"
---

### Форматирование логов

dbt выводит логи в двух разных местах: консоль CLI и файл логов.

Конфигурации `LOG_FORMAT` и `LOG_FORMAT_FILE` определяют, как должны быть отформатированы логи dbt, и у них есть одинаковые параметры: `json`, `text` и `debug`.

<File name='Использование'>

```text
dbt --log-format json run
```

</File>

Формат `text` является значением по умолчанию для логов консоли и содержит простые текстовые сообщения с префиксом в виде временной метки:

```
23:30:16  Запуск с dbt=1.8.0
23:30:17  Зарегистрированный адаптер: postgres=1.8.0
```

Формат `debug` является значением по умолчанию для файла логов и аналогичен формату `text`, но с более детальной временной меткой и также включает [`invocation_id`](/reference/dbt-jinja-functions/invocation_id), [`thread_id`](/reference/dbt-jinja-functions/thread_id) и [уровень логирования](/reference/global-configs/logs#log-level) каждого сообщения:

```
============================== 16:12:08.555032 | 9089bafa-4010-4f38-9b42-564ec9106e07 ==============================
16:12:08.555032 [info ] [MainThread]: Запуск с dbt=1.8.0
16:12:08.751069 [info ] [MainThread]: Зарегистрированный адаптер: postgres=1.8.0
```

Формат `json` выводит полностью структурированные логи в формате <Term id="json" />:

```json
{"data": {"log_version": 3, "version": "=1.8.0"}, "info": {"category": "", "code": "A001", "extra": {}, "invocation_id": "82131fa0-d2b4-4a77-9436-019834e22746", "level": "info", "msg": "Запуск с dbt=1.8.0", "name": "MainReportVersion", "pid": 7875, "thread": "MainThread", "ts": "2024-05-29T23:32:54.993336Z"}}
{"data": {"adapter_name": "postgres", "adapter_version": "=1.8.0"}, "info": {"category": "", "code": "E034", "extra": {}, "invocation_id": "82131fa0-d2b4-4a77-9436-019834e22746", "level": "info", "msg": "Зарегистрированный адаптер: postgres=1.8.0", "name": "AdapterRegistered", "pid": 7875, "thread": "MainThread", "ts": "2024-05-29T23:32:56.437986Z"}}
```

Когда `LOG_FORMAT` установлен явно, он будет применяться как в консоли, так и в файлах логов, в то время как `LOG_FORMAT_FILE` влияет только на файл логов.

<File name='Использование'>

```text
dbt --log-format-file json run
```

</File>

:::tip Совет: подробные структурированные логи

Используйте значение форматирования `json` вместе с конфигурацией `DEBUG`, чтобы получить богатую информацию о логах, которую можно передавать в инструменты мониторинга для анализа:

```text
dbt --debug --log-format json run
```

Смотрите [структурированное логирование](/reference/events-logging#structured-logging) для получения дополнительных сведений.

:::

### Уровень логирования

Конфигурация `LOG_LEVEL` устанавливает минимальную серьезность событий, фиксируемых в логах консоли и файла. Это более гибкая альтернатива флагу `--debug`. Доступные параметры для уровней логирования: `debug`, `info`, `warn`, `error` или `none`.

- Установка `--log-level` настроит логи консоли и файла. 

  ```text
  dbt --log-level debug run
  ```

- Установка `LOG_LEVEL` в `none` отключит отправку информации как в консоль, так и в файлы логов. 
  
  ```text
  dbt --log-level none
  ```

- Чтобы установить уровень логирования файла на значение, отличное от консоли, используйте флаг `--log-level-file`. 

  ```text
  dbt --log-level-file error run
  ```

- Чтобы отключить запись в файл логов, но оставить логи консоли, установите конфигурацию `LOG_LEVEL_FILE` в `none`.
  ```text
  dbt --log-level-file none
  ```

### Логирование на уровне отладки

Конфигурация `DEBUG` перенаправляет отладочные логи dbt на стандартный вывод. Это приводит к тому, что информация уровня отладки отображается в терминале, помимо файла `logs/dbt.log`. Этот вывод является подробным.

Флаг `--debug` также доступен в сокращенной форме как `-d`.

<File name='Использование'>

```text
dbt --debug run
...

```

</File>  

### Пути логов и целевых файлов

По умолчанию dbt будет записывать логи в директорию с именем `logs/`, а все другие артефакты — в директорию с именем `target/`. Обе эти директории расположены относительно `dbt_project.yml` активного проекта.

Как и другие глобальные конфигурации, вы можете переопределить эти значения для вашей среды или вызова, используя параметры CLI (`--target-path`, `--log-path`) или переменные окружения (`DBT_TARGET_PATH`, `DBT_LOG_PATH`).

### Подавление неошибочных логов в выводе

По умолчанию dbt показывает все логи в стандартном выводе (stdout). Вы можете использовать конфигурацию `QUIET`, чтобы показывать только логи ошибок в stdout. Логи все равно будут включать вывод всего, что передается в макрос [`print()`](/reference/dbt-jinja-functions/print). Например, вы можете подавить все, кроме логов ошибок, чтобы легче находить и отлаживать ошибки jinja.

<File name='profiles.yml'>

```yaml
config:
  quiet: true
```

</File>

Передайте флаг `-q` или `--quiet` в `dbt run`, чтобы показывать только логи ошибок и подавить неошибочные логи.

```text
dbt --quiet run
...
```

### Логирование команды dbt list

В [версии dbt 1.5](/docs/dbt-versions/core-upgrade/upgrading-to-v1.5#behavior-changes) мы обновили поведение логирования команды [dbt list](/reference/commands/list), чтобы по умолчанию включать логи уровня `INFO`.


Вы можете использовать любой из этих параметров, чтобы обеспечить чистый вывод, совместимый с последующими процессами, такими как передача результатов в [`jq`](https://jqlang.github.io/jq/manual/), файл или другой процесс:

- `dbt --log-level warn list` (рекомендуется; эквивалентно предыдущему значению по умолчанию)
- `dbt --quiet list` (подавляет все логи ниже уровня `ERROR`, за исключением "выведенных" сообщений и вывода списка)


### Логирование событий кэширования реляционных данных

import LogLevel from '/snippets/_log-relational-cache.md';

<LogLevel
event={<a href="https://docs.getdbt.com/reference/global-configs/cache">реляционный кэш</a>}
/>

### Цвет

Вы можете установить предпочтения по цвету только для файлов логов в `profiles.yml` или с помощью флагов `--use-colors-file / --no-use-colors-file`.

<File name='profiles.yml'>

```yaml
config:
  use_colors_file: False
```

</File>

```text
dbt --use-colors-file run
dbt --no-use-colors-file run
```