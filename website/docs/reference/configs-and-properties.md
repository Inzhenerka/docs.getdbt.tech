---
title: Конфигурации, свойства, что это такое?
---

Ресурсы в вашем проекте — модели, снимки, семена, тесты и другие — могут иметь ряд объявленных **свойств**. Ресурсы также могут определять **конфигурации**, которые являются особым видом свойств, предоставляющим дополнительные возможности. В чем разница?
- Свойства объявляются для ресурсов по одному в файлах `properties.yml`. Конфигурации могут быть определены там, вложенные под свойством `config`. Их также можно задавать по одному с помощью макроса `config()` (прямо в `.sql` файлах) и для многих ресурсов сразу в `dbt_project.yml`.
- Поскольку конфигурации могут задаваться в нескольких местах, они также применяются иерархически. Отдельный ресурс может _наследовать_ или _переопределять_ конфигурации, заданные в других местах.
- Вы можете выбирать ресурсы на основе значений их конфигураций, используя метод выбора `config:`, но не значения несоответствующих свойств.
- Существуют немного разные соглашения о наименовании для свойств и конфигураций в зависимости от типа файла. Смотрите [соглашение о наименовании](/reference/dbt_project.yml#naming-convention) для получения дополнительных сведений.

Правило: свойства объявляют вещи _о_ ваших ресурсах проекта; конфигурации делают дополнительный шаг, сообщая dbt _как_ строить эти ресурсы в вашем хранилище данных. Это обычно верно, но не всегда, поэтому всегда полезно проверять!

Например, вы можете использовать **свойства** ресурса для:
* Описания моделей, снимков, файлов семян и их столбцов
* Утверждения "истин" о модели в форме [тестов данных](/docs/build/data-tests), например, "этот столбец `id` уникален"
* Определения указателей на существующие таблицы, содержащие сырые данные, в форме [источников](/docs/build/sources), и утверждения ожидаемой "свежести" этих сырых данных
* Определения официальных downstream-использований ваших моделей данных в форме [экспозиций](/docs/build/exposures)

В то время как вы можете использовать **конфигурации** для:
* Изменения того, как модель будет материализована (<Term id="table" />, <Term id="view" />, инкрементально и т.д.)
* Объявления, где семя будет создано в базе данных (`<database>.<schema>.<alias>`)
* Объявления, должно ли ресурс сохранять свои описания в виде комментариев в базе данных
* Применения тегов и "мета" свойств

## Где я могу определить конфигурации?

В зависимости от типа ресурса конфигурации могут быть определены в проекте dbt, а также в установленном пакете:

<VersionBlock firstVersion="1.9">

1. Используя свойство [`config`](/reference/resource-properties/config) в файле `.yml` в директории `models/`, `snapshots/`, `seeds/`, `analyses` или `tests/`
2. Из файла [`dbt_project.yml`](dbt_project.yml), под соответствующим ключом ресурса (`models:`, `snapshots:`, `tests:`, и т.д.)
</VersionBlock>

<VersionBlock lastVersion="1.8">

1. Используя макрос [`config()`](/reference/dbt-jinja-functions/config) Jinja в SQL файле `model`, `snapshot` или `test`
2. Используя свойство [`config`](/reference/resource-properties/config) в файле `.yml` в директории `models/`, `snapshots/`, `seeds/`, `analyses` или `tests/`.
3. Из файла [`dbt_project.yml`](dbt_project.yml), под соответствующим ключом ресурса (`models:`, `snapshots:`, `tests:`, и т.д.)
</VersionBlock>

### Наследование конфигураций

Наиболее специфическая конфигурация всегда имеет приоритет. Это обычно следует порядку, указанному выше: блок `config()` в файле --> свойства, определенные в файле `.yml` --> конфигурация, определенная в проектном файле.

Примечание - Общие тесты данных работают немного иначе, когда дело касается специфичности. Смотрите [конфигурации тестов](/reference/data-test-configs).

Внутри проектного файла конфигурации также применяются иерархически. Наиболее специфическая конфигурация всегда имеет приоритет. Например, в проектном файле конфигурации, примененные к подкаталогу `marketing`, будут иметь приоритет над конфигурациями, примененными ко всему проекту `jaffle_shop`. Чтобы применить конфигурацию к модели или каталогу моделей, определите [путь к ресурсу](/reference/resource-configs/resource-path) в виде вложенных ключей словаря.

Конфигурации в вашем корневом проекте dbt имеют _больший_ приоритет, чем конфигурации в установленных пакетах. Это позволяет вам переопределять конфигурации установленных пакетов, предоставляя больше контроля над вашими запусками dbt.

### Сочетание конфигураций

Большинство конфигураций "перекрываются" при иерархическом применении. Каждый раз, когда доступно более специфичное значение, оно полностью заменяет менее специфичное значение. Обратите внимание, что несколько конфигураций имеют другое поведение при слиянии:
- [`tags`](/tags) являются аддитивными. Если у модели есть некоторые теги, настроенные в `dbt_project.yml`, и больше тегов, примененных в ее `.sql` файле, окончательный набор тегов будет включать все из них.
- Словари [`meta`](/reference/resource-configs/meta) объединяются (более специфическая пара ключ-значение заменяет менее специфичное значение с тем же ключом)
- [`pre-hook` и `post-hook`](/reference/resource-configs/pre-hook-post-hook) также являются аддитивными.

## Где я могу определить свойства?

В dbt вы можете использовать файлы `properties.yml` для определения свойств ресурсов. Вы можете объявлять свойства в файлах `.yml`, в той же директории, что и ваши ресурсы. Вы можете назвать эти файлы `whatever_you_want.yml` и вложить их произвольно в подпапки в каждой директории.

Мы настоятельно рекомендуем определять свойства в выделенных путях рядом с ресурсами, которые они описывают.

:::info

#### файлы schema.yml

Предыдущие версии документации называли их файлами `schema.yml` — мы отошли от этой терминологии, поскольку слово `schema` используется для обозначения других вещей, когда речь идет о базах данных, и люди часто думали, что вы _должны_ называть эти файлы `schema.yml`.

Вместо этого мы теперь называем эти файлы `properties.yml`. (Конечно, вы все еще можете называть свои файлы `schema.yml`)

:::

### Какие свойства _не_ являются также конфигурациями?

В dbt вы можете определять конфигурации узлов в файлах `properties.yml`, помимо блоков `config()` и `dbt_project.yml`. Однако некоторые специальные свойства могут быть определены только в файле `.yml`, и вы не можете настраивать их с помощью блоков `config()` или файла `dbt_project.yml`:

Некоторые свойства являются специальными, потому что:

- У них есть уникальный контекст рендеринга Jinja
- Они создают новые ресурсы проекта
- Они не имеют смысла как иерархическая конфигурация
- Это более старые свойства, которые еще не были переопределены как конфигурации

Эти свойства:
- [`description`](/reference/resource-properties/description)
- [`tests`](/reference/resource-properties/data-tests)
- [`docs`](/reference/resource-configs/docs)
- [`columns`](/reference/resource-properties/columns)
- [`quote`](/reference/resource-properties/quote)
- [`source` свойства](/reference/source-properties) (например, `loaded_at_field`, `freshness`)
- [`exposure` свойства](/reference/exposure-properties) (например, `type`, `maturity`)
- [`macro` свойства](/reference/macro-properties) (например, `arguments`)

## Пример
Вот пример, который определяет как `sources`, так и `models` для проекта:

<File name='models/jaffle_shop.yml'>

```yml
version: 2

sources:
  - name: raw_jaffle_shop
    description: Реплика базы данных Postgres, используемой для работы приложения jaffle_shop.
    tables:
      - name: customers
        columns:
          - name: id
            description: Первичный ключ таблицы
            tests:
              - unique
              - not_null

      - name: orders
        columns:
          - name: id
            description: Первичный ключ таблицы
            tests:
              - unique
              - not_null

          - name: user_id
            description: Внешний ключ к customers

          - name: status
            tests:
              - accepted_values:
                  values: ['placed', 'shipped', 'completed', 'return_pending', 'returned']


models:
  - name: stg_jaffle_shop__customers
    config:
      tags: ['pii']
    columns:
      - name: customer_id
        tests:
          - unique
          - not_null

  - name: stg_jaffle_shop__orders
    config:
      materialized: view
    columns:
      - name: order_id
        tests:
          - unique
          - not_null
      - name: status
        tests:
          - accepted_values:
              values: ['placed', 'shipped', 'completed', 'return_pending', 'returned']
              config:
                severity: warn


```

</File>


## Связанная документация
Вы можете найти исчерпывающий список каждого поддерживаемого свойства и конфигурации, разбитый по типу ресурса:
* Свойства [моделей](/reference/model-properties) и [конфигурации](/reference/model-configs)
* Свойства [источников](/reference/source-properties) и [конфигурации](source-configs)
* Свойства [семян](/reference/seed-properties) и [конфигурации](/reference/seed-configs)
* Свойства [снимков](snapshot-properties)
* Свойства [анализов](analysis-properties)
* Свойства [макросов](/reference/macro-properties)
* Свойства [экспозиций](/reference/exposure-properties)

## Часто задаваемые вопросы
<FAQ path="Project/schema-yml-name" />
<FAQ path="Project/resource-yml-name" />
<FAQ path="Project/multiple-resource-yml-files" />
<FAQ path="Project/properties-not-in-config" />
<FAQ path="Project/why-version-2" />
<FAQ path="Project/yaml-file-extension" />

## Устранение распространенных ошибок

### Неверная конфигурация теста, указанная в [имени модели]

Эта ошибка возникает, когда ваш файл `.yml` не соответствует структуре, ожидаемой dbt. Полное сообщение об ошибке может выглядеть так:
```
* Неверная конфигурация теста, указанная в models/schema.yml рядом с {'namee': 'event', ...}
  Неверные аргументы, переданные экземпляру "UnparsedNodeUpdate": 'name' является обязательным свойством, Дополнительные свойства не допускаются ('namee' было неожиданным)
```

Хотя сообщение длинное, такая ошибка должна помочь вам найти проблему. Здесь поле `name` было случайно указано как `namee`. Чтобы исправить эту ошибку, убедитесь, что ваш файл `.yml` соответствует ожидаемой структуре, описанной в этом руководстве.

### Неверный синтаксис в вашем файле schema.yml

Если ваш файл `.yml` не является допустимым yaml, то dbt покажет вам ошибку, подобную этой:

```
Runtime Error
  Ошибка синтаксиса рядом с строкой 6
  ------------------------------
  5  |   - name: events
  6  |     description; "Таблица, содержащая события кликов с маркетингового сайта"
  7  |

  Сырой Ошибка:
  ------------------------------
  во время сканирования простого ключа
    в "<unicode string>", строка 6, столбец 5:
          description; "Таблица, содержащая события кликов с маркетингового сайта"
          ^

```

Эта ошибка произошла, потому что вместо двоеточия (`:`) после поля `description` случайно был использован знак точки с запятой (`;`). Чтобы решить подобные проблемы, найдите файл `.yml`, упомянутый в сообщении об ошибке, и исправьте любые синтаксические ошибки, присутствующие в файле. Существуют онлайн-валидаторы YAML, которые могут быть полезны в этом, но, пожалуйста, будьте осторожны с отправкой конфиденциальной информации третьим лицам!