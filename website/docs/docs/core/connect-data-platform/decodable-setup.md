---
title: "Настройка Decodable"
id: "decodable-setup"
meta:
  maintained_by: Decodable
  authors: "Decodable Team"
  github_repo: 'decodableco/dbt-decodable'
  pypi_package: 'dbt-decodable'
  min_core_version: '1.3.1'
  core_version: ''
  cloud_support: Не поддерживается
  min_supported_version: 'n/a'
  slack_channel_name: '#general'
  slack_channel_link: 'https://decodablecommunity.slack.com'
  platform_name: 'Decodable'
  config_page: '/reference/resource-configs/no-configs'
---

:::info Плагин сообщества

Некоторая основная функциональность может быть ограничена. Если вы заинтересованы в участии, ознакомьтесь с исходным кодом репозитория, указанного ниже.
:::

import SetUpPages from '/snippets/_setup-pages-intro.md';

<SetUpPages meta={frontMatter.meta} />

## Подключение к Decodable с помощью **dbt-decodable**
Выполните следующие шаги для подключения к Decodable с помощью dbt.

### Предварительные условия
Для правильного подключения к Decodable у вас должен быть установлен Decodable CLI, и вы должны хотя бы раз войти в Decodable с его помощью. См. <a href="https://docs.decodable.co/docs/setup#install-the-cli-command-line-interface">Установка Decodable CLI</a> для получения дополнительной информации.

### Шаги
Чтобы подключиться к Decodable с помощью dbt, вам нужно добавить профиль Decodable в ваш файл `profiles.yml`. Профиль Decodable имеет следующие поля.

<File name='~/.dbt/profiles.yml'>

```yaml
dbt-decodable:       
  target: dev         
  outputs:           
    dev:              
      type: decodable
      database: None  
      schema: None    
      account_name: [your account]          
      profile_name: [name of the profile]   
      materialize_tests: [true | false]     
      timeout: [ms]                         
      preview_start: [earliest | latest]    
      local_namespace: [namespace prefix]   

```

</File>

#### Описание полей профиля

| Опция   | Описание                                          | Обязательно? | Пример             |
|----------|------------------------------------------------------|-----------|---------------------|
| type     | Конкретный адаптер для использования                          | Обязательно  | `decodable`              |
| database | Обязательно, но не используется этим адаптером.                 | Обязательно  |    |
| schema   | Обязательно, но не используется этим адаптером.                                   | Обязательно  |               |
| account_name | Имя вашего аккаунта Decodable.        | Обязательно  | `my_awesome_decodable_account`         |
| profile_name | Имя вашего профиля Decodable. | Обязательно  | `my_awesome_decodable_profile`  |
| materialize_tests  | Укажите, нужно ли материализовать тесты как пару pipeline/stream. По умолчанию false.     | Необязательно  | `false`         |
| timeout  | Время в миллисекундах, в течение которого выполняется запрос предварительного просмотра. По умолчанию 60000.   | Необязательно  | `60000`         |
| preview_start  | Укажите, откуда должен начинаться предварительный просмотр данных. Если установлено значение `earliest`, предварительный просмотр начнется с самой ранней возможной записи. Если установлено значение `latest`, предварительный просмотр начнется с последней записи. По умолчанию `earliest`.     | Необязательно  | `latest`         |
| local_namespace  | Укажите префикс, который будет добавлен ко всем создаваемым на Decodable сущностям. По умолчанию `none`, что означает, что префикс не добавляется.    | Необязательно  | `none`         |


## Поддерживаемые функции

| Название | Поддерживается | Примечания |
|---|---|---|
| Материализация таблиц | Да | Поддерживается только материализация таблиц. Модель dbt таблицы преобразуется в пару pipeline/stream в Decodable, обе части имеют одно и то же имя. Пайплайны для моделей автоматически активируются при материализации. Чтобы материализовать ваши модели, выполните команду `dbt run`, которая выполняет следующие действия:  <ol> <li>Создает поток с именем модели и схемой, определенной Decodable из SQL модели. </li> <li>Создает пайплайн, который вставляет результаты SQL в только что созданный поток. </li> <li>Активирует пайплайн.</li> </ol> По умолчанию адаптер не удаляет и не пересоздает модель на Decodable, если не обнаружены изменения в модели. Вызов dbt с флагом `--full-refresh` или установка этой опции конфигурации для конкретной модели приводит к уничтожению и созданию соответствующих ресурсов на Decodable с нуля. |
| Материализация представлений | Нет |  |
| Инкрементальная материализация | Нет |  |
| Эфемерная материализация | Нет |  |
| Seeds | Да | Выполнение команды `dbt seed` выполняет следующие шаги для каждого указанного seed:   <ol> <li> Создает REST-соединение и связанный с ним поток с тем же именем, что и у seed. </li> <li> Активирует соединение. </li> <li> Отправляет данные, хранящиеся в файле `.csv` seed, в соединение как события.</li> <li> Деактивирует соединение. </li> </ol> После завершения выполнения команды `dbt seed` вы можете получить доступ к данным seed в только что созданном потоке.  |
| Тесты | Да | Команда `dbt test` ведет себя по-разному в зависимости от опции `materialize_tests`, установленной для указанной цели.  <br/><br/> Если `materialize_tests = false`, то тесты выполняются только после завершения задания предварительного просмотра и возврата результатов. Время выполнения задания предварительного просмотра, а также какие записи возвращаются, определяются конфигурациями `timeout` и `preview_start` соответственно.  <br/><br/> Если `materialize_tests = true`, то dbt сохраняет указанные тесты как пары pipeline/stream в Decodable. Используйте эту конфигурацию для непрерывного тестирования ваших моделей. Вы можете запустить предварительный просмотр на созданном потоке с помощью Decodable CLI или веб-интерфейса для мониторинга результатов.  |
| Источники | Нет | Источники в dbt соответствуют соединениям источников Decodable. Однако команда `dbt source` не поддерживается.  |
| Генерация документации | Нет | Для получения информации о ваших моделях проверьте ваш аккаунт Decodable.  |
| Снимки | Нет | Снимки и команда `dbt snapshot` не поддерживаются.  |

## Дополнительные операции 

`dbt-decodable` предоставляет набор команд для управления ресурсами проекта на Decodable. Эти команды можно выполнить с помощью `dbt run-operation {name} --args {args}`.

Например, следующая команда выполняет операцию `delete_streams`  
```
dbt run-operation delete_streams --args '{streams: [stream1, stream2], skip_errors: True}'
```

<b>stop_pipelines(pipelines)</b>
<ul>
  <li>pipelines: Необязательный список имен пайплайнов для деактивации. По умолчанию none.</li>
</ul>
Деактивировать все пайплайны для ресурсов, определенных в проекте. Если аргумент pipelines предоставлен, то деактивируются только указанные пайплайны.
<br/><br/>


<b>delete_pipelines(pipelines)</b>
<ul>
  <li>pipelines: Необязательный список имен пайплайнов для удаления. По умолчанию none.</li>
</ul>
Удалить все пайплайны для ресурсов, определенных в проекте. Если аргумент pipelines предоставлен, то удаляются только указанные пайплайны.
<br/><br/>


<b>delete_streams(streams, skip_errors)</b>
<ul>
  <li>streams: Необязательный список имен потоков для удаления. По умолчанию none.</li>
  <li>skip_errors: Укажите, следует ли рассматривать ошибки как предупреждения. Если установлено значение true, любые ошибки удаления потока сообщаются как предупреждения. Если установлено значение false, операция останавливается, когда поток не может быть удален. По умолчанию true.</li>
</ul>
Удалить все потоки для ресурсов, определенных в проекте. Если поток связан с пайплайном, то ни пайплайн, ни поток не удаляются. См. операцию очистки для полного удаления пар поток/пайплайн. <br/><br/>


<b>cleanup(list, models, seeds, tests)</b>
<ul>
<li>list: Необязательный список имен сущностей ресурсов для удаления. По умолчанию none.</li>
<li>models: Укажите, следует ли включать модели при очистке. По умолчанию true.</li>
<li>seeds: Укажите, следует ли включать seeds при очистке. По умолчанию true.</li>
<li>tests: Укажите, следует ли включать тесты при очистке. По умолчанию true.</li>
</ul>
<br /><br />Удалить все сущности Decodable, полученные в результате материализации ресурсов проекта, т.е. соединения, потоки и пайплайны.
Если аргумент list предоставлен, то удаляются только указанные сущности ресурсов.
Если аргументы models, seeds или tests предоставлены, то эти типы ресурсов также включаются в очистку. Тесты, которые не были материализованы, не включаются в очистку.