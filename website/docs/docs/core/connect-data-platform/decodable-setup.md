---
title: "Настройка Decodable"
id: "decodable-setup"
meta:
  maintained_by: Decodable
  authors: "Команда Decodable"
  github_repo: 'decodableco/dbt-decodable'
  pypi_package: 'dbt-decodable'
  min_core_version: '1.3.1'
  core_version: ''
  cloud_support: Не поддерживается
  min_supported_version: 'n/a'
  slack_channel_name: '#general'
  slack_channel_link: 'https://decodablecommunity.slack.com'
  platform_name: 'Decodable'
  config_page: '/reference/resource-configs/no-configs'
---

:::info Плагин сообщества

Некоторые основные функции могут быть ограничены. Если вы хотите внести свой вклад, посмотрите исходный код в репозитории, указанном ниже.
:::

import SetUpPages from '/snippets/_setup-pages-intro.md';

<SetUpPages meta={frontMatter.meta} />

## Подключение к Decodable с помощью **dbt-decodable**
Выполните следующие шаги, чтобы подключиться к Decodable с помощью dbt.

### Предварительные условия
Чтобы правильно подключиться к Decodable, вы должны установить Decodable CLI и хотя бы один раз войти в Decodable с его помощью. См. <a href="https://docs.decodable.co/docs/setup#install-the-cli-command-line-interface">Установка Decodable CLI</a> для получения дополнительной информации.

### Шаги
Чтобы подключиться к Decodable с помощью dbt, вам нужно добавить профиль Decodable в файл `profiles.yml`. Профиль Decodable имеет следующие поля.

<File name='~/.dbt/profiles.yml'>

```yaml
dbt-decodable:       
  target: dev         
  outputs:           
    dev:              
      type: decodable
      database: None  
      schema: None    
      account_name: [ваш аккаунт]          
      profile_name: [имя профиля]   
      materialize_tests: [true | false]     
      timeout: [ms]                         
      preview_start: [earliest | latest]    
      local_namespace: [префикс пространства имен]   

```

</File>

#### Описание полей профиля

| Опция   | Описание                                          | Обязательно? | Пример             |
|----------|------------------------------------------------------|-----------|---------------------|
| type     | Конкретный адаптер для использования                          | Обязательно  | `decodable`              |
| database | Обязательно, но не используется этим адаптером.                 | Обязательно  |    |
| schema   | Обязательно, но не используется этим адаптером.                                   | Обязательно  |               |
| account_name | Имя вашего аккаунта Decodable.        | Обязательно  | `my_awesome_decodable_account`         |
| profile_name | Имя вашего профиля Decodable. | Обязательно  | `my_awesome_decodable_profile`  |
| materialize_tests  | Укажите, следует ли материализовать тесты как пару конвейер/поток. По умолчанию - false.     | Необязательно  | `false`         |
| timeout  | Время, в миллисекундах, в течение которого выполняется запрос на предварительный просмотр. По умолчанию - 60000.   | Необязательно  | `60000`         |
| preview_start  | Укажите, с какого места должен начинаться предварительный просмотр данных. Если установлено на `earliest`, то предварительный просмотр начнется с самой ранней записи. Если установлено на `latest`, предварительный просмотр начнется с самой последней записи. По умолчанию - `earliest`.     | Необязательно  | `latest`         |
| local_namespace  | Укажите префикс, который будет добавлен ко всем сущностям, созданным в Decodable. По умолчанию - `none`, что означает, что префикс не добавляется.    | Необязательно  | `none`         |


## Поддерживаемые функции

| Название | Поддерживается | Примечания |
|---|---|---|
| Материализация таблиц | Да | Поддерживается только материализация таблиц. Модель таблицы dbt переводится в пару конвейер/поток в Decodable, оба имеют одно и то же имя. Конвейеры для моделей автоматически активируются при материализации. Чтобы материализовать ваши модели, выполните команду `dbt run`, которая выполняет следующие действия:  <ol> <li>Создает поток с именем модели и схемой, определенной Decodable на основе SQL модели.</li> <li>Создает конвейер, который вставляет результаты SQL в только что созданный поток.</li> <li>Активирует конвейер.</li> </ol> По умолчанию адаптер не разрушает и не воссоздает модель в Decodable, если изменения в модели не были обнаружены. Вызов dbt с флагом `--full-refresh` или установка этой конфигурационной опции для конкретной модели приводит к уничтожению соответствующих ресурсов в Decodable и их созданию с нуля. |
| Материализация представлений | Нет |  |
| Инкрементальная материализация | Нет |  |
| Эфемерная материализация | Нет |  |
| Seeds | Да | Выполнение команды `dbt seed` выполняет следующие шаги для каждого указанного seed:   <ol> <li> Создает REST-соединение и связанный поток с тем же именем, что и seed. </li> <li> Активирует соединение. </li> <li> Отправляет данные, хранящиеся в `.csv` файле seed, в соединение как события.</li> <li> Деактивирует соединение. </li> </ol> После завершения выполнения команды `dbt seed` вы можете получить доступ к данным seed в только что созданном потоке.  |
| Тесты | Да | Команда `dbt test` ведет себя по-разному в зависимости от установленной опции `materialize_tests` для указанной цели.  <br/><br/> Если `materialize_tests = false`, то тесты выполняются только после завершения работы предварительной задачи и получения результатов. Время выполнения предварительной задачи, а также какие записи возвращаются, определяются соответственно конфигурациями `timeout` и `preview_start`.  <br/><br/> Если `materialize_tests = true`, то dbt сохраняет указанные тесты как пары конвейер/поток в Decodable. Используйте эту конфигурацию для обеспечения непрерывного тестирования ваших моделей. Вы можете запустить предварительный просмотр на созданном потоке с помощью Decodable CLI или веб-интерфейса, чтобы отслеживать результаты.  |
| Источники | Нет | Источники в dbt соответствуют соединениям источников Decodable. Однако команда `dbt source` не поддерживается.  |
| Генерация документации | Нет | Для получения информации о ваших моделях проверьте свой аккаунт Decodable.  |
| Снимки | Нет | Снимки и команда `dbt snapshot` не поддерживаются.  |

## Дополнительные операции

`dbt-decodable` предоставляет набор команд для управления ресурсами проекта в Decodable. Эти команды можно выполнять с помощью `dbt run-operation {name} --args {args}`.

Например, следующая команда выполняет операцию `delete_streams`  
```
dbt run-operation delete_streams --args '{streams: [stream1, stream2], skip_errors: True}'
```

<b>stop_pipelines(pipelines)</b>
<ul>
  <li>pipelines: Необязательный список имен конвейеров для деактивации. По умолчанию - none.</li>
</ul>
Деактивирует все конвейеры для ресурсов, определенных в проекте. Если аргумент pipelines указан, то деактивируются только указанные конвейеры.
<br/><br/>

<b>delete_pipelines(pipelines)</b>
<ul>
  <li>pipelines: Необязательный список имен конвейеров для удаления. По умолчанию - none.</li>
</ul>
Удаляет все конвейеры для ресурсов, определенных в проекте. Если аргумент pipelines указан, то удаляются только указанные конвейеры.
<br/><br/>

<b>delete_streams(streams, skip_errors)</b>
<ul>
  <li>streams: Необязательный список имен потоков для удаления. По умолчанию - none.</li>
  <li>skip_errors: Укажите, следует ли рассматривать ошибки как предупреждения. Если установлено на true, любые ошибки удаления потоков будут сообщаться как предупреждения. Если установлено на false, операция останавливается, когда поток не может быть удален. По умолчанию - true.</li>
</ul>
Удаляет все потоки для ресурсов, определенных в проекте. Если конвейер связан с потоком, то ни конвейер, ни поток не удаляются. См. операцию очистки для полного удаления пар поток/конвейер. <br/><br/>

<b>cleanup(list, models, seeds, tests)</b>
<ul>
<li>list: Необязательный список имен сущностей ресурсов для удаления. По умолчанию - none.</li>
<li>models: Укажите, следует ли включать модели во время очистки. По умолчанию - true.</li>
<li>seeds: Укажите, следует ли включать seeds во время очистки. По умолчанию - true.</li>
<li>tests: Укажите, следует ли включать тесты во время очистки. По умолчанию - true.</li>
</ul>
<br /><br />Удаляет все сущности Decodable, возникающие в результате материализации ресурсов проекта, т.е. соединения, потоки и конвейеры.
Если аргумент list указан, то удаляются только указанные сущности ресурсов.
Если указаны аргументы models, seeds или tests, то эти типы ресурсов также включаются в очистку. Тесты, которые не были материализированы, не включаются в очистку.