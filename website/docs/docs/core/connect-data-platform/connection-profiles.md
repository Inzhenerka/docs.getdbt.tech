---
title: "Профили подключения"
id: "connection-profiles"
description: "Настройте свой профиль с помощью командной строки."
---

Когда вы вызываете dbt из командной строки, dbt анализирует ваш файл `dbt_project.yml` и получает имя `profile`, которое необходимо для подключения к вашему <Term id="data-warehouse" />.

<File name='dbt_project.yml'>

```yaml
# Пример файла dbt_project.yml
name: 'jaffle_shop'
profile: 'jaffle_shop'
...
```

</File>

Затем dbt проверяет ваш [`profiles.yml` файл](/docs/core/connect-data-platform/profiles.yml) на наличие профиля с таким же именем. Профиль содержит все детали, необходимые для подключения к вашему хранилищу данных.

dbt будет искать файл `profiles.yml` в текущем рабочем каталоге и по умолчанию будет использовать каталог `~/.dbt/`, если файл не найден.

Этот файл обычно находится вне вашего проекта dbt, чтобы избежать проверки конфиденциальных учетных данных в системе контроля версий, но `profiles.yml` можно безопасно проверить, когда [используются переменные окружения](#advanced-using-environment-variables) для загрузки конфиденциальных учетных данных.

<File name='~/.dbt/profiles.yml'>

```yaml
# пример файла profiles.yml
jaffle_shop:
  target: dev
  outputs:
    dev:
      type: postgres
      host: localhost
      user: alice
      password: <password>
      port: 5432
      dbname: jaffle_shop
      schema: dbt_alice
      threads: 4
```

</File>


## О файле `profiles.yml`

В вашем файле `profiles.yml` вы можете хранить столько профилей, сколько вам нужно. Обычно у вас будет один профиль для каждого хранилища, которое вы используете. Большинство организаций имеют только один профиль.

Для получения информации о настройке расширенных параметров смотрите [страницу справки по `profiles.yml`](/docs/core/connect-data-platform/profiles.yml).

## О профилях

Профиль состоит из _целей_ и указанной _целевой_ цели по умолчанию.

Каждая _цель_ указывает тип хранилища, к которому вы подключаетесь, учетные данные для подключения к хранилищу и некоторые специфические для dbt настройки.

Учетные данные, которые вам необходимо предоставить в вашей цели, различаются в зависимости от хранилищ &mdash; примеры профилей для каждого поддерживаемого хранилища доступны в разделе [Поддерживаемые платформы данных](/docs/supported-data-platforms).

**Совет:** Вам может понадобиться заключить ваш пароль в кавычки, если он содержит специальные символы. Более подробная информация [здесь](https://stackoverflow.com/a/37015689/10415173).

## Настройка вашего профиля

Чтобы настроить ваш профиль, скопируйте правильный пример профиля для вашего хранилища в файл `profiles.yml` и обновите детали следующим образом:

* Имя профиля: Замените имя профиля на разумное имя – часто хорошей идеей является использование названия вашей организации. Убедитесь, что это то же имя, что указано в `profile` в вашем файле `dbt_project.yml`.
* `target`: Это целевая цель, которую будет использовать ваш проект dbt по умолчанию. Она должна быть одной из целей, которые вы определили в своем профиле. Обычно она устанавливается на `dev`.
* Заполнение вашей цели:
  * `type`: Тип хранилища данных, к которому вы подключаетесь.
  * Учетные данные хранилища: Получите их у вашего администратора базы данных, если у вас их еще нет. Помните, что учетные данные пользователя являются очень конфиденциальной информацией, которую не следует передавать.
  * `schema`: Схема по умолчанию, в которой dbt будет создавать объекты.
  * `threads`: Количество потоков, на которых будет работать проект dbt.

Вы можете найти больше информации о том, какие значения использовать в ваших целях ниже.

Используйте команду [debug](/reference/dbt-jinja-functions/debug-method) для проверки вашего подключения к хранилищу. Запустите `dbt debug` из проекта dbt, чтобы протестировать ваше соединение.


## Понимание целей в профилях

dbt поддерживает несколько целей в одном профиле, чтобы поощрять использование отдельных сред разработки и производства, как обсуждается в [Средах dbt Core](/docs/core/dbt-core-environments).

Типичный профиль для аналитика, использующего dbt локально, будет иметь цель с именем `dev`, и это будет установлено как значение по умолчанию.

Вы также можете иметь цель `prod` в вашем профиле, которая создает объекты в вашей производственной схеме. Однако, поскольку часто желательно выполнять производственные запуски по расписанию, мы рекомендуем развертывать ваш проект dbt на отдельной машине, отличной от вашей локальной. Большинство пользователей dbt имеют только цель `dev` в своем профиле на локальной машине.

Если у вас есть несколько целей в вашем профиле и вы хотите использовать цель, отличную от значения по умолчанию, вы можете сделать это, используя опцию `--target`, когда выполняете команду dbt.

## Понимание учетных данных хранилища

Мы рекомендуем, чтобы у каждого пользователя dbt был свой набор учетных данных базы данных, включая отдельного пользователя для производственных запусков dbt – это помогает отлаживать несанкционированные запросы, упрощает владение схемами и улучшает безопасность.

Чтобы убедиться, что учетные данные пользователя, которые вы используете в вашей цели, позволяют dbt работать, вам нужно убедиться, что у пользователя есть соответствующие привилегии. Хотя точные привилегии, необходимые для работы, различаются в зависимости от хранилищ данных, как минимум, ваш пользователь должен иметь возможность:

* читать исходные данные
* создавать схемы¹
* читать системные <Term id="table">таблицы</Term>

:::info Запуск dbt без привилегий на создание схем

Если вашему пользователю не удается получить привилегию на создание схем, ваши запуски dbt должны нацеливаться на существующую схему, в которой у вашего пользователя есть разрешение на создание отношений.

:::

## Понимание целевых схем

Целевая схема представляет собой схему по умолчанию, в которую dbt будет создавать объекты, и часто используется как различитель между отдельными средами в рамках хранилища.

:::info Схемы в BigQuery

dbt использует термин "схема" в цели во всех поддерживаемых хранилищах для согласованности. Обратите внимание, что в случае BigQuery схема на самом деле является набором данных.

:::

Схема, используемая для производства, должна быть названа так, чтобы было ясно, что она готова для конечных пользователей для анализа – мы часто называем ее `analytics`.

В разработке мы обнаружили, что хорошо работает паттерн, при котором схема в вашей цели `dev` называется `dbt_<username>`. Добавление вашего имени к схеме позволяет нескольким пользователям разрабатывать в dbt, поскольку у каждого пользователя будет своя отдельная схема для разработки, чтобы пользователи не накладывались друг на друга, и чтобы владение объектами и разрешения были согласованы по всей схеме.

Обратите внимание, что нет необходимости создавать вашу целевую схему заранее – dbt проверит, существует ли схема, когда он запускается, и создаст ее, если она не существует.

Хотя целевая схема представляет собой схему по умолчанию, которую будет использовать dbt, может иметь смысл разделить ваши модели на отдельные схемы, что можно сделать с помощью [пользовательских схем](/docs/build/custom-schemas).

## Понимание потоков

Когда dbt запускается, он создает направленный ациклический граф (DAG) связей между моделями. Количество потоков представляет собой максимальное количество путей через граф, над которыми dbt может работать одновременно – увеличение количества потоков может минимизировать время выполнения вашего проекта. Значение по умолчанию для потоков в пользовательских профилях составляет 4 потока.

Для получения дополнительной информации ознакомьтесь с [использованием потоков](/docs/running-a-dbt-project/using-threads).

## Расширенные возможности: Настройка каталога профиля

Родительский каталог для `profiles.yml` определяется с использованием следующего порядка:

1. опция `--profiles-dir`
1. переменная окружения `DBT_PROFILES_DIR`
1. текущий рабочий каталог
1. каталог `~/.dbt/`

Чтобы проверить ожидаемое местоположение вашего файла `profiles.yml` для вашей установки dbt, вы можете выполнить следующее:

```bash
$ dbt debug --config-dir
Чтобы просмотреть ваш файл profiles.yml, выполните:

open /Users/alice/.dbt
```

Вам может понадобиться хранить ваш файл `profiles.yml` в другом каталоге, чем `~/.dbt/` – например, если вы [используете переменные окружения](#advanced-using-environment-variables) для загрузки ваших учетных данных, вы можете выбрать включить этот файл в корневой каталог вашего проекта dbt.

Обратите внимание, что файл всегда должен называться `profiles.yml`, независимо от того, в каком каталоге он находится.

Существует несколько способов указать dbt другое местоположение для вашего файла `profiles.yml`:

### 1. Используйте опцию `--profiles-dir` при выполнении команды dbt
Эта опция может быть использована следующим образом:

 ```
$ dbt run --profiles-dir path/to/directory
 ```

Если вы используете этот метод, опцию `--profiles-dir` необходимо указывать каждый раз, когда вы выполняете команду dbt.

### 2. Используйте переменную окружения `DBT_PROFILES_DIR`, чтобы изменить расположение по умолчанию
Указание этой переменной окружения переопределяет каталог, в котором dbt ищет ваш файл `profiles.yml`. Вы можете указать это, выполнив:
```
$ export DBT_PROFILES_DIR=path/to/directory
```

## Расширенные возможности: Использование переменных окружения

Учетные данные могут быть помещены непосредственно в файл `profiles.yml` или загружены из переменных окружения. Использование переменных окружения особенно полезно для производственных развертываний dbt. Вы можете найти больше информации о переменных окружения [здесь](/reference/dbt-jinja-functions/env_var).

## Связанные документы

* [О `profiles.yml`](/docs/core/connect-data-platform/profiles.yml), чтобы узнать больше о конфигурации профиля.