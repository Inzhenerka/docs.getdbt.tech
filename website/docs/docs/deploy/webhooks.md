---
title: "Вебхуки для ваших заданий" 
sidebar_label: "Вебхуки"
description: "Получайте уведомления в реальном времени о ваших заданиях dbt с помощью вебхуков."
---

С помощью dbt Cloud вы можете создавать исходящие вебхуки для отправки событий (уведомлений) о ваших заданиях dbt в другие системы. Ваши другие системы могут подписываться на эти события, чтобы дополнительно автоматизировать ваши рабочие процессы или помочь запустить автоматизированные потоки, которые вы настроили.

Вебхук — это функция обратного вызова на основе HTTP, которая позволяет осуществлять событийно-ориентированную связь между двумя различными веб-приложениями. Это позволяет вам получать актуальную информацию о ваших заданиях dbt в реальном времени. Без этого вам пришлось бы многократно выполнять API-запросы, чтобы проверить, есть ли обновления, которые вам нужно учесть (опрос). Из-за этого вебхуки также называют _push API_ или _reverse API_ и часто используют для разработки инфраструктуры.

dbt Cloud отправляет JSON-данные на URL-адрес конечной точки вашего приложения, когда ваш вебхук срабатывает. Вы можете отправить уведомление в [Slack](/guides/zapier-slack), уведомление в [Microsoft Teams](/guides/zapier-ms-teams), [открыть инцидент в PagerDuty](/guides/serverless-pagerduty), когда задание dbt завершилось с ошибкой.

Вы можете создать вебхуки для этих событий через [веб-интерфейс dbt Cloud](#create-a-webhook-subscription) и с помощью [API dbt Cloud](#api-for-webhooks):

- `job.run.started` &mdash; Запуск начат.
- `job.run.completed` &mdash; Запуск завершен. Это может быть запуск, который завершился с ошибкой или успешно.
- `job.run.errored` &mdash; Ошибка при выполнении.

dbt Cloud повторно пытается отправить каждое событие пять раз. dbt Cloud ведет журнал каждой доставки вебхука в течение 30 дней. У каждого вебхука есть свой раздел **Недавние доставки**, который наглядно показывает, была ли доставка успешной или неудачной.

Вебхук в dbt Cloud имеет тайм-аут в 10 секунд. Это означает, что если конечная точка не отвечает в течение 10 секунд, обработчик вебхуков завершит работу. Это может привести к ситуации, когда клиент успешно отвечает после 10-секундного тайм-аута и фиксирует статус успеха, в то время как система вебхуков dbt Cloud интерпретирует это как сбой.

:::tip Видео 
Если вас интересует обучение с помощью видео, ознакомьтесь с [онлайн-курсом по вебхукам](https://learn.getdbt.com/courses/webhooks) от dbt Labs.

Вы также можете ознакомиться с бесплатным [курсом по основам dbt](https://learn.getdbt.com/courses/dbt-fundamentals). 
:::

## Предварительные условия
- У вас есть учетная запись dbt Cloud, которая находится на [плане Team или Enterprise](https://www.getdbt.com/pricing/). 
- Для доступа `write` к вебхукам: 
    - **Учетные записи на плане Enterprise** &mdash; Наборы разрешений одинаковы как для токенов API, так и для интерфейса dbt Cloud. Вы или токен API должны иметь набор разрешений Account Admin, Admin или Developer [permission set](/docs/cloud/manage-access/enterprise-permissions).  
    - **Учетные записи на плане Team** &mdash; Для интерфейса dbt Cloud вам необходимо иметь [лицензию разработчика](/docs/cloud/manage-access/self-service-permissions). Для токенов API вы должны назначить токену сервисного аккаунта набор разрешений [Account Admin или Member](/docs/dbt-cloud-apis/service-tokens#team-plans-using-service-account-tokens). 
- У вас есть многоарендная или одноарендная модель развертывания AWS в dbt Cloud. Для получения дополнительной информации смотрите [Tenancy](/docs/cloud/about-cloud/tenancy).
- Ваша целевая система поддерживает [заголовки авторизации](#troubleshooting).

## Создание подписки на вебхук {#create-a-webhook-subscription}

Перейдите в **Настройки учетной записи** в dbt Cloud (нажав на имя вашей учетной записи в левой боковой панели) и нажмите **Создать новый вебхук** в разделе **Вебхуки**. Вы можете найти соответствующий URL-адрес доступа dbt Cloud для вашего региона и плана в [Регионов и IP-адресов](/docs/cloud/about-cloud/access-regions-ip-addresses).

Чтобы настроить ваш новый вебхук: 

- **Имя** &mdash; Введите имя для вашего исходящего вебхука.
- **Описание** &mdash; Введите описание вебхука.
- **События** &mdash; Выберите событие, которое вы хотите использовать для активации этого вебхука. Вы можете подписаться на более чем одно событие.
- **Задания** &mdash; Укажите задание(я), на которые вы хотите, чтобы вебхук срабатывал. Или вы можете оставить это поле пустым, чтобы вебхук срабатывал для всех заданий в вашей учетной записи. По умолчанию dbt Cloud настраивает ваш вебхук на уровне учетной записи. 
- **Конечная точка** &mdash; Введите URL-адрес конечной точки вашего приложения, куда dbt Cloud может отправлять событие(я).

Когда закончите, нажмите **Сохранить**. dbt Cloud предоставляет секретный токен, который вы можете использовать для [проверки подлинности вебхука](#validate-a-webhook). Настоятельно рекомендуется выполнять эту проверку на вашем сервере, чтобы защитить себя от поддельных (спуфированных) запросов.

### Различия между завершенными и ошибочными событиями вебхука {#completed-errored-event-difference}
Событие `job.run.errored` является подмножеством событий `job.run.completed`. Если вы подписываетесь на оба, вы получите два уведомления, когда ваше задание столкнется с ошибкой. Однако dbt Cloud вызывает два события в разное время:

- `job.run.completed` &mdash; Это событие срабатывает только после того, как метаданные и артефакты задания были обработаны и доступны из API администрирования и Discovery dbt Cloud. 
- `job.run.errored` &mdash; Это событие срабатывает немедленно, поэтому метаданные и артефакты задания могут еще не быть обработаны. Это означает, что информация может быть недоступна для вас.

Если ваша интеграция зависит от данных из API администрирования (например, доступ к журналам выполнения) или API Discovery (доступ к статусам по моделям), используйте событие `job.run.completed` и фильтруйте по `runStatus` или `runStatusCode`. 

Если ваша интеграция не зависит от дополнительных данных или если для вас более важна производительность доставки, используйте `job.run.errored` и создайте свою интеграцию так, чтобы обрабатывать API-запросы, которые могут не возвращать данные в течение короткого времени в начале. 

## Проверка вебхука

Вы можете использовать секретный токен, предоставленный dbt Cloud, чтобы проверить, что вебхуки, полученные вашей конечной точкой, действительно были отправлены dbt Cloud. Официальные вебхуки будут включать заголовок `Authorization`, который содержит SHA256-хэш тела запроса и использует секретный токен в качестве ключа. 

Пример проверки подлинности вебхука на Python:

```python
auth_header = request.headers.get('authorization', None)
app_secret = os.environ['MY_DBT_CLOUD_AUTH_TOKEN'].encode('utf-8')
signature = hmac.new(app_secret, request_body, hashlib.sha256).hexdigest()
return signature == auth_header
```

Обратите внимание, что целевая система должна поддерживать [заголовки авторизации](#troubleshooting), чтобы вебхук работал корректно. Вы можете протестировать поддержку вашей конечной точки, отправив запрос с помощью curl и заголовка авторизации, как показано ниже:

```shell
curl -H 'Authorization: 123' -X POST https://<your-webhook-endpoint>
```

## Проверка HTTP-запросов 
При работе с вебхуками полезно использовать такие инструменты, как [RequestBin](https://requestbin.com/) и [Requestly](https://requestly.io/). Эти инструменты позволяют вам проверять ваши HTML-запросы, полезные нагрузки ответов и заголовки ответов, чтобы вы могли отлаживать и тестировать вебхуки перед их интеграцией в ваши системы. 

## Примеры JSON-данных

Пример полезной нагрузки вебхука для запущенного задания:

```json
{
  "accountId": 1,
  "webhooksID": "wsu_12345abcde",
  "eventId": "wev_2L6Z3l8uPedXKPq9D2nWbPIip7Z",
  "timestamp": "2023-01-31T19:28:15.742843678Z",
  "eventType": "job.run.started",
  "webhookName": "test",
  "data": {
    "jobId": "123",
    "jobName": "Daily Job (dbt build)",
    "runId": "12345",
    "environmentId": "1234",
    "environmentName": "Production",
    "dbtVersion": "1.0.0",
    "projectName": "Snowflake Github Demo",
    "projectId": "167194",
    "runStatus": "Running",
    "runStatusCode": 3,
    "runStatusMessage": "None",
    "runReason": "Kicked off from UI by test@test.com",
    "runStartedAt": "2023-01-31T19:28:07Z"
  }
}
```

Пример полезной нагрузки вебхука для завершенного задания:

```json
{
  "accountId": 1,
  "webhooksID": "wsu_12345abcde",
  "eventId": "wev_2L6ZDoilyiWzKkSA59Gmc2d7FDD",
  "timestamp": "2023-01-31T19:29:35.789265936Z",
  "eventType": "job.run.completed",
  "webhookName": "test",
  "data": {
    "jobId": "123",
    "jobName": "Daily Job (dbt build)",
    "runId": "12345",
    "environmentId": "1234",
    "environmentName": "Production",
    "dbtVersion": "1.0.0",
    "projectName": "Snowflake Github Demo",
    "projectId": "167194",
    "runStatus": "Success",
    "runStatusCode": 10,
    "runStatusMessage": "None",
    "runReason": "Kicked off from UI by test@test.com",
    "runStartedAt": "2023-01-31T19:28:07Z",
    "runFinishedAt": "2023-01-31T19:29:32Z"
  }
}
```

Пример полезной нагрузки вебхука для задания с ошибкой: 

```json
{
  "accountId": 1,
  "webhooksID": "wsu_12345abcde",
  "eventId": "wev_2L6m5BggBw9uPNuSmtg4MUiW4Re",
  "timestamp": "2023-01-31T21:15:20.419714619Z",
  "eventType": "job.run.errored",
  "webhookName": "test",
  "data": {
    "jobId": "123",
    "jobName": "dbt Vault",
    "runId": "12345",
    "environmentId": "1234",
    "environmentName": "dbt Vault Demo",
    "dbtVersion": "1.0.0",
    "projectName": "Snowflake Github Demo",
    "projectId": "167194",
    "runStatus": "Errored",
    "runStatusCode": 20,
    "runStatusMessage": "None",
    "runReason": "Kicked off from UI by test@test.com",
    "runStartedAt": "2023-01-31T21:14:41Z",
    "runErroredAt": "2023-01-31T21:15:20Z"
  }
}
```

## API для вебхуков {#api-for-webhooks}
Вы можете использовать API dbt Cloud для создания новых вебхуков, на которые вы хотите подписаться, получения подробной информации о ваших вебхуках и управления вебхуками, связанными с вашей учетной записью. В следующих разделах описаны конечные точки API, которые вы можете использовать для этого. 

:::info URL-адреса доступа
dbt Cloud размещается в нескольких регионах мира, и у каждого региона есть свой URL-адрес доступа. Люди на планах Enterprise могут выбрать размещение своей учетной записи в любом из этих регионов. Для получения полного списка доступных URL-адресов доступа dbt Cloud смотрите [Регионов и IP-адресов](/docs/cloud/about-cloud/access-regions-ip-addresses).   
:::

### Список всех подписок на вебхуки
Список всех вебхуков, доступных из конкретной учетной записи dbt Cloud.

#### Запрос 
```shell
GET https://{your access URL}/api/v3/accounts/{account_id}/webhooks/subscriptions
```

#### Параметры пути
| Имя       | Описание                          |
|------------|--------------------------------------|
| `your access URL` | URL для входа в вашу учетную запись dbt Cloud. |
| `account_id` | Учетная запись dbt Cloud, с которой связаны вебхуки. |

#### Пример ответа
```json
{
    "data": [
        {
            "id": "wsu_12345abcde",
            "account_identifier": "act_12345abcde",
            "name": "Webhook for jobs",
            "description": "A webhook for when jobs are started",
            "job_ids": [
                "123",
                "321"
            ],
            "event_types": [
                "job.run.started"
            ],
            "client_url": "https://test.com",
            "active": true,
            "created_at": "1675735768491774",
            "updated_at": "1675787482826757",
            "account_id": "123",
            "http_status_code": "0"
        },
        {
            "id": "wsu_12345abcde",
            "account_identifier": "act_12345abcde",
            "name": "Notication Webhook",
            "description": "Webhook used to trigger notifications in Slack",
            "job_ids": [],
            "event_types": [
                "job.run.completed",
                "job.run.started",
                "job.run.errored"
            ],
            "client_url": "https://test.com",
            "active": true,
            "created_at": "1674645300282836",
            "updated_at": "1675786085557224",
            "http_status_code": "410",
            "dispatched_at": "1675786085548538",
            "account_id": "123"
        }
    ],
    "status": {
        "code": 200
    },
    "extra": {
        "pagination": {
            "total_count": 2,
            "count": 2
        },
        "filters": {
            "offset": 0,
            "limit": 10
        }
    }
}
```

#### Схема ответа 
| Имя | Описание | Возможные значения |
| --- | --- | --- |
| `data` | Список доступных вебхуков для указанного идентификатора учетной записи dbt Cloud. |  |
| `id` | Идентификатор вебхука. Это универсальный уникальный идентификатор (UUID), который уникален для всех регионов, включая многоарендные и одноарендные. |  |
| `account_identifier` | Уникальный идентификатор для _вашей_ учетной записи dbt Cloud. |  |
| `name` | Имя исходящего вебхука. |  |
| `description` | Описание вебхука. |  |
| `job_ids` | Конкретные задания, для которых вебхук настроен на срабатывание. Когда список пуст, вебхук настроен на срабатывание для всех заданий в вашей учетной записи; по умолчанию dbt Cloud настраивает вебхуки на уровне учетной записи. | <ul><li>Пустой список</li> <li>Список идентификаторов заданий</li></ul> |
| `event_types` | Тип(ы) события, на которое вебхук настроен на срабатывание. | Один или несколько из следующих: <ul><li>`job.run.started`</li> <li>`job.run.completed`</li><li>`job.run.errored`</li></ul> |
| `client_url` | URL-адрес конечной точки для приложения, куда dbt Cloud может отправлять событие(я). |  |
| `active` | Логическое значение, указывающее, активен ли вебхук или нет. | Одно из следующих: <ul><li>`true`</li><li>`false`</li></ul> |
| `created_at` | Временная метка, когда вебхук был создан. |  |
| `updated_at` | Временная метка, когда вебхук был последний раз обновлен. |  |
| `http_status_code` | Последний HTTP-статус вебхука. | Может быть любым [HTTP-кодом ответа](https://developer.mozilla.org/en-US/docs/Web/HTTP/Status). Если значение равно `0`, это означает, что вебхук никогда не срабатывал. |
| `dispatched_at` | Временная метка, когда вебхук последний раз был отправлен на указанный URL-адрес конечной точки. |  |
| `account_id` | Идентификатор учетной записи dbt Cloud. |  |

### Получить информацию о вебхуке
Получите подробную информацию о конкретном вебхуке. 

#### Запрос
```shell
GET https://{your access URL}/api/v3/accounts/{account_id}/webhooks/subscription/{webhook_id}
```
#### Параметры пути
| Имя       | Описание                          |
|------------|--------------------------------------|
| `your access URL` | URL для входа в вашу учетную запись dbt Cloud. |
| `account_id` | Учетная запись dbt Cloud, с которой связан вебхук. |
| `webhook_id` | Вебхук, о котором вы хотите получить подробную информацию. |

#### Пример ответа
```json
{
    "data": {
        "id": "wsu_12345abcde",
        "account_identifier": "act_12345abcde",
        "name": "Webhook for jobs",
        "description": "A webhook for when jobs are started",
        "event_types": [
            "job.run.started"
        ],
        "client_url": "https://test.com",
        "active": true,
        "created_at": "1675789619690830",
        "updated_at": "1675793192536729",
        "dispatched_at": "1675793192533160",
        "account_id": "123",
        "job_ids": [],
        "http_status_code": "0"
    },
    "status": {
        "code": 200
    }
}
```

#### Схема ответа
| Имя | Описание | Возможные значения |
| --- | --- | --- |
| `id` | Идентификатор вебхука. |  |
| `account_identifier` | Уникальный идентификатор для _вашей_ учетной записи dbt Cloud. |  |
| `name` | Имя исходящего вебхука. |  |
| `description` | Полное описание вебхука. |  |
| `event_types` | Тип события, на которое вебхук настроен на срабатывание. | Один или несколько из следующих: <ul><li>`job.run.started`</li> <li>`job.run.completed`</li><li>`job.run.errored`</li></ul> |
| `client_url` | URL-адрес конечной точки для приложения, куда dbt Cloud может отправлять событие(я). |  |
| `active` | Логическое значение, указывающее, активен ли вебхук или нет. | Одно из следующих: <ul><li>`true`</li><li>`false`</li></ul> |
| `created_at` | Временная метка, когда вебхук был создан. |  |
| `updated_at` | Временная метка, когда вебхук был последний раз обновлен. |  |
| `dispatched_at` | Временная метка, когда вебхук последний раз был отправлен на указанный URL-адрес конечной точки. |  |
| `account_id` | Идентификатор учетной записи dbt Cloud. |  |
| `job_ids` | Конкретные задания, для которых вебхук настроен на срабатывание. Когда список пуст, вебхук настроен на срабатывание для всех заданий в вашей учетной записи; по умолчанию dbt Cloud настраивает вебхуки на уровне учетной записи. | Одно из следующих: <ul><li>Пустой список</li> <li>Список идентификаторов заданий</li></ul> |
| `http_status_code` | Последний HTTP-статус вебхука. | Может быть любым [HTTP-кодом ответа](https://developer.mozilla.org/en-US/docs/Web/HTTP/Status). Если значение равно `0`, это означает, что вебхук никогда не срабатывал. |

### Создание новой подписки на вебхук
Создайте новый исходящий вебхук и укажите URL-адрес конечной точки, который будет подписываться (слушать) события вебхука.

#### Пример запроса

```shell
POST https://{your access URL}/api/v3/accounts/{account_id}/webhooks/subscriptions
```

```json
{
	"event_types": [
			"job.run.started"
	],
	"name": "Webhook for jobs",
	"client_url": "https://test.com",
	"active": true,
	"description": "A webhook for when jobs are started",
	"job_ids": [
			123,
			321
	]
}
```

#### Параметры пути
| Имя | Описание |
| --- | --- |
| `your access URL` | URL для входа в вашу учетную запись dbt Cloud. |
| `account_id` | Учетная запись dbt Cloud, с которой связан вебхук. |

#### Параметры запроса
| Имя | Описание | Возможные значения |
| --- | --- | --- |
| `event_types` | Укажите событие, которое вы хотите использовать для активации этого вебхука. Вы можете подписаться на более чем одно событие. | Один или несколько из следующих: <ul><li>`job.run.started`</li> <li>`job.run.completed`</li><li>`job.run.errored`</li></ul> |
| `name` | Укажите имя вашего вебхука. |  |
| `client_url` | Укажите URL-адрес конечной точки вашего приложения, куда dbt Cloud может отправлять событие(я).|  |
| `active` | Укажите логическое значение, чтобы указать, активен ли ваш вебхук или нет. | Одно из следующих: <ul><li>`true`</li><li>`false`</li></ul> |
| `description` | Укажите описание вашего вебхука. |  |
| `job_ids` | Укажите конкретные задания, на которые вы хотите, чтобы вебхук срабатывал, или вы можете оставить этот параметр пустым. Если это пустой список, вебхук настроен на срабатывание для всех заданий в вашей учетной записи; по умолчанию dbt Cloud настраивает вебхуки на уровне учетной записи. | Одно из следующих: <ul><li>Пустой список</li> <li>Список идентификаторов заданий</li></ul> |

#### Пример ответа
```json
{
    "data": {
        "id": "wsu_12345abcde",
        "account_identifier": "act_12345abcde",
        "name": "Webhook for jobs",
        "description": "A webhook for when jobs are started",
        "job_ids": [
            "123",
						"321"
        ],
        "event_types": [
            "job.run.started"
        ],
        "client_url": "https://test.com",
        "hmac_secret": "12345abcde",
        "active": true,
        "created_at": "1675795644808877",
        "updated_at": "1675795644808877",
        "account_id": "123",
        "http_status_code": "0"
    },
    "status": {
        "code": 201
    }
}
```

#### Схема ответа
| Имя | Описание | Возможные значения |
| --- | --- | --- |
| `id` | Идентификатор вебхука. |  |
| `account_identifier` | Уникальный идентификатор для _вашей_ учетной записи dbt Cloud. |  |
| `name` | Имя исходящего вебхука. |  |
| `description` | Полное описание вебхука. |  |
| `job_ids` | Конкретные задания, для которых вебхук настроен на срабатывание. Когда список пуст, вебхук настроен на срабатывание для всех заданий в вашей учетной записи; по умолчанию dbt Cloud настраивает вебхуки на уровне учетной записи. | Одно из следующих: <ul><li>Пустой список</li> <li>Список идентификаторов заданий</li></ul> |
| `event_types` | Тип события, на которое вебхук настроен на срабатывание. | Один или несколько из следующих: <ul><li>`job.run.started`</li> <li>`job.run.completed`</li><li>`job.run.errored`</li></ul> |
| `client_url` | URL-адрес конечной точки для приложения, куда dbt Cloud может отправлять событие(я). |  |
| `hmac_secret` | Секретный ключ для вашего нового вебхука. Вы можете использовать этот ключ для [проверки подлинности этого вебхука](#validate-a-webhook). |  |
| `active` | Логическое значение, указывающее, активен ли вебхук или нет. | Одно из следующих: <ul><li>`true`</li><li>`false`</li></ul> |
| `created_at` | Временная метка, когда вебхук был создан. |  |
| `updated_at` | Временная метка, когда вебхук был последний раз обновлен. |  |
| `account_id` | Идентификатор учетной записи dbt Cloud. |  |
| `http_status_code` | Последний HTTP-статус вебхука. | Может быть любым [HTTP-кодом ответа](https://developer.mozilla.org/en-US/docs/Web/HTTP/Status). Если значение равно `0`, это означает, что вебхук никогда не срабатывал. |

### Обновление вебхука
Обновите параметры конфигурации для конкретного вебхука. 

#### Пример запроса
```shell
PUT https://{your access URL}/api/v3/accounts/{account_id}/webhooks/subscription/{webhook_id}
```

```json
{
	"event_types": [
			"job.run.started"
	],
	"name": "Webhook for jobs",
	"client_url": "https://test.com",
	"active": true,
	"description": "A webhook for when jobs are started",
	"job_ids": [
			123,
			321
	]
}
```

#### Параметры пути
| Имя       | Описание                          |
|------------|--------------------------------------|
| `your access URL` | URL для входа в вашу учетную запись dbt Cloud. |
| `account_id` | Учетная запись dbt Cloud, с которой связан вебхук. |
| `webhook_id` | Вебхук, который вы хотите обновить. |

#### Параметры запроса
| Имя | Описание | Возможные значения |
|------|-------------|-----------------|
| `event_types` | Обновите тип события, на которое вебхук настроен на срабатывание. Вы можете подписаться на более чем одно. | Один или несколько из следующих: <ul><li>`job.run.started`</li> <li>`job.run.completed`</li><li>`job.run.errored`</li></ul> |
| `name` | Измените имя вашего вебхука. |  |
| `client_url` | Обновите URL-адрес конечной точки для приложения, куда dbt Cloud может отправлять событие(я). |  |
| `active` | Измените логическое значение, указывающее, активен ли вебхук или нет. | Одно из следующих: <ul><li>`true`</li><li>`false`</li></ul> |
| `description` | Обновите описание вебхука. |  |
| `job_ids` | Измените, для каких заданий вы хотите, чтобы вебхук срабатывал. Или вы можете использовать пустой список, чтобы срабатывать для всех заданий в вашей учетной записи. | Одно из следующих: <ul><li>Пустой список</li> <li>Список идентификаторов заданий</li></ul> |

#### Пример ответа
```json
{
    "data": {
        "id": "wsu_12345abcde",
        "account_identifier": "act_12345abcde",
        "name": "Webhook for jobs",
        "description": "A webhook for when jobs are started",
        "job_ids": [
            "123"
        ],
        "event_types": [
            "job.run.started"
        ],
        "client_url": "https://test.com",
        "active": true,
        "created_at": "1675798888416144",
        "updated_at": "1675804719037018",
        "http_status_code": "200",
        "account_id": "123"
    },
    "status": {
        "code": 200
    }
}
```

#### Схема ответа
| Имя | Описание | Возможные значения |
| --- | --- | --- |
| `id` | Идентификатор вебхука. |  |
| `account_identifier` | Уникальный идентификатор для _вашей_ учетной записи dbt Cloud. |  |
| `name` | Имя исходящего вебхука. |  |
| `description` | Полное описание вебхука. |  |
| `job_ids` | Конкретные задания, для которых вебхук настроен на срабатывание. Когда список пуст, вебхук настроен на срабатывание для всех заданий в вашей учетной записи; по умолчанию dbt Cloud настраивает вебхуки на уровне учетной записи. | Одно из следующих: <ul><li>Пустой список</li> <li>Список идентификаторов заданий</li></ul> |
| `event_types` | Тип события, на которое вебхук настроен на срабатывание. | Один или несколько из следующих: <ul><li>`job.run.started`</li> <li>`job.run.completed`</li><li>`job.run.errored`</li></ul> |
| `client_url` | URL-адрес конечной точки для приложения, куда dbt Cloud может отправлять событие(я). |  |
| `active` | Логическое значение, указывающее, активен ли вебхук или нет. | Одно из следующих: <ul><li>`true`</li><li>`false`</li></ul> |
| `created_at` | Временная метка, когда вебхук был создан. |  |
| `updated_at` | Временная метка, когда вебхук был последний раз обновлен. |  |
| `http_status_code` | Последний HTTP-статус вебхука. | Может быть любым [HTTP-кодом ответа](https://developer.mozilla.org/en-US/docs/Web/HTTP/Status). Если значение равно `0`, это означает, что вебхук никогда не срабатывал. |
| `account_id` | Идентификатор учетной записи dbt Cloud. |  |

### Тестирование вебхука
Тестируйте конкретный вебхук. 

#### Запрос
```shell
GET https://{your access URL}/api/v3/accounts/{account_id}/webhooks/subscription/{webhook_id}/test
```

#### Параметры пути
| Имя       | Описание                          |
|------------|--------------------------------------|
| `your access URL` | URL для входа в вашу учетную запись dbt Cloud. |
| `account_id` | Учетная запись dbt Cloud, с которой связан вебхук. |
| `webhook_id` | Вебхук, который вы хотите протестировать.  |

#### Пример ответа
```json
{
    "data": {
        "verification_error": null,
        "verification_status_code": "200"
    },
    "status": {
        "code": 200
    }
}
```

### Удаление вебхука
Удалите конкретный вебхук. 

#### Запрос
```shell
DELETE https://{your access URL}/api/v3/accounts/{account_id}/webhooks/subscription/{webhook_id}
```

#### Параметры пути
| Имя       | Описание                          |
|------------|--------------------------------------|
| `your access URL` | URL для входа в вашу учетную запись dbt Cloud. |
| `account_id` | Учетная запись dbt Cloud, с которой связан вебхук. |
| `webhook_id` | Вебхук, который вы хотите удалить. |

#### Пример ответа

```json
{
    "data": {
        "id": "wsu_12345abcde"
    },
    "status": {
        "code": 200,
        "is_success": true
    }
}
```

## Связанные документы 
- [dbt Cloud CI](/docs/deploy/continuous-integration)
- [Используйте вебхуки dbt Cloud с другими SaaS-приложениями](https://docs.getdbt.com/guides?tags=Webhooks)

## Устранение неполадок

Если ваша целевая система не получает вебхуки dbt Cloud, убедитесь, что она позволяет заголовки авторизации. Вебхуки dbt Cloud отправляют заголовок авторизации, и если ваша конечная точка не поддерживает это, она может быть несовместима. Такие сервисы, как Azure Logic Apps и Power Automate, могут не принимать заголовки авторизации, поэтому они не будут работать с вебхуками dbt Cloud. Вы можете протестировать поддержку вашей конечной точки, отправив запрос с помощью curl и заголовка авторизации, как показано ниже:

```shell
curl -H 'Authorization: 123' -X POST https://<your-webhook-endpoint>
```