---
title: "Биллинг"
id: billing 
description: "Информация о биллинге dbt." 
sidebar_label: Биллинг
pagination_next: null
pagination_prev: null
---

<Constant name="cloud" /> предлагает широкий выбор [планов и цен](https://www.getdbt.com/pricing/), которые подойдут для организаций любого масштаба. Гибкие варианты биллинга, одинаково удобные как для крупных компаний, так и для малого бизнеса, а также [доступность серверов](/docs/cloud/about-cloud/access-regions-ip-addresses) по всему миру делают <Constant name="dbt_platform" /> самым быстрым и простым способом начать трансформацию данных.

## Как работает ценообразование dbt?

Как клиент, вы платите за количество лицензий (seats) и объём использования (usage), потреблённый за каждый месяц. Лицензии в первую очередь тарифицируются на основе количества приобретённых лицензий Developer и Read. 

Использование рассчитывается на основе количества [Успешно построенных моделей](#что-считается-успешно-построенной-моделью) и, при покупке и использовании, количества <Constant name="semantic_layer" /> [Запрошенных метрик](#что-считается-запрошенной-метрикой), с учётом разумного использования. Все расчёты биллинга выполняются в координированном всемирном времени (UTC).

### Что считается лицензией (seat)?
Подробнее о назначении пользователей в аккаунте можно узнать в разделе [Users and licenses](/docs/cloud/manage-access/seats-and-users).
Существует четыре типа лицензий:
* **Analyst** — для наборов прав доступа, которые назначаются и используются совместно теми, кому не нужен ежедневный доступ. Требует покупки лицензии Developer.
* **Developer** — для наборов прав доступа, предполагающих ежедневную работу с <Constant name="dbt_platform" />.
* **IT** — для доступа к отдельным функциям управления аккаунтом (например, настройка интеграции с git).
* **Read-Only** — для доступа только к просмотру определённых документов и отчётов.

### Что считается успешно построенной моделью?

<Constant name="cloud" /> считает успешно построенной моделью любой <Term id="model">model</Term>, которая была успешно построена в рамках запуска через функциональность оркестрации <Constant name="cloud" /> в среде деплоя <Constant name="cloud" />. Модели учитываются в момент их сборки и выполнения. Это включает задания, запущенные через планировщик <Constant name="cloud" />, CI-сборки (задания, инициированные pull request’ами), запуски через API <Constant name="cloud" />, а также любые последующие инструменты <Constant name="cloud" /> с аналогичной функциональностью. Также учитываются модели, которые были успешно построены, даже если сам запуск в итоге завершился ошибкой. Например, если задание содержит 100 моделей, и при одном из запусков 51 модель была успешно построена, после чего задание завершилось с ошибкой, будет засчитано только 51 модель.

Любые модели, построенные в среде разработки <Constant name="cloud" /> (например, через <Constant name="cloud_ide" />), не учитываются в использовании. Тесты, seeds, ephemeral-модели и snapshots также не учитываются.

При первоначальном создании динамической таблицы модель учитывается (если создание прошло успешно). Однако при последующих запусках dbt пропускает такие модели, если определение динамической таблицы не изменилось. Речь идёт не об изменениях SQL-логики, а об изменениях логики dbt, в частности тех, которые управляются параметром [`on_configuration_change config`](/reference/resource-configs/on_configuration_change)). Динамическая таблица продолжает обновляться по расписанию, так как этим обновлением управляет адаптер, а не <Constant name="cloud" />. 

| Что учитывается как успешно построенная модель |                     |
|-----------------------------------------------|---------------------|
| View                                          | ✅                  |
| Table                                         | ✅                  |
| Incremental                                   | ✅                  |
| Ephemeral Models                              | ❌                  |
| Tests                                         | ❌                  |
| Seeds                                         | ❌                  |
| Snapshots                                     | ❌                  |

### Что считается запрошенной метрикой?

<Constant name="semantic_layer" />, работающий на базе MetricFlow, измеряет использование в виде отдельных Запрошенных метрик (Queried Metrics).

- Каждый успешный запрос на генерацию или выполнение SQL через API <Constant name="semantic_layer" /> считается как минимум одной запрошенной метрикой, даже если данные не были возвращены.
- Если запрос рассчитывает или генерирует SQL сразу для нескольких метрик, каждая рассчитанная метрика учитывается как отдельная запрошенная метрика.
- Если запрос на выполнение не был успешно выполнен в платформе данных или завершился ошибкой без выполнения, он не учитывается как запрошенная метрика.
- Запросы метаданных из <Constant name="semantic_layer" /> также не учитываются как запрошенные метрики.

Примеры запрошенных метрик:

- Запрос одной метрики с группировкой по одному измерению → 1 запрошенная метрика 

  ```shell
  dbt sl query --metrics revenue --group-by metric_time
  ```

- Запрос одной метрики с группировкой по двум измерениям → 1 запрошенная метрика 

  ```shell
  dbt sl query --metrics revenue --group-by metric_time,user__country
  ```

- Запрос двух метрик с группировкой по двум измерениям → 2 запрошенные метрики 

  ```shell
  dbt sl query --metrics revenue,gross_sales --group-by metric_time,user__country
  ```

- Компиляция для одной метрики → 1 запрошенная метрика

  ```shell
  dbt sl query --metrics revenue --group-by metric_time --compile
  ```

- Компиляция для двух метрик → 2 запрошенные метрики

  ```shell
  dbt sl query --metrics revenue,gross_sales --group-by metric_time --compile
  ```

### Просмотр использования в продукте 

Просмотр данных об использовании в продукте доступен только для определённых ролей:

* План Starter — группа Owner
* Планы Enterprise и Enterprise+ — роли администратора аккаунта и администратора биллинга

Для просмотра использования на уровне аккаунта, если у вас есть доступ к страницам **Billing** и **Usage**, вы можете увидеть оценку использования за текущий месяц. На странице Billing в разделе **Account Settings** отображается, как текущее использование соотносится с лимитами аккаунта. Также можно увидеть, какие проекты строят наибольшее количество моделей.

<Lightbox src="/img/docs/building-a-dbt-project/billing-usage-page.jpg" width="80%" title="Чтобы посмотреть оценку использования на уровне аккаунта, перейдите в 'Account settings' и выберите 'Billing'."/>

Пользователи планов Starter и Developer могут видеть, как аккаунт использует включённые в план модели. Пользователи плана Enterprise могут видеть, какая часть годового обязательства уже использована и сколько осталось.

На странице **Project Home** любого проекта любой пользователь с доступом к проекту может увидеть, сколько моделей строится каждый месяц. Дополнительные детали по заданиям с наибольшим количеством построенных моделей доступны на странице каждой **Environment**.

<Lightbox src="/img/docs/building-a-dbt-project/billing-project-page.jpg" width="80%" title="На главной странице проекта отображается количество моделей, построенных каждый месяц."/>

Кроме того, на странице **Job Details** во вкладке **Insights** можно посмотреть, сколько моделей строится в месяц для конкретного задания и какие модели собираются дольше всего. 

<Lightbox src="/img/docs/building-a-dbt-project/billing-job-page.jpg" width="80%" title="Посмотрите, сколько моделей строится в месяц для конкретного задания, перейдя на вкладку 'Insights' на странице 'Job details'."/>

Информация об использовании доступна клиентам с планами на основе потребления, и некоторые визуализации могут быть недоступны для клиентов на устаревших планах. Любые данные об использовании, отображаемые в <Constant name="cloud" />, являются оценочными, и возможна задержка в их отображении. Окончательные данные за месяц будут указаны в вашем ежемесячном счёте (счета применимы для планов Starter и Enterprise).

## dbt Copilot: учёт и ограничения использования <Lifecycle status="Starter, Enterprise, Enterprise+" />

Использование <Constant name="copilot" /> измеряется на основе количества завершённых AI-запросов, называемых действиями <Constant name="copilot" />. Ограничения использования применяются для обеспечения справедливого доступа и стабильной работы системы.

Определённое количество вызовов <Constant name="copilot" /> выделяется ежемесячно в зависимости от вашего [подписочного плана](https://www.getdbt.com/pricing). После достижения лимита доступ к функциональности Copilot временно отключается до начала следующего биллингового периода.

### Информация об использовании и учёте

<Expandable alt_header="Отслеживание использования ИИ по действиям Copilot">

Действия <Constant name="copilot" /> — это запросы, отправляемые ассистенту <Constant name="copilot" /> через интерфейс <Constant name="cloud" />. Эти действия фиксируются и отображаются на странице биллинга наряду с другими метриками использования.

Следующие взаимодействия считаются действиями <Constant name="copilot" />:

- **Каждая inline-генерация** — каждый раз, когда <Constant name="copilot" /> пишет или предлагает код в файле, это засчитывается в лимит использования.
- **Каждая генерация документации, тестов, семантических моделей или метрик** — любой запрос к <Constant name="copilot" /> на автоматическое создание документации, тестов, моделей данных или метрик считается одним взаимодействием.
- **Каждая генерация в чатах <Constant name="copilot" /> в <Constant name="visual_editor" /> или <Constant name="query_page" />** — любое использование чата <Constant name="copilot" /> для генерации считается отдельным взаимодействием.

</Expandable>

<Expandable alt_header="Допустимые лимиты количества действий Copilot в месяц на одну лицензию">

В следующей таблице указаны лимиты действий <Constant name="copilot" /> по планам за месяц:

|Plan                       |Limit |
|---------------------------|------|
|Developer                  | ❌   |
|Starter*                   |500   |
|Enterprise                 |5,000 |
|Enterpise+                 |10,000|

*Клиенты плана Team, подключившиеся к бета-версии <Constant name="copilot" /> до 19 марта 2025 года, имеют доступ к <Constant name="copilot" />. Все остальные клиенты устаревшего плана Team должны перейти на [Starter или выше](https://www.getdbt.com/pricing), чтобы получить доступ.

</Expandable>

<Expandable alt_header="Уведомления при достижении ограничений">

При достижении лимитов использования в интерфейсе появляется уведомление. Дополнительно на указанный адрес отправляется email-уведомление.

Для пользователей плана Starter уведомление по email получает владелец аккаунта.

Для пользователей планов Enterprise и Enterprise+ уведомления по email получают администратор биллинга и администратор аккаунта.

После достижения лимита попытка выполнить действие в <Constant name="copilot" /> приводит к появлению баннера с сообщением о превышении лимита.

При использовании Bring Your Own Key (BYOK) использование не отслеживается <Constant name="copilot" /> и подчиняется ограничениям OpenAI.

</Expandable>

### Просмотр использования в продукте

Чтобы посмотреть использование в вашем аккаунте:

1. Перейдите в [**Account settings**](/docs/cloud/account-settings).
2. Выберите **Billing** в разделе Settings.
3. На странице биллинга нажмите **<Constant name="copilot" />**, чтобы посмотреть использование.

<Lightbox src="/img/docs/dbt-cloud/view-usage-in-copilot.gif" title="Просмотр использования Copilot" />

## Планы и биллинг

<Constant name="cloud" /> предлагает несколько [планов](https://www.getdbt.com/pricing) с различным набором возможностей. Время от времени детали планов могут меняться. Мы всегда заранее уведомляем об изменениях. Ниже описано, как работает биллинг для каждого плана.

### Биллинг плана Developer

План Developer бесплатный и включает одну лицензию Developer и 3 000 моделей в месяц. Лимит моделей обновляется в начале каждого календарного месяца. Если вы превысите 3 000 моделей, все последующие запуски будут отменены до обновления лимита или перехода на платный план. Остальная часть платформы <Constant name="cloud" /> остаётся доступной, и никакая работа не будет потеряна.

Указанные выше значения включённых успешно построенных моделей отражают актуальные условия ценообразования. В зависимости от условий, действовавших на момент регистрации в плане Developer, включённые лимиты могут отличаться.

### Биллинг плана Starter 

Клиенты плана Starter оплачивают лицензии и использование ежемесячно с помощью банковской карты. В аккаунт включено 15 000 моделей в месяц. Лицензии оплачиваются авансом в начале месяца. При добавлении лицензий в течение месяца стоимость рассчитывается пропорционально и списывается в тот же день. Удалённые в течение месяца лицензии будут отражены в следующем счёте и не подлежат возврату. Данные карты и количество лицензий можно изменить в разделе биллинга в любое время. Аккаунт получает один ежемесячный счёт, включающий авансовую оплату лицензий и оплату использования за предыдущий месяц.

Использование рассчитывается и оплачивается постфактум за предыдущий месяц. При превышении 15 000 моделей дополнительное использование будет выставлено в следующем счёте по тарифам с [страницы цен](https://www.getdbt.com/pricing). 

Неиспользованные включённые модели не переносятся на следующий месяц. Оценить счёт можно по формуле:

`($100 x количество лицензий developer) + ((построенные модели - 15 000) x $0.01)`

Указанные лимиты включённых моделей отражают текущие условия. В зависимости от условий при подключении плана Starter лимиты могут отличаться.

### Биллинг плана Enterprise

Клиенты плана Enterprise оплачивают услуги ежегодно по счёту, а дополнительное использование — ежемесячно постфактум (если применимо). Возможны индивидуально согласованные тарифы. Подробности указаны в вашем договоре или заказе, либо вы можете [связаться с командой аккаунта](https://www.getdbt.com/contact-demo).

Информация о биллинге Enterprise недоступна в интерфейсе <Constant name="cloud" />. Все изменения обрабатываются через вашего Solutions Architect или менеджера аккаунта dbt Labs.

### Устаревшие планы

Клиенты, купившие план <Constant name="cloud" /> Starter (ранее Team) до 11 августа 2023 года, остаются на устаревшем тарифе при условии, что аккаунт находится в хорошем состоянии. Устаревший план основан на лицензиях и включает неограниченное количество моделей при разумном использовании.

:::note Устаревший <Constant name="semantic_layer" />

Для клиентов, использующих устаревший <Constant name="semantic_layer" /> с пакетом dbt_metrics, продукт будет выведен из эксплуатации в декабре 2023 года. Пользователи могут в любой момент перейти на обновлённую версию <Constant name="semantic_layer" />, работающую на MetricFlow. Обновлённая версия доступна большинству клиентов (см. [prerequisites](/guides/sl-snowflake-qs#prerequisites)) в рамках бесплатного пробного периода при разумном использовании.

:::

dbt Labs может ввести ограничения при превышении разумного использования. Дополнительные функции, обновления или апгрейды могут оплачиваться отдельно. Любые изменения цен будут заранее сообщены в соответствии с Terms of Use.

## Управление использованием

В <Constant name="cloud" /> нажмите на имя аккаунта в левом меню и выберите **Account settings**. Пункт **Billing** находится в левом меню в разделе **Settings**. Здесь можно посмотреть доступные планы и функции каждого из них.

### Уведомления об использовании 

Каждый план автоматически отправляет email-уведомления при достижении 75%, 90% и 100% оценочного использования.
- План Starter — уведомления получают все пользователи группы Owner.
- Планы Enterprise — уведомления получают пользователи с правами Account Admin и Billing Admin.

Отказаться от этих уведомлений нельзя. Чтобы другие пользователи тоже получали уведомления, назначьте им соответствующие права. Обратите внимание, что фактическое использование может уже превышать указанный в уведомлении процент из‑за особенностей паттернов использования и небольшой задержки обновления данных.

### Как остановить начисление использования?

Существует два способа прекратить построение моделей и начисление платы:

1. Откройте **Job Settings** каждого задания и перейдите в раздел **Triggers**. Отключите **Run on Schedule** и установите **Run on Pull Requests?** для **Continuous Integration** в значение **No**. Убедитесь, что ваши процессы не запускают задания через API <Constant name="cloud" />. Этот вариант позволяет сохранить задания без дальнейшего построения моделей.
2. Альтернативно вы можете удалить часть или все задания <Constant name="cloud" />. Это гарантирует, что запуски не будут выполняться, но задания будут удалены безвозвратно.

## Оптимизация затрат в dbt

<Constant name="cloud" /> предоставляет способы оптимизировать количество построенных моделей и затраты на хранилище данных. 

### Лучшие практики оптимизации успешно построенных моделей

При оптимизации затрат важно снижать количество построенных моделей, не нарушая лучшие практики. Чтобы продолжать использовать тесты и пересобирать представления при изменении логики, рекомендуется применять комбинацию подходящих практик. В частности, если вы исключаете views из регулярных запусков заданий <Constant name="cloud" />, необходимо настроить merge‑задание для деплоя обновлённой логики представлений при обнаружении изменений.

#### Исключение views в задании dbt

Многие пользователи <Constant name="cloud" /> используют views, которые не всегда нужно пересобирать при каждом запуске. Для заданий, содержащих views, которые **не** используют макросы с динамической генерацией кода (например, case‑выражения) и **не** имеют тестов, выполните следующие шаги:

1. Перейдите к вашему production‑заданию деплоя в <Constant name="cloud" />.
2. Измените команду, добавив: `--exclude config.materialized:view`.
3. Сохраните изменения задания.

Если ваши views содержат макросы с case‑выражениями, зависящими от upstream‑таблиц, их необходимо выполнять при каждом запуске. Если при этом нужно запускать тесты для views, следуйте практике [Exclude views while still running tests](#exclude-views-while-running-tests) и создайте кастомный selector. 

#### Исключение views при запуске тестов

Запуск тестов для views при каждом выполнении задания помогает поддерживать качество данных и избегать повторных запусков. Чтобы исключить views из сборки, но продолжать запускать тесты, создайте кастомный [selector](/reference/node-selection/yaml-selectors) следующим образом:

1. Откройте проект dbt в <Constant name="cloud_ide" />.
2. Добавьте файл `selectors.yml` в корень проекта.
3. Добавьте в файл следующий код:

   ```yaml 
    selectors:
      - name: skip_views_but_test_views
        description: >
          A default selector that will exclude materializing views
          without skipping tests on views.
        default: true
        definition:
          union:
            - union: 
              - method: path
                value: "*"
              - exclude: 
                - method: config.materialized
                  value: view
            - method: resource_type
              value: test

    ```
    
4. Сохраните файл и закоммитьте его в репозиторий.
5. Измените команды dbt в заданиях, добавив `--selector skip_views_but_test_views`.

#### Сборка только изменённых views

Чтобы гарантировать пересборку views при изменении логики, создайте merge‑задание, которое запускается при слиянии кода в main:

1. Убедитесь, что в среде настроено [CI‑задание](/docs/deploy/ci-jobs).
2. Создайте новое [deploy‑задание](/docs/deploy/deploy-jobs#create-and-schedule-jobs) с названием “Merge Job”.
3. Установите **Environment** в значение CI‑среды. См. [Types of environments](/docs/deploy/deploy-environments#types-of-environments).
4. Установите **Commands**: `dbt run -s state:modified+`.
   Использовать `dbt build` не требуется, так как CI‑задание уже выполнило сборку и тестирование.
5. В **Execution Settings** выберите production‑задание для сравнения:
   - **Defer to a previous run state** — выберите созданное задание “Merge Job”, чтобы сравнение выполнялось с момента последнего merge.
6. В проекте dbt выполните шаги из руководства [Customizing CI/CD with custom pipelines](/guides/custom-cicd-pipelines), чтобы создать скрипт, который будет вызывать API <Constant name="cloud" /> после merge в репозитории, или посмотрите это [видео](https://www.loom.com/share/e7035c61dbed47d2b9b36b5effd5ee78?sid=bcf4dd2e-b249-4e5d-b173-8ca204d9becb).

Назначение merge‑задания:

- Мгновенно деплоить изменения из PR в production.
- Поддерживать актуальность production‑views при минимальных затратах.

Merge‑процесс оптимизирует затраты на облачную платформу данных и сокращает время выполнения заданий, однако решение о его внедрении остаётся за вами.

### Оптимизация неэффективных моделей

#### Вкладка Job Insights

Для снижения затрат на хранилище данных можно определить, какие модели в среднем собираются дольше всего, на странице **Job** во вкладке **Insights**. График показывает среднее время выполнения моделей на основе последних 20 запусков. Модели с наибольшим временем выполнения — основные кандидаты на оптимизацию.

#### Вкладка Model Timing

Чтобы детальнее понять, сколько времени занимает выполнение каждой модели в конкретном запуске, используйте вкладку **Model Timing**. Выберите нужный запуск на странице **Run History**, затем на странице запуска перейдите во вкладку **Model Timing**. 

После определения моделей для оптимизации рекомендуем ознакомиться с материалами:
* [Build scalable and trustworthy data pipelines with dbt and BigQuery](https://services.google.com/fh/files/misc/dbt_bigquery_whitepaper.pdf) 
* [Best Practices for Optimizing Your dbt and Snowflake Deployment](https://www.snowflake.com/wp-content/uploads/2021/10/Best-Practices-for-Optimizing-Your-dbt-and-Snowflake-Deployment.pdf) 
* [How to optimize and troubleshoot dbt models on Databricks](/guides/optimize-dbt-models-on-databricks)

## Часто задаваемые вопросы

* Что произойдёт, если мне понадобится больше лицензий на плане Starter?  
_Если вам нужно больше лицензий developer, выберите [Contact Sales](https://www.getdbt.com/contact) в настройках биллинга и свяжитесь с отделом продаж для обсуждения плана Enterprise или Enterprise+._  

* Что если я значительно превышу включённый лимит моделей на плане Starter или Developer?  
_Рассмотрите переход на план Starter или Enterprise. Эти планы включают больше моделей и позволяют превышать месячные лимиты. Клиенты Enterprise получают поддержку выделенной команды и индивидуальные условия._ 

* Я хочу обновить план. Сохранится ли вся моя работа?  
_Да. Обновление аккаунта <Constant name="cloud" /> не повлияет на существующие проекты и настройки._

* Как выбрать подходящий план?  
_Лучше всего проконсультироваться с нашей командой продаж. Они помогут подобрать оптимальный вариант. Также доступен бесплатный двухнедельный пробный период плана Starter._

* Каковы условия пробного периода <Constant name="semantic_layer" />?  
_Клиенты Starter и Enterprise могут подключить бесплатный пробный период <Constant name="semantic_layer" />, работающего на MetricFlow, с лимитом до 1 000 запрошенных метрик в месяц. Пробный период доступен как минимум до января 2024 года и может быть продлён по усмотрению dbt Labs. По окончании пробного периода доступ может быть отключён или потребуется покупка._

* Каково ограничение разумного использования для <Constant name="semantic_layer" />, работающего на MetricFlow, в период пробного доступа?  
_Каждый аккаунт ограничен 1 000 запрошенными метриками в месяц в течение пробного периода. Лимиты могут быть изменены по усмотрению dbt Labs._
