---
title: "Биллинг"
id: billing 
description: "Информация о биллинге dbt Cloud." 
sidebar_label: Биллинг
pagination_next: null
pagination_prev: null
---

dbt Cloud предлагает различные [планы и цены](https://www.getdbt.com/pricing/), чтобы соответствовать потребностям вашей организации. С гибкими вариантами биллинга, которые подходят как для крупных предприятий, так и для малых бизнесов, а также с [доступностью серверов](/docs/cloud/about-cloud/access-regions-ip-addresses) по всему миру, dbt Cloud является самым быстрым и простым способом начать трансформацию ваших данных.

## Как работает ценообразование dbt Cloud?

Как клиент, вы платите за количество мест, которые у вас есть, и за объем потребления каждый месяц. Места в основном выставляются на основе количества приобретенных лицензий для разработчиков и для чтения.

Потребление основано на количестве [Успешно построенных моделей](#what-counts-as-a-successful-model-built) и, если они были куплены и использованы, на [Запрашиваемых метриках](#what-counts-as-a-queried-metric) семантического слоя, при условии разумного использования. Все расчеты биллинга проводятся по всемирному координированному времени (UTC).

### Что считается лицензией на место?

Существует три типа возможных лицензий на место:

* **Разработчик** &mdash; для ролей и разрешений, которые требуют взаимодействия с окружением dbt Cloud на ежедневной основе.
* **Только для чтения** &mdash; для доступа к просмотру определенных документов и отчетов. 
* **IT** &mdash; для доступа к определенным функциям, связанным с управлением учетной записью (например, настройка интеграции с git). 

### Что считается Успешно построенной моделью?

dbt Cloud считает Успешно построенной моделью любую <Term id="model">модель</Term>, которая успешно построена через запуск с использованием функциональности оркестрации dbt Cloud в окружении развертывания dbt Cloud. Модели учитываются при их построении и запуске. Это включает любые задания, запущенные через планировщик dbt Cloud, CI сборки (задания, инициированные запросами на слияние), запуски, инициированные через API dbt Cloud, и любые последующие инструменты dbt Cloud с аналогичной функциональностью. Это также включает модели, которые успешно построены, даже если запуск может не завершиться. Например, у вас может быть задание, содержащее 100 моделей, и в одном из его запусков 51 модель успешно построена, а затем задание завершилось с ошибкой. В этой ситуации будет учтено только 51 модель.

Любые модели, построенные в окружении разработки dbt Cloud (например, через IDE), не учитываются в вашем потреблении. Тесты, семена, эфемерные модели и снимки также не учитываются. 

| Что учитывается в Успешно построенных моделях |                     |
|---------------------------------------------|---------------------|
| Просмотр                                    | ✅                  |
| Таблица                                     | ✅                  |
| Инкрементальная                             | ✅                  |
| Эфемерные модели                            | ❌                  |
| Тесты                                       | ❌                  |
| Семена                                      | ❌                  |
| Снимки                                      | ❌                  |

### Что считается Запрашиваемой метрикой?

Семантический слой dbt, работающий на базе MetricFlow, измеряет использование в виде отдельных Запрашиваемых метрик.

- Каждый успешный запрос, который вы делаете для рендеринга или выполнения SQL к API семантического слоя, считается как минимум одной запрашиваемой метрикой, даже если данные не возвращаются. 
- Если запрос вычисляет или рендерит SQL для нескольких метрик, каждая вычисленная метрика будет считаться запрашиваемой метрикой.
- Если запрос на выполнение запроса не выполняется успешно на платформе данных или если запрос приводит к ошибке без завершения, он не учитывается как запрашиваемая метрика. 
- Запросы на метаданные из семантического слоя также не учитываются как запрашиваемые метрики.

Примеры запрашиваемых метрик включают:

- Запрос одной метрики, группировка по одному измерению → 1 запрашиваемая метрика 

  ```shell
  dbt sl query --metrics revenue --group-by metric_time
  ```

- Запрос одной метрики, группировка по двум измерениям → 1 запрашиваемая метрика 

  ```shell
  dbt sl query --metrics revenue --group-by metric_time,user__country
  ```

- Запрос двух метрик, группировка по двум измерениям → 2 запрашиваемые метрики 

  ```shell
  dbt sl query --metrics revenue,gross_sales --group-by metric_time,user__country
  ```

- Выполнение объяснения для одной метрики → 1 запрашиваемая метрика

  ```shell
  dbt sl query --metrics revenue --group-by metric_time --explain
  ```

- Выполнение объяснения для двух метрик → 2 запрашиваемые метрики

  ```shell
  dbt sl query --metrics revenue,gross_sales --group-by metric_time --explain
  ```

### Просмотр использования в продукте 

Просмотр использования в продукте ограничен определенными ролями:

* Командный план &mdash; группа владельцев
* Корпоративный план &mdash; роли администратора учетной записи и биллинга

Для просмотра использования на уровне учетной записи, если у вас есть доступ к страницам **Биллинг** и **Использование**, вы можете увидеть оценку использования за месяц. На странице Биллинга в **Настройках учетной записи** вы можете увидеть, как ваша учетная запись отслеживает свое использование. Вы также можете увидеть, какие проекты строят больше всего моделей.

<Lightbox src="/img/docs/building-a-dbt-project/billing-usage-page.jpg" width="80%" title="Чтобы увидеть оценку использования на уровне учетной записи, перейдите в 'Настройки учетной записи', а затем выберите 'Биллинг'."/>

Как пользователь Командного и Разработчика плана, вы можете видеть, как учетная запись отслеживает включенные построенные модели. Как пользователь Корпоративного плана, вы можете видеть, сколько вы использовали из вашего годового обязательства и сколько осталось.

На каждой странице **Домашняя страница проекта** любой пользователь с доступом к этому проекту может видеть, сколько моделей строится каждый месяц. Оттуда можно найти дополнительные детали о лучших заданиях по построенным моделям на каждой странице **Окружение**.

<Lightbox src="/img/docs/building-a-dbt-project/billing-project-page.jpg" width="80%" title="Ваша домашняя страница проекта отображает, сколько моделей строится каждый месяц."/>

Кроме того, вы можете посмотреть на вкладке **Инсайты** на странице **Детали задания**, чтобы увидеть, сколько моделей строится в месяц для этого конкретного задания и какие модели требуют больше всего времени на построение. 

<Lightbox src="/img/docs/building-a-dbt-project/billing-job-page.jpg" width="80%" title="Посмотрите, сколько моделей строится в месяц для конкретного задания, перейдя на вкладку 'Инсайты' на странице 'Детали задания'."/>

Информация о потреблении доступна клиентам на планах, основанных на потреблении, и некоторые визуализации использования могут быть недоступны для клиентов на устаревших планах. Любые данные о потреблении, отображаемые в dbt Cloud, являются лишь оценкой вашего использования, и может быть задержка в отображении данных о потреблении в продукте. Ваше окончательное использование за месяц будет видно в ваших ежемесячных отчетах (отчеты применимы к Командным и Корпоративным планам).

## Планы и биллинг

dbt Cloud предлагает несколько [планов](https://www.getdbt.com/pricing) с различными функциями, которые соответствуют вашим потребностям. Мы можем время от времени вносить изменения в детали наших планов. Мы всегда будем сообщать вам об этом заранее, чтобы вы могли подготовиться. В следующем разделе объясняется, как работает биллинг в каждом плане.

### Биллинг плана Разработчика

Планы разработчиков бесплатны и включают одну лицензию разработчика и 3,000 моделей каждый месяц. Модели обновляются в начале каждого календарного месяца. Если вы превысите 3,000 моделей, любые последующие запуски будут отменены до тех пор, пока модели не будут обновлены или пока вы не перейдете на платный план. Остальная часть платформы dbt Cloud по-прежнему доступна, и никакая работа не будет потеряна.

Все включенные успешные модели, построенные выше, отражают наши самые актуальные цены и упаковку. В зависимости от условий использования, когда вы подписались на план Разработчика, включенные права на модели могут отличаться от указанных выше.

### Биллинг плана Команды 

Клиенты команды платят ежемесячно с помощью кредитной карты за места и использование, а учетные записи включают 15,000 моделей в месяц. Места оплачиваются заранее в начале месяца. Если вы добавите места в течение месяца, они будут пропорционально рассчитаны и выставлены к оплате в тот же день. Удаленные места в течение месяца будут отражены в следующем счете и не подлежат возврату. Вы можете изменить информацию о кредитной карте и количество мест в разделе биллинга в любое время. Учетные записи будут получать один ежемесячный счет, который включает предварительный платеж за места и использование, выставленное в заднем порядке за предыдущий месяц.

Использование рассчитывается и выставляется в заднем порядке за предыдущий месяц. Если вы превысите 15,000 моделей в любом месяце, вам будет выставлен счет за дополнительное использование в следующем счете. Дополнительное использование выставляется по тарифам на нашей [странице цен](https://www.getdbt.com/pricing). 

Включенные модели, которые не были использованы, не переносятся на будущие месяцы. Вы можете оценить свой счет с помощью простой формулы:

`($100 x количество мест для разработчиков) + ((построенные модели - 15,000) x $0.01)`

Все включенные успешные модели, построенные выше, отражают наши самые актуальные цены и упаковку. В зависимости от условий использования, когда вы подписались на план Команды, включенные права на модели могут отличаться от указанных выше.

### Биллинг плана Корпорации

Как корпоративный клиент, вы платите ежегодно по счету, ежемесячно в заднем порядке за дополнительное использование (если применимо) и можете воспользоваться согласованными тарифами на использование. Пожалуйста, обратитесь к вашему заказу или контракту для получения конкретных деталей о ценах, или [свяжитесь с командой по работе с клиентами](https://www.getdbt.com/contact-demo) с любыми вопросами. 

Информация о биллинге корпоративного плана недоступна в интерфейсе dbt Cloud. Изменения обрабатываются через вашего архитектора решений dbt Labs или менеджера команды по работе с клиентами.

### Устаревшие планы

Клиенты, которые приобрели план dbt Cloud Команды до 11 августа 2023 года, остаются на устаревшем ценовом плане, пока ваша учетная запись находится в хорошем состоянии. Устаревший ценовой план основан на местах и включает неограниченные модели, при условии разумного использования. 

:::note Устаревший семантический слой

Для клиентов, использующих устаревший семантический слой с пакетом dbt_metrics, этот продукт будет снят с поддержки в декабре 2023 года. Устаревшие пользователи могут в любое время выбрать обновление до обновленной версии, семантического слоя, работающего на базе MetricFlow. Обновленная версия доступна для большинства клиентов (см. [предварительные условия](/guides/sl-snowflake-qs#prerequisites)) на ограниченный срок на бесплатной пробной основе, при условии разумного использования.

:::

dbt Labs может установить ограничения на использование, если разумное использование превышено. Дополнительные функции, обновления или обновления могут подлежать отдельным сборам. Любые изменения в текущих ценах вашего плана будут сообщены заранее в соответствии с нашими Условиями использования.

## Управление использованием

В dbt Cloud нажмите на имя вашей учетной записи в левом боковом меню и выберите **Настройки учетной записи**. Опция **Биллинг** будет находиться в левом боковом меню под заголовком **Настройки**. Здесь вы можете просмотреть доступные планы и функции, предоставляемые для каждого из них. 

### Уведомления об использовании 

Каждый план автоматически отправляет уведомления по электронной почте, когда достигнуто 75%, 90% и 100% оценок использования. В плане Команды все пользователи в группе владельцев получат уведомления. В корпоративных планах все пользователи с правами администратора учетной записи и администратора биллинга получат уведомления. Пользователи не могут отказаться от этих электронных писем. Если вы хотите, чтобы дополнительные пользователи получали эти уведомления по электронной почте, пожалуйста, предоставьте им соответствующие права, упомянутые выше. Обратите внимание, что ваше использование может уже превышать процент, указанный в уведомлении, из-за вашего шаблона использования и небольших задержек. 

### Как остановить накопление использования?

Существует 2 варианта отключения построения моделей и выставления счетов:

1. Откройте **Настройки задания** каждого задания и перейдите в раздел **Триггеры**. Отключите **Запуск по расписанию** и установите функцию **Непрерывная интеграция** **Запуск по запросам на слияние?** на **Нет**. Проверьте свои рабочие процессы, чтобы убедиться, что вы не инициируете никаких запусков через API dbt Cloud. Этот вариант позволит вам сохранить ваши задания dbt Cloud без построения дополнительных моделей. 
2. В качестве альтернативы вы можете удалить некоторые или все ваши задания dbt Cloud. Это гарантирует, что никакие запуски не будут инициированы, но вы навсегда потеряете свои задания. 

## Оптимизация затрат в dbt Cloud

dbt Cloud предлагает способы оптимизации использования построенных моделей и затрат на хранилище. 

### Лучшие практики для оптимизации успешных моделей

При поиске способов оптимизации ваших затрат на успешные модели есть методы, позволяющие снизить эти затраты, соблюдая при этом лучшие практики. Чтобы убедиться, что вы по-прежнему используете тесты и обновляете представления при изменении логики, рекомендуется реализовать комбинацию лучших практик, которые соответствуют вашим потребностям. Более конкретно, если вы решите исключить представления из ваших регулярно запланированных запусков dbt Cloud, крайне важно настроить задание слияния (с ссылкой на раздел), чтобы развернуть обновленную логику представления, когда изменения будут обнаружены.

#### Исключение представлений в задании dbt Cloud

Многие пользователи dbt Cloud используют представления, которые не всегда нужно перестраивать каждый раз, когда вы запускаете задание. Для любых заданий, которые содержат представления, которые _не_ включают макросы, динамически генерирующие код (например, операторы case) на основе верхних таблиц и также _не_ имеют тестов, вы можете выполнить следующие шаги:

1. Перейдите к вашему текущему заданию развертывания в dbt Cloud.
2. Измените вашу команду, чтобы включить: `--exclude config.materialized:view`.
3. Сохраните изменения в вашем задании.

Если у вас есть представления, которые содержат макросы с операторами case на основе верхних таблиц, их необходимо запускать каждый раз, чтобы учесть новые значения. Если вам все еще нужно тестировать ваши представления с каждым запуском, следуйте лучшей практике [Исключение представлений при запуске тестов](#exclude-views-while-running-tests), чтобы создать пользовательский селектор. 

#### Исключение представлений при запуске тестов

Запуск тестов для представлений в каждом запуске задания может помочь сохранить качество данных и избавить вас от необходимости повторно запускать неудачные задания. Чтобы исключить представления из вашего запуска задания при запуске тестов, вы можете выполнить следующие шаги, чтобы создать пользовательский [селектор](https://docs.getdbt.com/reference/node-selection/yaml-selectors) для вашей команды задания. 

1. Откройте ваш проект dbt в IDE dbt Cloud.
2. Добавьте файл с именем `selectors.yml` в вашу верхнюю папку проекта.
3. В файле добавьте следующий код:

   ```yaml 
    selectors:
      - name: skip_views_but_test_views
        description: >
          Селектор по умолчанию, который исключит материализованные представления
          без пропуска тестов на представления.
        default: true
        definition:
          union:
            - union: 
              - method: path
                value: "*"
              - exclude: 
                - method: config.materialized
                  value: view
            - method: resource_type
              value: test

    ```
    
4. Сохраните файл и зафиксируйте его в вашем проекте.
5. Измените ваши задания dbt Cloud, чтобы включить `--selector skip_views_but_test_views`.

#### Построение только измененных представлений

Если вы хотите убедиться, что вы строите представления всякий раз, когда логика изменяется, создайте задание слияния, которое будет инициироваться при слиянии кода в основную ветку: 

1. Убедитесь, что у вас настроено [CI задание](/docs/deploy/ci-jobs) в вашем окружении.
2. Создайте новое [задание развертывания](/docs/deploy/deploy-jobs#create-and-schedule-jobs) и назовите его "Задание слияния".
3. Установите **Окружение** на ваше CI окружение. Смотрите [Типы окружений](/docs/deploy/deploy-environments#types-of-environments) для получения дополнительных деталей.
4. Установите **Команды** на: `dbt run -s state:modified+`.
    Выполнение `dbt build` в этом контексте не требуется, так как CI задание использовалось для запуска и тестирования кода, который только что был слит в основную ветку.
5. В разделе **Настройки выполнения** выберите задание по умолчанию для сравнения изменений:
    - **Отложить до состояния предыдущего запуска** &mdash; Выберите "Задание слияния", которое вы создали, чтобы задание сравнивало и определяло, что изменилось с момента последнего слияния.
6. В вашем проекте dbt выполните шаги в разделе Запуск задания dbt Cloud при слиянии в руководстве [Настройка CI/CD с помощью пользовательских конвейеров](/guides/custom-cicd-pipelines), чтобы создать скрипт для вызова API dbt Cloud для запуска вашего задания после слияния в вашем репозитории git или посмотрите это [видео](https://www.loom.com/share/e7035c61dbed47d2b9b36b5effd5ee78?sid=bcf4dd2e-b249-4e5d-b173-8ca204d9becb).

Цель задания слияния заключается в том, чтобы:

- Немедленно развернуть любые изменения из PR в продакшн.
- Обеспечить актуальность ваших производственных представлений в соответствии с тем, как они определены в вашем коде, оставаясь при этом экономически эффективными при запуске заданий в продакшн.

Действие слияния оптимизирует ваши расходы на облачную платформу данных и сокращает время выполнения заданий, но вам нужно решить, подходит ли это изменение для вашего проекта dbt.

### Переработка неэффективных моделей

#### Вкладка Инсайты задания

Чтобы сократить ваши расходы на хранилище, вы можете определить, какие модели в среднем требуют больше всего времени на построение на странице **Задание** в разделе **Инсайты**. Этот график показывает среднее время выполнения для каждой модели на основе ее последних 20 запусков. Любые модели, которые требуют больше времени на построение, чем ожидалось, могут быть первыми кандидатами на оптимизацию, что в конечном итоге снизит расходы на облачное хранилище. 

#### Вкладка Время модели

Чтобы лучше понять, сколько времени занимает выполнение каждой модели в контексте конкретного запуска, вы можете посмотреть на вкладку **Время модели**. Выберите интересующий запуск на странице **История запусков**, чтобы найти вкладку. На этой странице **Запуск** нажмите **Время модели**. 

Как только вы определите, какие модели могут быть оптимизированы, ознакомьтесь с другими ресурсами, которые объясняют, как оптимизировать вашу работу: 
* [Создание масштабируемых и надежных конвейеров данных с помощью dbt и BigQuery](https://services.google.com/fh/files/misc/dbt_bigquery_whitepaper.pdf) 
* [Лучшие практики для оптимизации вашего развертывания dbt и Snowflake](https://www.snowflake.com/wp-content/uploads/2021/10/Best-Practices-for-Optimizing-Your-dbt-and-Snowflake-Deployment.pdf) 
* [Как оптимизировать и устранять неполадки моделей dbt на Databricks](/guides/optimize-dbt-models-on-databricks)

## Часто задаваемые вопросы

* Что произойдет, если мне нужно больше 8 мест на плане Команды? 
_Если вам нужно больше 8 мест для разработчиков, выберите опцию Связаться с отделом продаж в настройках биллинга, чтобы обсудить с нашей командой продаж возможность перехода на корпоративный план._  

* Что, если я значительно превышу свои включенные бесплатные модели на плане Команды или Разработчика?
_Рассмотрите возможность перехода на план Команды или Корпоративный план. Планы Команды включают больше моделей и позволяют вам превышать месячный лимит использования. Корпоративные аккаунты поддерживаются выделенной командой управления учетными записями и предлагают годовые планы, индивидуальные конфигурации и согласованные тарифы на использование._ 

* Я хочу перейти на другой план. Перенесется ли вся моя работа?
_Да. Ваша учетная запись dbt Cloud будет обновлена без влияния на ваши существующие проекты и настройки учетной записи._

* Как мне определить, какой план подходит мне?
 _Лучший вариант — проконсультироваться с нашей командой продаж. Они помогут вам определить, что подходит для ваших нужд. Мы также предлагаем бесплатную двухнедельную пробную версию на плане Команды._

* Каковы условия пробной версии семантического слоя?
_Клиенты команды и корпоративные клиенты могут подписаться на бесплатную пробную версию семантического слоя dbt, работающего на базе MetricFlow, для использования до 1,000 запрашиваемых метрик в месяц. Пробная версия будет доступна как минимум до января 2024 года. dbt Labs может продлить пробный период по своему усмотрению. В течение пробного периода мы можем связаться с вами, чтобы обсудить варианты ценообразования или запросить обратную связь. По окончании пробного периода бесплатный доступ может быть отменен, и может потребоваться покупка для продолжения использования. dbt Labs оставляет за собой право изменять лимиты в бесплатной пробной версии или вводить ценообразование, когда это необходимо или в любое время по своему усмотрению._

* Каково разумное ограничение использования для семантического слоя, работающего на базе MetricFlow, в течение пробного периода? 
_Каждая учетная запись будет ограничена 1,000 запрашиваемых метрик в месяц в течение пробного периода и может быть изменена по усмотрению dbt Labs._
