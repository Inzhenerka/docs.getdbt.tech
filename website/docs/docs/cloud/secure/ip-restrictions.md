---
title: "Настройка ограничений по IP"
id: ip-restrictions
description: "Настройка ограничений по IP для предотвращения доступа внешнего трафика к вашей среде dbt Cloud"
sidebar_label: "Ограничения по IP"
pagination_next: "docs/cloud/secure/about-privatelink"
pagination_prev: null
---

import SetUpPages from '/snippets/_available-tiers-iprestrictions.md';

<SetUpPages features={'/snippets/_available-tiers-iprestrictions.md'}/>

Ограничения по IP помогают контролировать, какие IP-адреса могут подключаться к dbt Cloud. Ограничения по IP позволяют клиентам dbt Cloud соответствовать требованиям безопасности и соблюдения норм, разрешая подключение только одобренным IP-адресам к их среде dbt Cloud. Эта функция поддерживается во всех регионах Северной Америки, Европы и Азиатско-Тихоокеанского региона, но свяжитесь с нами, если у вас есть вопросы о доступности.

## Настройка ограничений по IP

Чтобы настроить ограничения по IP, перейдите в **Настройки аккаунта** → **Ограничения по IP**. Ограничения по IP предоставляют два метода для определения, какие IP-адреса могут получить доступ к dbt Cloud: белый список и черный список. IP-адреса в белом списке могут получить доступ к dbt Cloud, а IP-адреса в черном списке будут заблокированы. Ограничения по IP могут использоваться для различных сценариев, включая:

- Разрешение только трафика корпоративной VPN и блокировка всего остального трафика
- Блокировка IP-адресов, отмеченных командой безопасности
- Разрешение только трафика VPN, но с исключением для IP-адресов подрядчиков

Ограничения по IP будут блокировать все токены сервиса, запросы пользователей, выполненные через API (через личный токен пользователя), и интерфейс, если они поступают с заблокированных IP-адресов.

Для любых интеграций систем контроля версий (Github, Gitlab, ADO и т.д.), входящих в dbt Cloud, убедитесь, что их IP-адреса добавлены в разрешенный список.

### Разрешение IP-адресов

Чтобы добавить IP в белый список, на странице **Ограничения по IP**:

1. Нажмите **Редактировать**
2. Нажмите **Добавить правило**
3. Укажите имя и описание для правила
    - Например, диапазон CIDR корпоративной VPN
4. Выберите **Разрешить**
5. Добавьте диапазоны в нотации CIDR
	- Например, 1.1.1.1/8
	- Вы можете добавить несколько диапазонов в одно правило.
6. Нажмите **Сохранить**

Добавьте несколько диапазонов IP, нажав кнопку **Добавить диапазон IP**, чтобы создать новое текстовое поле.

Обратите внимание, что простое добавление диапазонов IP не будет обеспечивать соблюдение ограничений по IP. Для получения дополнительной информации смотрите раздел [Включение ограничений](#enabling-restrictions).

Если вы хотите разрешить только диапазоны IP, добавленные в этот список, и заблокировать все остальные запросы, добавление черного списка не обязательно. По умолчанию, если добавлен только белый список, dbt Cloud будет разрешать только IP-адреса в допустимом диапазоне и блокировать все остальные IP-адреса. Однако вы можете добавить черный список, если хотите заблокировать определенные IP-адреса в пределах вашего диапазона CIDR белого списка.

### Блокировка IP-адресов (запрет)

Если у вас есть IP-адреса, определенные в белом списке, которые необходимо заблокировать, вы можете добавить эти диапазоны IP в черный список, выполнив следующие действия:

1. Нажмите **Редактировать**
2. Нажмите **Добавить правило**
3. Укажите имя и описание для правила
	- Например, "Диапазон запрета корпоративной VPN"
4. Выберите **Запретить**
5. Добавьте диапазоны или отдельные IP-адреса в нотации CIDR
6. Нажмите **Сохранить**

:::note Дублирующиеся IP-адреса

Если идентичные IP-адреса находятся как в разрешенных, так и в заблокированных конфигурациях, то второе введенное значение не удастся сохранить.

Возможно, поместить диапазон IP в один список, а затем поддиапазон или IP-адрес, который является его частью, в другой. Используя США (диапазон) и Нью-Йорк (поддиапазон) в качестве примера, ожидаемое поведение следующее:
- США в черном списке, а Нью-Йорк в белом списке - Трафик из США будет заблокирован, но IP-адреса из Нью-Йорка будут разрешены.
- США в белом списке, а Нью-Йорк в черном списке - Трафик из США будет разрешен, но IP-адреса из Нью-Йорка будут заблокированы.

:::

## Включение ограничений

После того как вы добавили все свои диапазоны, ограничения по IP можно включить, выбрав кнопку **Включить ограничения по IP** и нажав **Сохранить**. Если ваш IP-адрес находится в любом из диапазонов черного списка, вы не сможете сохранить или включить ограничения по IP - это сделано для предотвращения случайной блокировки аккаунта. Если вы все же окажетесь заблокированы из-за изменений IP с вашей стороны, пожалуйста, свяжитесь с support@getdbt.com.

После включения, когда кто-то попытается получить доступ к dbt Cloud с ограниченного IP, он столкнется с одним из следующих сообщений в зависимости от того, использует ли он вход по электронной почте и паролю или вход через SSO. 

<Lightbox src="/img/docs/dbt-cloud/ip-restricted-email.png" title="Сообщение об отказе в доступе из-за ограничений по IP для входа по электронной почте"/>

<Lightbox src="/img/docs/dbt-cloud/ip-restricted-sso.png" title="Сообщение об отказе в доступе из-за ограничений по IP для входа через SSO"/>