---
title: "Журнал аудита для dbt Cloud Enterprise"
id: audit-log
description: "Вы можете устранять возможные проблемы и проводить аудиты безопасности, просматривая активность событий в вашей организации."
sidebar_label: "Журнал аудита"
pagination_next: null
pagination_prev: "docs/cloud/manage-access/about-user-access"
---

Для просмотра действий, выполненных людьми в вашей организации, dbt предоставляет журналы аудированных пользовательских и системных событий в реальном времени. Журнал аудита отображается по мере возникновения событий и включает такие детали, как кто выполнил действие, что это было за действие и когда оно было выполнено. Вы можете использовать эти детали для устранения проблем с доступом, проведения аудитов безопасности или анализа конкретных событий.

Вы должны быть **Администратором аккаунта** или **Просмотрщиком аккаунта**, чтобы получить доступ к журналу аудита, и эта функция доступна только в планах Enterprise.

Журнал аудита dbt Cloud хранит все события, произошедшие в вашей организации в реальном времени, включая:

- Для событий в пределах 90 дней, журнал аудита dbt Cloud имеет выбираемый диапазон дат, который перечисляет вызванные события.
- Для событий старше 90 дней, **Администраторы аккаунта** и **Просмотрщики аккаунта** могут [экспортировать все события](#exporting-logs) с помощью **Экспортировать все**.

## Доступ к журналу аудита

Чтобы получить доступ к журналу аудита, нажмите на имя вашего аккаунта в меню слева и выберите **Настройки аккаунта**.

<Lightbox src="/img/docs/dbt-cloud/dbt-cloud-enterprise/audit-log-menu.png" width="30%" title="Меню журнала аудита"/>

## Понимание журнала аудита

На странице журнала аудита вы увидите список различных событий и связанных с ними данных о событиях. Каждое из этих событий показывает следующую информацию в dbt:

* **Название события**: Действие, которое было вызвано
* **Агент**: Пользователь, который вызвал это действие/событие
* **Временная метка**: Локальная временная метка, когда произошло событие

### Детали события

Нажмите на карточку события, чтобы увидеть детали о деятельности, которая вызвала событие. Этот вид предоставляет важные детали, включая когда это произошло и какой тип события был вызван. Например, если кто-то изменяет настройки для задания, вы можете использовать детали события, чтобы увидеть, какое задание было изменено (тип события: `job_definition.Changed`), кем (человек, который вызвал событие: `actor`), и когда (время, когда оно было вызвано: `created_at_utc`). Для типов событий и их описаний смотрите [События в журнале аудита](#audit-log-events).

Детали события предоставляют ключевые факторы события:

| Имя                  | Описание                                   |
| -------------------- | ------------------------------------------ |
| account_id           | ID аккаунта, где произошло событие         |
| actor                | Актор, который выполнил событие - Пользователь или Сервис |
| actor_id             | Уникальный ID актора                       |
| actor_ip             | IP-адрес актора                            |
| actor_name           | Идентифицирующее имя актора                |
| actor_type           | Было ли действие выполнено пользователем или API-запросом |
| created_at           | Временная метка UTC, когда произошло событие |
| event_type           | Уникальный ключ, идентифицирующий событие  |
| event_context        | Этот ключ будет различаться для каждого события и будет соответствовать event_type. Эти данные будут включать все детали об объекте(ах), которые были изменены. |
| id                   | Уникальный ID события                      |
| service              | Сервис, который выполнил действие          |
| source               | Источник события - dbt Cloud UI или API    |

## События в журнале аудита

Журнал аудита поддерживает различные события для разных объектов в dbt Cloud. Вы найдете события для аутентификации, окружения, заданий, сервисных токенов, групп, пользователей, проектов, разрешений, лицензий, соединений, репозиториев и учетных данных.

### Аутентификация

| Название события              | Тип события                               | Описание                                            |
| ----------------------------- | ---------------------------------------- | -------------------------------------------------- |
| Изменение провайдера аутентификации | auth_provider.Changed          | Изменены настройки провайдера аутентификации        |
| Успешный вход по учетным данным | auth.CredentialsLoginSucceeded | Пользователь успешно вошел с именем пользователя и паролем |
| Неудачный вход через SSO      | auth.SsoLoginFailed            | Неудачная попытка входа пользователя через SSO      |
| Успешный вход через SSO       | auth.SsoLoginSucceeded         | Пользователь успешно вошел через SSO                |

### Окружение

| Название события     | Тип события                    | Описание                          |
| ------------------- | ----------------------------- | --------------------------------- |
| Добавлено окружение | environment.Added   | Новое окружение успешно создано  |
| Изменено окружение  | environment.Changed | Изменены настройки окружения     |
| Удалено окружение   | environment.Removed | Окружение успешно удалено        |

### Задания

| Название события | Тип события                        | Описание                  |
| ---------------- | --------------------------------- | ------------------------- |
| Добавлено задание| job_definition.Added   | Новое задание успешно создано |
| Изменено задание | job_definition.Changed | Изменены настройки задания |
| Удалено задание  | job_definition.Removed | Определение задания удалено |

### Сервисный токен

| Название события         | Тип события                       | Описание                                |
| ------------------------ | -------------------------------- | --------------------------------------- |
| Создан сервисный токен   | service_token.Created | Новый сервисный токен успешно создан    |
| Отозван сервисный токен  | service_token.Revoked | Сервисный токен отозван                 |

### Группа

| Название события | Тип события                    | Описание                    |
| ---------------- | ----------------------------- | --------------------------- |
| Добавлена группа | user_group.Added   | Новая группа успешно создана|
| Изменена группа  | user_group.Changed | Изменены настройки группы    |
| Удалена группа   | user_group.Removed | Группа успешно удалена       |

### Пользователь

| Название события               | Тип события                          | Описание                                     |
| ------------------------------ | ----------------------------------- | -------------------------------------------- |
| Добавлено приглашение          | invite.Added              | Приглашение пользователя добавлено и отправлено |
| Приглашение использовано       | invite.Redeemed           | Пользователь использовал приглашение         |
| Пользователь добавлен в аккаунт| account.UserAdded         | Новый пользователь добавлен в аккаунт        |
| Пользователь добавлен в группу | user_group_user.Added     | Существующий пользователь добавлен в группу  |
| Пользователь удален из аккаунта| account.UserRemoved       | Пользователь удален из аккаунта              |
| Пользователь удален из группы  | user_group_user.Removed   | Существующий пользователь удален из группы   |
| Подтверждено письмо верификации| user.jit.email.Confirmed  | Подтверждение электронной почты пользователем|
| Отправлено письмо верификации  | user.jit.email.Sent       | Письмо верификации отправлено пользователю через JIT |

### Проект

| Название события | Тип события                | Описание              |
| ---------------- | ------------------------- | --------------------- |
| Добавлен проект  | project.Added   | Новый проект добавлен |
| Изменен проект   | project.Changed | Изменены настройки проекта |
| Удален проект    | project.Removed | Проект удален         |

### Разрешения

| Название события          | Тип события                   | Описание                    |
| ------------------------- | ---------------------------- | --------------------------- |
| Добавлено разрешение пользователя | permission.Added   | Добавлены новые разрешения пользователя |
| Удалено разрешение пользователя   | permission.Removed | Удалены разрешения пользователя |

### Лицензия

| Название события          | Тип события                     | Описание                               |
| ------------------------- | ------------------------------ | -------------------------------------- |
| Добавлено сопоставление лицензии | license\_map.Added   | Добавлено новое сопоставление лицензии пользователя |
| Изменено сопоставление лицензии  | license\_map.Changed | Изменены настройки сопоставления лицензии пользователя |
| Удалено сопоставление лицензии   | license\_map.Removed | Удалено сопоставление лицензии пользователя |

### Соединение

| Название события     | Тип события                   | Описание                                |
| -------------------- | ---------------------------- | --------------------------------------- |
| Добавлено соединение | connection.Added   | Добавлено новое соединение с хранилищем данных |
| Изменено соединение  | connection.Changed | Изменены настройки соединения с хранилищем данных |
| Удалено соединение   | connection.Removed | Соединение с хранилищем данных удалено  |

### Репозиторий

| Название события     | Тип события                   | Описание                 |
| -------------------- | ---------------------------- | ------------------------ |
| Добавлен репозиторий | repository.Added   | Новый репозиторий добавлен |
| Изменен репозиторий  | repository.Changed | Изменены настройки репозитория |
| Удален репозиторий   | repository.Removed | Репозиторий удален       |

### Учетные данные

| Название события                       | Тип события                    | Описание            |
| -------------------------------------- | ----------------------------- | ------------------- |
| Добавлены учетные данные в проект      | credentials.Added   | Учетные данные проекта добавлены |
| Изменены учетные данные в проекте      | credentials.Changed | Учетные данные изменены в проекте |
| Удалены учетные данные из проекта      | credentials.Removed | Учетные данные удалены из проекта |

### Интеграция с Git

| Название события                       | Тип события                    | Описание            |
| -------------------------------------- | ----------------------------- | ------------------- |
| Изменена конфигурация GitLab           | gitlab_application.changed    | Изменена конфигурация GitLab в dbt Cloud |

### Вебхуки

| Название события                       | Тип события                    | Описание            |
| -------------------------------------- | ----------------------------- | ------------------- |
| Добавлены подписки на вебхуки          | webhook_subscription.added    | Новый вебхук настроен в настройках |
| Изменены подписки на вебхуки           | webhook_subscription.changed  | Изменена существующая конфигурация вебхука |
| Удалены подписки на вебхуки            | webhook_subscription.removed  | Существующий вебхук удален |

### Семантический слой

| Название события                       | Тип события                    | Описание            |
| -------------------------------------- | ----------------------------- | ------------------- |
| Добавлена конфигурация семантического слоя | semantic_layer_config.added   | Добавлена конфигурация семантического слоя |
| Изменена конфигурация семантического слоя | semantic_layer_config.changed  | Изменена конфигурация семантического слоя (не связанная с учетными данными) |
| Удалена конфигурация семантического слоя | semantic_layer_config.removed   | Удалена конфигурация семантического слоя |
| Добавлены учетные данные семантического слоя | semantic_layer_credentials.added   | Добавлены учетные данные семантического слоя |
| Изменены учетные данные семантического слоя | semantic_layer_credentials.changed   | Изменены учетные данные семантического слоя. Не вызывает semantic_layer_config.changed |
| Удалены учетные данные семантического слоя | semantic_layer_credentials.removed   | Удалены учетные данные семантического слоя |

### Расширенные атрибуты

| Название события                       | Тип события                    | Описание            |
| -------------------------------------- | ----------------------------- | ------------------- |
| Добавлен расширенный атрибут           | extended_attributes.added     | Расширенный атрибут добавлен в проект |
| Изменен расширенный атрибут            | extended_attributes.changed   | Изменен или удален расширенный атрибут |

### Персональный токен доступа с областью аккаунта

| Название события                       | Тип события                    | Описание            |
| -------------------------------------- | ----------------------------- | ------------------- |
| Создан персональный токен доступа с областью аккаунта | account_scoped_pat.created | Создан персональный токен доступа с областью аккаунта |
| Удален персональный токен доступа с областью аккаунта | account_scoped_pat.deleted | Удален персональный токен доступа с областью аккаунта |

### Ограничения по IP

| Название события                       | Тип события                    | Описание            |
| -------------------------------------- | ----------------------------- | ------------------- |
| Переключены ограничения по IP          | ip_restrictions.toggled       | Функция ограничений по IP включена или отключена |
| Добавлено правило ограничения по IP    | ip_restrictions.rule.added    | Создано правило ограничения по IP |
| Изменено правило ограничения по IP     | ip_restrictions.rule.changed   | Отредактировано правило ограничения по IP |
| Удалено правило ограничения по IP      | ip_restrictions.rule.removed   | Удалено правило ограничения по IP |

## Поиск в журнале аудита

Вы можете искать в журнале аудита, чтобы найти конкретное событие или актера, что ограничено теми, которые перечислены в [События в журнале аудита](#events-in-audit-log). Журнал аудита успешно перечисляет исторические события за последние 90 дней. Вы можете искать актера или событие, используя строку поиска, а затем сузить результаты, используя временное окно.

<Lightbox src="/img/docs/dbt-cloud/dbt-cloud-enterprise/audit-log-search.png" width="95%" title="Используйте строку поиска, чтобы найти контент в журнале аудита"/>

## Экспорт журналов

Вы можете использовать журнал аудита для экспорта всех исторических результатов аудита в целях безопасности, соответствия и анализа:

- **Для событий в пределах 90 дней** &mdash; dbt Cloud автоматически отобразит выбираемый диапазон дат в 90 дней. Выберите **Экспортировать выбор**, чтобы скачать CSV-файл всех событий, произошедших в вашей организации в течение 90 дней.

- **Для событий старше 90 дней** &mdash; Выберите **Экспортировать все**. Администратор аккаунта или Просмотрщик аккаунта получит ссылку на электронную почту для скачивания CSV-файла всех событий, произошедших в вашей организации.

<Lightbox src="/img/docs/dbt-cloud/dbt-cloud-enterprise/audit-log-section.jpg" width="95%" title="Просмотр опций экспорта журнала аудита"/>