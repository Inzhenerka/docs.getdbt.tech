---
title: "Журнал аудита в dbt Enterprise"
id: audit-log
description: "Вы можете устранять возможные проблемы и проводить аудиты безопасности, просматривая активность событий в вашей организации."
sidebar_label: "Журнал аудита"
pagination_next: null
pagination_prev: "docs/cloud/manage-access/about-user-access"
---

# dbt audit log <Lifecycle status="managed,managed_plus" />

Чтобы просматривать действия, выполняемые пользователями в вашей организации, dbt предоставляет журналы аудита пользовательских и системных событий в режиме реального времени. Журнал аудита обновляется по мере возникновения событий и включает такие сведения, как кто выполнил действие, какое именно действие было выполнено и когда это произошло. Эти данные можно использовать для диагностики проблем с доступом, проведения проверок безопасности или анализа конкретных событий.

Вы должны быть **Администратором аккаунта** или **Просмотрщиком аккаунта**, чтобы получить доступ к журналу аудита, и эта функция доступна только в планах Enterprise.

Аудит‑лог <Constant name="cloud" /> хранит все события, произошедшие в вашей организации, в режиме реального времени, включая:

- Для событий за последние 90 дней аудит‑лог <Constant name="cloud" /> предоставляет выбираемый диапазон дат, в котором отображаются инициированные события.
- Для событий старше 90 дней **Account Admins** и **Account Viewers** могут [экспортировать все события](#exporting-logs), используя **Export All**.

Обратите внимание, что период хранения событий в аудит‑логе составляет не менее 12 месяцев.

## Доступ к аудит‑логу

Чтобы получить доступ к аудит‑логу, нажмите на имя вашей учетной записи в левом меню и выберите **Account settings**. Затем нажмите **Audit log** в левой боковой панели.

## Понимание журнала аудита

На странице журнала аудита вы увидите список различных событий и связанных с ними данных о событиях. Каждое из этих событий показывает следующую информацию в dbt:

* **Название события**: Действие, которое было вызвано
* **Агент**: Пользователь, который вызвал это действие/событие
* **Временная метка**: Локальная временная метка, когда произошло событие

### Детали события

Нажмите на карточку события, чтобы увидеть детали о деятельности, которая вызвала событие. Этот вид предоставляет важные детали, включая когда это произошло и какой тип события был вызван. Например, если кто-то изменяет настройки для задания, вы можете использовать детали события, чтобы увидеть, какое задание было изменено (тип события: `job_definition.Changed`), кем (человек, который вызвал событие: `actor`), и когда (время, когда оно было вызвано: `created_at_utc`). Для типов событий и их описаний смотрите [События в журнале аудита](#audit-log-events).

Детали события предоставляют ключевые факторы события:

| Name                 | Description                                   |
| -------------------- | --------------------------------------------- |
| account_id           | ID аккаунта, в котором произошло событие      |
| actor                | Субъект, выполнивший действие — пользователь или сервис |
| actor_id             | Уникальный ID субъекта                        |
| actor_ip             | IP-адрес субъекта                             |
| actor_name           | Идентифицирующее имя субъекта                 |
| actor_type           | Указывает, было ли действие выполнено пользователем или API‑запросом |
| created_at           | Временная метка (UTC), когда произошло событие |
| event_type           | Уникальный ключ, идентифицирующий событие     |
| event_context        | Этот ключ будет различаться для каждого события и будет соответствовать `event_type`. Эти данные включают все детали об объекте или объектах, которые были изменены. |
| id                   | Уникальный ID события                         |
| service              | Сервис, который выполнил действие             |
| source               | Источник события — <Constant name="cloud" /> UI или API |

## События в журнале аудита

Журнал аудита поддерживает различные события для разных объектов в <Constant name="cloud" />. Здесь вы найдёте события, связанные с аутентификацией, окружениями, заданиями, сервисными токенами, группами, пользователями, проектами, правами доступа, лицензиями, подключениями, репозиториями и учётными данными.

### Аутентификация

| Event Name                 | Event Type                     | Description                                                     |
| -------------------------- | ------------------------------ | --------------------------------------------------------------- |
| Auth Provider Changed      | auth_provider.changed          | Изменены настройки провайдера аутентификации                    |
| Credential Login Succeeded | login.password.succeeded       | Пользователь успешно вошёл в систему с именем пользователя и паролем |
| SSO Login Failed           | login.sso.failed               | Попытка входа пользователя через SSO завершилась неудачей       |
| SSO Login Succeeded        | login.sso.succeeded            | Пользователь успешно вошёл в систему через SSO                  |

### Окружение

| Название события        | Тип события          | Описание                                      |
| ----------------------- | -------------------- | --------------------------------------------- |
| Environment Added       | environment.added    | Новая среда успешно создана                   |
| Environment Changed     | environment.changed  | Настройки среды были изменены                 |
| Environment Removed     | environment.removed  | Среда успешно удалена                         |

### Задания

| Название события | Тип события              | Описание                              |
| ---------------- | ------------------------ | ------------------------------------- |
| Job Added        | job_definition.added     | Новый Job успешно создан              |
| Job Changed      | job_definition.changed   | Настройки Job были изменены           |
| Job Removed      | job_definition.removed   | Определение Job было удалено          |

### Сервисный токен

| Event Name            | Event Type            | Description                                   |
| --------------------- | --------------------- | --------------------------------------------- |
| Service Token Created | service_token.created | Новый Service Token был успешно создан        |
| Service Token Revoked | service_token.revoked | Service Token был отозван                     |

### Группа

| Event Name    | Event Type    | Description                              |
| ------------- | ------------- | ---------------------------------------- |
| Group Added   | group.added   | Новая группа успешно создана             |
| Group Changed | group.changed | Настройки группы изменены                |
| Group Removed | group.removed | Группа успешно удалена                   |

### Пользователь

| Event Name                   | Event Type                | Description                                                                 |
| ---------------------------- | ------------------------- | --------------------------------------------------------------------------- |
| Invite Added                 | user.invite.added         | Приглашение пользователя было добавлено и отправлено пользователю           |
| Invite Redeemed              | user.invite.redeemed      | Пользователь принял (активировал) приглашение                               |
| User Added to Account        | user.added                | Новый пользователь был добавлен в аккаунт                                   |
| User Added to Group          | group.user.added          | Существующий пользователь был добавлен в группу                             |
| User Removed from Account    | user.removed              | Пользователь был удалён из аккаунта                                         |
| User Removed from Group      | group.user.removed        | Существующий пользователь был удалён из группы                              |
| User License Created         | user_license.added        | Была использована новая пользовательская лицензия                           |
| User License Removed         | user_license.removed      | Пользовательская лицензия была освобождена (удалена из общего количества)   |
| Verification Email Confirmed | user.jit.email.confirmed  | Пользователь подтвердил адрес электронной почты                             |
| Verification Email Sent      | user.jit.email.sent       | Письмо для подтверждения email было отправлено пользователю, созданному через JIT |

### Проект

| Event Name      | Event Type      | Description                      |
| --------------- | --------------- | -------------------------------- |
| Project Added   | project.added   | Добавлен новый проект            |
| Project Changed | project.changed | Изменены настройки проекта       |
| Project Removed | project.removed | Проект был удалён                |

### Разрешения

| Event Name              | Event Type         | Description                          |
| ----------------------- | ------------------ | ------------------------------------ |
| User Permission Added   | permission.added   | Добавлены новые права пользователя   |
| User Permission Removed | permission.removed | Права пользователя были удалены      |

### Лицензия

| Event Name              | Event Type           | Description                                               |
| ----------------------- | -------------------- | --------------------------------------------------------- |
| License Mapping Added   | license\_map.added   | Добавлено новое сопоставление лицензии пользователю       |
| License Mapping Changed | license\_map.changed | Изменены настройки сопоставления лицензии пользователю    |
| License Mapping Removed | license\_map.removed | Сопоставление лицензии пользователю удалено               |

### Соединение

| Название события        | Тип события         | Описание                                             |
| ----------------------- | ------------------- | ---------------------------------------------------- |
| Connection Added        | connection.added    | Добавлено новое подключение к Data Warehouse         |
| Connection Changed      | connection.changed  | Изменены настройки подключения к Data Warehouse      |
| Connection Removed      | connection.removed  | Подключение к Data Warehouse удалено                 |

### Репозиторий

| Название события       | Тип события         | Описание                             |
| ---------------------- | ------------------- | ------------------------------------ |
| Repository Added       | repository.added    | Добавлен новый репозиторий           |
| Repository Changed     | repository.changed  | Изменены настройки репозитория       |
| Repository Removed     | repository.removed  | Репозиторий удалён                   |

### Учетные данные

| Event Name                                   | Event Type          | Description                                   |
| -------------------------------------------- | ------------------- | --------------------------------------------- |
| Учетные данные добавлены в проект            | credentials.added   | Учетные данные добавлены в проект             |
| Учетные данные изменены в проекте            | credentials.changed | Учетные данные изменены в проекте             |
| Учетные данные удалены из проекта            | credentials.removed | Учетные данные удалены из проекта             |

### Интеграция с Git

| Название события                       | Тип события                    | Описание            |
| -------------------------------------- | ----------------------------- | ------------------- |
| Изменена конфигурация GitLab           | gitlab_application.changed    | Изменена конфигурация GitLab в dbt Cloud |

| Event Name                       | Event Type                    | Description                                           |
| -------------------------------- | ----------------------------- | ----------------------------------------------------- |
| GitLab Application Changed        | gitlab_application.changed    | Конфигурация GitLab в <Constant name="cloud" /> изменилась |

| Название события                       | Тип события                    | Описание            |
| -------------------------------------- | ----------------------------- | ------------------- |
| Добавлены подписки на вебхуки          | webhook_subscription.added    | Новый вебхук настроен в настройках |
| Изменены подписки на вебхуки           | webhook_subscription.changed  | Изменена существующая конфигурация вебхука |
| Удалены подписки на вебхуки            | webhook_subscription.removed  | Существующий вебхук удален |

| Название события                 | Тип события                   | Описание                                 |
| -------------------------------- | ----------------------------- | ---------------------------------------- |
| Webhook Subscriptions Added      | webhook_subscription.added    | Новый вебхук настроен в настройках       |
| Webhook Subscriptions Changed    | webhook_subscription.changed  | Изменена конфигурация существующего вебхука |
| Webhook Subscriptions Removed    | webhook_subscription.removed  | Существующий вебхук удалён               |

| Название события                       | Тип события                    | Описание            |
| -------------------------------------- | ----------------------------- | ------------------- |
| Добавлена конфигурация семантического слоя | semantic_layer_config.added   | Добавлена конфигурация семантического слоя |
| Изменена конфигурация семантического слоя | semantic_layer_config.changed  | Изменена конфигурация семантического слоя (не связанная с учетными данными) |
| Удалена конфигурация семантического слоя | semantic_layer_config.removed   | Удалена конфигурация семантического слоя |
| Добавлены учетные данные семантического слоя | semantic_layer_credentials.added   | Добавлены учетные данные семантического слоя |
| Изменены учетные данные семантического слоя | semantic_layer_credentials.changed   | Изменены учетные данные семантического слоя. Не вызывает semantic_layer_config.changed |
| Удалены учетные данные семантического слоя | semantic_layer_credentials.removed   | Удалены учетные данные семантического слоя |

### Расширенные атрибуты

| Название события                  | Тип события                    | Описание                                                                 |
| -------------------------------- | ----------------------------- | ------------------------------------------------------------------------ |
| Semantic Layer Config Added      | semantic_layer_config.added   | Добавлена конфигурация <Constant name="semantic_layer" />                 |
| Semantic Layer Config Changed    | semantic_layer_config.changed | Изменена конфигурация <Constant name="semantic_layer" /> (не связанная с учётными данными) |
| Semantic Layer Config Removed    | semantic_layer_config.removed | Конфигурация <Constant name="semantic_layer" /> удалена                  |
| Semantic Layer Credentials Added | semantic_layer_credentials.added | Добавлены учётные данные <Constant name="semantic_layer" />              |
| Semantic Layer Credentials Changed | semantic_layer_credentials.changed | Изменены учётные данные <Constant name="semantic_layer" />. Не вызывает событие semantic_layer_config.changed |
| Semantic Layer Credentials Removed | semantic_layer_credentials.removed | Учётные данные <Constant name="semantic_layer" /> удалены                |

### Персональный токен доступа с областью аккаунта

| Event Name                                   | Event Type                  | Description                                           |
| -------------------------------------------- | --------------------------- | ----------------------------------------------------- |
| Extended Attribute Added                     | extended_attributes.added   | Расширенный атрибут добавлен в проект                 |
| Extended Attribute Changed                   | extended_attributes.changed | Расширенный атрибут изменён или удалён                |

### Ограничения по IP

| Название события                       | Тип события                    | Описание            |
| -------------------------------------- | ----------------------------- | ------------------- |
| Переключены ограничения по IP          | ip_restrictions.toggled       | Функция ограничений по IP включена или отключена |
| Добавлено правило ограничения по IP    | ip_restrictions.rule.added    | Создано правило ограничения по IP |
| Изменено правило ограничения по IP     | ip_restrictions.rule.changed   | Отредактировано правило ограничения по IP |
| Удалено правило ограничения по IP      | ip_restrictions.rule.removed   | Удалено правило ограничения по IP |

| Event Name                                   | Event Type                 | Описание                                   |
| -------------------------------------------- | -------------------------- | ------------------------------------------- |
| Account Scoped Personal Access Token Created | account_scoped_pat.created | Был создан account-scoped PAT               |
| Account Scoped Personal Access Token Deleted | account_scoped_pat.deleted | Был удалён account-scoped PAT               |

Вы можете искать в журнале аудита, чтобы найти конкретное событие или актера, что ограничено теми, которые перечислены в [События в журнале аудита](#events-in-audit-log). Журнал аудита успешно перечисляет исторические события за последние 90 дней. Вы можете искать актера или событие, используя строку поиска, а затем сузить результаты, используя временное окно.

| Event Name                   | Event Type                   | Description                                      |
| ---------------------------- | ---------------------------- | ------------------------------------------------ |
| IP Restrictions Toggled      | ip_restrictions.toggled      | Функция IP‑ограничений была включена или отключена |
| IP Restrictions Rule Added   | ip_restrictions.rule.added   | Правило IP‑ограничений было создано              |
| IP Restrictions Rule Changed | ip_restrictions.rule.changed | Правило IP‑ограничений было отредактировано      |
| IP Restrictions Rule Removed | ip_restrictions.rule.removed | Правило IP‑ограничений было удалено               |

### SCIM

| Event Name        | Event Type                        | Description                                         |
| ----------------- | --------------------------------- | --------------------------------------------------- |
| User Creation     | v1.events.account.UserAdded       | Новый пользователь был создан службой SCIM          |
| User Update       | v1.events.account.UserUpdated     | Запись пользователя была обновлена службой SCIM     |
| User Removal      | v1.events.account.UserRemoved     | Пользователь был удалён службой SCIM                |
| Group Creation    | v1.events.user_group.Added        | Новая группа была создана службой SCIM              |
| Group Update      | v1.events.user_group_user.Changed | Состав группы был обновлён службой SCIM             |
| Group Removal     | v1.events.user_group.Removed      | Группа была удалена службой SCIM                    |

- **Для событий в пределах 90 дней** &mdash; dbt Cloud автоматически отобразит выбираемый диапазон дат в 90 дней. Выберите **Экспортировать выбор**, чтобы скачать CSV-файл всех событий, произошедших в вашей организации в течение 90 дней.

- **Для событий старше 90 дней** &mdash; Выберите **Экспортировать все**. Администратор аккаунта или Просмотрщик аккаунта получит ссылку на электронную почту для скачивания CSV-файла всех событий, произошедших в вашей организации.

<Lightbox src="/img/docs/dbt-cloud/dbt-cloud-enterprise/audit-log-search.png" width="95%" title="Use search bar to find content in the audit log"/>

## Экспорт логов

Вы можете использовать audit log для экспорта всех исторических результатов аудита в целях безопасности, соответствия требованиям и аналитики. События в audit log хранятся не менее 12 месяцев.

- **Для событий за последние 90 дней** &mdash; <Constant name="cloud" /> автоматически отображает доступный для выбора диапазон дат в 90 дней. Нажмите **Export Selection**, чтобы скачать CSV-файл со всеми событиями, произошедшими в вашей организации за последние 90 дней.

- **Для событий старше 90 дней** &mdash; выберите **Export All**. Account Admin или Account Viewer получит письмо с ссылкой для скачивания CSV-файла со всеми событиями, произошедшими в вашей организации.

<Lightbox src="/img/docs/dbt-cloud/dbt-cloud-enterprise/audit-log-section.png" width="95%" title="View audit log export options"/>
