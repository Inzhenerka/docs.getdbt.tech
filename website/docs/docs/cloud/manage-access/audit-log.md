---
title: "Журнал аудита для dbt Cloud Enterprise"
id: audit-log
description: "Вы можете устранять возможные проблемы и проводить аудиты безопасности, просматривая активность событий в вашей организации."
sidebar_label: "Журнал аудита"
pagination_next: null
pagination_prev: "docs/cloud/manage-access/about-user-access"
---

Чтобы просмотреть действия, выполненные людьми в вашей организации, dbt предоставляет журналы аудируемых пользовательских и системных событий в реальном времени. Журнал аудита отображается по мере возникновения событий и включает такие детали, как кто выполнил действие, что это было за действие и когда оно было выполнено. Вы можете использовать эти детали для устранения проблем с доступом, проведения аудитов безопасности или анализа конкретных событий.

Вы должны быть **Администратором аккаунта** или **Просмотрщиком аккаунта**, чтобы получить доступ к журналу аудита, и эта функция доступна только на корпоративных планах.

Журнал аудита dbt Cloud хранит все события, произошедшие в вашей организации в реальном времени, включая:

- Для событий в пределах 90 дней журнал аудита dbt Cloud имеет выбираемый диапазон дат, который перечисляет вызванные события.
- Для событий, превышающих 90 дней, **Администраторы аккаунта** и **Просмотрщики аккаунта** могут [экспортировать все события](#exporting-logs), используя **Экспорт всех**.

## Доступ к журналу аудита

Чтобы получить доступ к журналу аудита, нажмите на имя вашего аккаунта в левом боковом меню и выберите **Настройки аккаунта**.

<Lightbox src="/img/docs/dbt-cloud/dbt-cloud-enterprise/audit-log-menu.png" width="30%" title="Меню журнала аудита"/>

## Понимание журнала аудита

На странице журнала аудита вы увидите список различных событий и связанных с ними данных. Каждое из этих событий показывает следующую информацию в dbt:

* **Название события**: Действие, которое было вызвано
* **Агент**: Пользователь, который вызвал это действие/событие
* **Метка времени**: Локальная метка времени, когда событие произошло

### Подробности события

Нажмите на карточку события, чтобы увидеть детали активности, вызвавшей событие. Этот вид предоставляет важные детали, включая, когда это произошло и какой тип события был вызван. Например, если кто-то изменяет настройки задания, вы можете использовать детали события, чтобы увидеть, какое задание было изменено (тип события: `job_definition.Changed`), кем (человек, вызвавший событие: `actor`), и когда (время, когда оно было вызвано: `created_at_utc`). Для типов событий и их описаний смотрите [События в журнале аудита](#audit-log-events).

Подробности события предоставляют ключевые факторы события:

| Название              | Описание                                   |
| --------------------- | ------------------------------------------ |
| account_id            | Идентификатор аккаунта, в котором произошло событие |
| actor                 | Актор, который выполнил событие - Пользователь или Сервис |
| actor_id              | Уникальный идентификатор актера           |
| actor_ip              | IP-адрес актера                           |
| actor_name            | Идентифицирующее имя актера               |
| actor_type            | Выполнено ли действие пользователем или запросом API |
| created_at            | UTC-метка времени, когда событие произошло |
| event_type            | Уникальный ключ, идентифицирующий событие |
| event_context         | Этот ключ будет отличаться для каждого события и будет соответствовать event_type. Эти данные будут включать все детали об объекте(ах), которые были изменены. |
| id                    | Уникальный идентификатор события           |
| service               | Сервис, который выполнил действие         |
| source                | Источник события - интерфейс dbt Cloud или API |

## События журнала аудита

Журнал аудита поддерживает различные события для различных объектов в dbt Cloud. Вы найдете события для аутентификации, окружения, заданий, токенов сервисов, групп, пользователей, проектов, разрешений, лицензий, соединений, репозиториев и учетных данных.

### Аутентификация

| Название события                 | Тип события                               | Описание                                            |
| -------------------------------- | ----------------------------------------- | --------------------------------------------------- |
| Изменение провайдера аутентификации | auth_provider.Changed          | Изменены настройки провайдера аутентификации       |
| Успешный вход с учетными данными  | auth.CredentialsLoginSucceeded | Пользователь успешно вошел с именем пользователя и паролем |
| Ошибка входа через SSO           | auth.SsoLoginFailed            | Вход пользователя через SSO не удался               |
| Успешный вход через SSO          | auth.SsoLoginSucceeded         | Пользователь успешно вошел через SSO                 |

### Окружение

| Название события          | Тип события                    | Описание                          |
| ------------------------- | ----------------------------- | --------------------------------- |
| Окружение добавлено       | environment.Added   | Новое окружение успешно создано   |
| Окружение изменено       | environment.Changed | Изменены настройки окружения      |
| Окружение удалено        | environment.Removed | Окружение успешно удалено         |

### Задания

| Название события  | Тип события                        | Описание                  |
| ----------------- | --------------------------------- | ------------------------- |
| Задание добавлено  | job_definition.Added   | Новое задание успешно создано |
| Задание изменено   | job_definition.Changed | Изменены настройки задания  |
| Задание удалено    | job_definition.Removed | Определение задания удалено  |

### Токен сервиса

| Название события            | Тип события                       | Описание                                |
| --------------------------- | -------------------------------- | ---------------------------------------- |
| Токен сервиса создан        | service_token.Created | Новый токен сервиса успешно создан      |
| Токен сервиса отозван      | service_token.Revoked | Токен сервиса был отозван              |

### Группа

| Название события    | Тип события                    | Описание                    |
| ------------------- | ----------------------------- | --------------------------- |
| Группа добавлена    | user_group.Added   | Новая группа успешно создана |
| Группа изменена     | user_group.Changed | Изменены настройки группы    |
| Группа удалена      | user_group.Removed | Группа успешно удалена       |

### Пользователь

| Название события                   | Тип события                          | Описание                                     |
| ---------------------------------- | ----------------------------------- | -------------------------------------------- |
| Приглашение добавлено              | invite.Added              | Приглашение пользователя добавлено и отправлено пользователю |
| Приглашение использовано            | invite.Redeemed           | Пользователь использовал приглашение         |
| Пользователь добавлен в аккаунт     | account.UserAdded         | Новый пользователь добавлен в аккаунт        |
| Пользователь добавлен в группу       | user_group_user.Added     | Существующий пользователь добавлен в группу   |
| Пользователь удален из аккаунта     | account.UserRemoved       | Пользователь удален из аккаунта               |
| Пользователь удален из группы       | user_group_user.Removed   | Существующий пользователь удален из группы    |
| Подтвержден адрес электронной почты | user.jit.email.Confirmed  | Подтверждение адреса электронной почты пользователем |
| Отправлено письмо для подтверждения | user.jit.email.Sent       | Письмо для подтверждения адреса электронной почты отправлено пользователю, созданному через JIT |

### Проект

| Название события      | Тип события                | Описание              |
| --------------------- | ------------------------- | --------------------- |
| Проект добавлен       | project.Added   | Новый проект добавлен  |
| Проект изменен        | project.Changed | Изменены настройки проекта |
| Проект удален         | project.Removed | Проект удален         |

### Разрешения

| Название события              | Тип события                   | Описание                    |
| ----------------------------- | ---------------------------- | --------------------------- |
| Разрешение пользователя добавлено | permission.Added   | Новые разрешения пользователя добавлены |
| Разрешение пользователя удалено | permission.Removed | Разрешения пользователя удалены |

### Лицензия

| Название события              | Тип события                     | Описание                               |
| ----------------------------- | ------------------------------ | -------------------------------------- |
| Добавлено сопоставление лицензий | license_map.Added   | Новое сопоставление лицензий пользователя добавлено |
| Изменено сопоставление лицензий | license_map.Changed | Изменены настройки сопоставления лицензий пользователя |
| Удалено сопоставление лицензий | license_map.Removed | Сопоставление лицензий пользователя удалено |

### Соединение

| Название события         | Тип события                   | Описание                                |
| ------------------------ | ---------------------------- | ---------------------------------------- |
| Соединение добавлено     | connection.Added   | Новое соединение с хранилищем данных добавлено |
| Соединение изменено      | connection.Changed | Изменены настройки соединения с хранилищем данных |
| Соединение удалено       | connection.Removed | Соединение с хранилищем данных удалено  |

### Репозиторий

| Название события         | Тип события                   | Описание                 |
| ------------------------ | ---------------------------- | ------------------------ |
| Репозиторий добавлен     | repository.Added   | Новый репозиторий добавлен |
| Репозиторий изменен      | repository.Changed | Изменены настройки репозитория |
| Репозиторий удален       | repository.Removed | Репозиторий удален      |

### Учетные данные

| Название события                       | Тип события                    | Описание            |
| -------------------------------------- | ----------------------------- | ------------------- |
| Учетные данные добавлены в проект     | credentials.Added   | Учетные данные проекта добавлены |
| Учетные данные изменены в проект      | credentials.Changed | Учетные данные изменены в проекте |
| Учетные данные удалены из проекта      | credentials.Removed | Учетные данные удалены из проекта |

### Интеграция с Git

| Название события                       | Тип события                    | Описание            |
| -------------------------------------- | ----------------------------- | ------------------- |
| Изменение приложения GitLab            | gitlab_application.changed    | Изменение конфигурации GitLab в dbt Cloud |

### Вебхуки

| Название события                       | Тип события                    | Описание            |
| -------------------------------------- | ----------------------------- | ------------------- |
| Добавлены подписки на вебхуки         | webhook_subscription.added    | Новый вебхук настроен в настройках |
| Изменены подписки на вебхуки          | webhook_subscription.changed  | Изменена конфигурация существующего вебхука |
| Удалены подписки на вебхуки           | webhook_subscription.removed  | Существующий вебхук удален |

### Семантический слой

| Название события                       | Тип события                    | Описание            |
| -------------------------------------- | ----------------------------- | ------------------- |
| Добавлена конфигурация семантического слоя | semantic_layer_config.added   | Конфигурация семантического слоя добавлена |
| Изменена конфигурация семантического слоя | semantic_layer_config.changed  | Изменена конфигурация семантического слоя (не связанная с учетными данными) |
| Удалена конфигурация семантического слоя | semantic_layer_config.removed   | Конфигурация семантического слоя удалена |
| Добавлены учетные данные семантического слоя | semantic_layer_credentials.added   | Учетные данные семантического слоя добавлены |
| Изменены учетные данные семантического слоя | semantic_layer_credentials.changed   | Учетные данные семантического слоя изменены. Не вызывает semantic_layer_config.changed |
| Удалены учетные данные семантического слоя | semantic_layer_credentials.removed   | Учетные данные семантического слоя удалены |

### Расширенные атрибуты

| Название события                       | Тип события                    | Описание            |
| -------------------------------------- | ----------------------------- | ------------------- |
| Добавлен расширенный атрибут          | extended_attributes.added     | Расширенный атрибут добавлен в проект |
| Изменен расширенный атрибут           | extended_attributes.changed   | Расширенный атрибут изменен или удален |

### Личный токен доступа, ограниченный аккаунтом

| Название события                       | Тип события                    | Описание            |
| -------------------------------------- | ----------------------------- | ------------------- |
| Создан личный токен доступа, ограниченный аккаунтом | account_scoped_pat.created | Личный токен доступа, ограниченный аккаунтом, был создан |
| Удален личный токен доступа, ограниченный аккаунтом | account_scoped_pat.deleted | Личный токен доступа, ограниченный аккаунтом, был удален |

### Ограничения IP

| Название события                       | Тип события                    | Описание            |
| -------------------------------------- | ----------------------------- | ------------------- |
| Переключение ограничений IP            | ip_restrictions.toggled       | Функция ограничений IP включена или отключена |
| Добавлено правило ограничений IP       | ip_restrictions.rule.added    | Правило ограничения IP создано |
| Изменено правило ограничений IP        | ip_restrictions.rule.changed   | Правило ограничения IP изменено |
| Удалено правило ограничений IP         | ip_restrictions.rule.removed   | Правило ограничения IP удалено |

## Поиск в журнале аудита

Вы можете искать в журнале аудита, чтобы найти конкретное событие или актера, что ограничивается теми, которые перечислены в [События в журнале аудита](#events-in-audit-log). Журнал аудита успешно перечисляет исторические события за последние 90 дней. Вы можете искать актера или событие, используя строку поиска, а затем уточнить результаты, используя временной диапазон.

<Lightbox src="/img/docs/dbt-cloud/dbt-cloud-enterprise/audit-log-search.png" width="95%" title="Используйте строку поиска, чтобы найти содержимое в журнале аудита"/>

## Экспорт журналов

Вы можете использовать журнал аудита для экспорта всех исторических результатов аудита для целей безопасности, соблюдения норм и анализа:

- **Для событий в пределах 90 дней** &mdash; dbt Cloud автоматически отобразит выбираемый диапазон дат на 90 дней. Выберите **Экспорт выбора**, чтобы скачать CSV-файл всех событий, произошедших в вашей организации в течение 90 дней.

- **Для событий, превышающих 90 дней** &mdash; выберите **Экспорт всех**. Администратор аккаунта или просмотрщик аккаунта получит электронное письмо со ссылкой для скачивания CSV-файла всех событий, произошедших в вашей организации.

<Lightbox src="/img/docs/dbt-cloud/dbt-cloud-enterprise/audit-log-section.jpg" width="95%" title="Просмотр параметров экспорта журнала аудита"/>