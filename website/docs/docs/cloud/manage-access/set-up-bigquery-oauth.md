---
title: "Настройка BigQuery OAuth"
description: "Узнайте, как администраторы dbt Cloud могут использовать BigQuery OAuth для управления доступом в учетной записи dbt Cloud"
id: "set-up-bigquery-oauth"
pagination_next: null
---

:::info Функция для предприятий

Этот гид описывает функцию плана dbt Cloud Enterprise. Если вы хотите узнать больше о плане Enterprise, свяжитесь с нами по адресу sales@getdbt.com.

:::


dbt Cloud поддерживает разработку [OAuth](https://cloud.google.com/bigquery/docs/authentication) с BigQuery, предоставляя дополнительный уровень безопасности для пользователей dbt Enterprise. Когда BigQuery OAuth включен для проекта dbt Cloud, все разработчики dbt Cloud должны пройти аутентификацию в BigQuery, чтобы использовать IDE dbt Cloud. Среды развертывания проекта по-прежнему будут использовать ключ службы учетной записи BigQuery, установленный в учетных данных проекта.


Чтобы настроить BigQuery OAuth в dbt Cloud, администратору BigQuery необходимо:
1. [Найти значение URI перенаправления](#locate-the-redirect-uri-value) в dbt Cloud.
2. [Создать идентификатор клиента и секрет OAuth 2.0 для BigQuery](#creating-a-bigquery-oauth-20-client-id-and-secret) в BigQuery.
3. [Настроить соединение](#configure-the-connection-in-dbt-cloud) в dbt Cloud.

Чтобы использовать BigQuery в IDE dbt Cloud, всем разработчикам необходимо:
1. [Аутентифицироваться в BigQuery](#authenticating-to-bigquery) в своих учетных данных профиля.

### Найти значение URI перенаправления
Чтобы начать, найдите URI перенаправления соединения для настройки BigQuery OAuth. Для этого:
 - Перейдите к имени вашей учетной записи, расположенной над значком профиля на левой боковой панели  
 - Выберите **Настройки учетной записи** в меню 
 - В левой боковой панели выберите **Проекты** 
 - Выберите проект из списка
 - Выберите **Соединение**, чтобы отредактировать детали соединения
 - Найдите поле **URI перенаправления** в разделе **Настройки OAuth 2.0**. Скопируйте это значение в буфер обмена для дальнейшего использования.

<Lightbox src="/img/docs/dbt-cloud/using-dbt-cloud/dbt-cloud-enterprise/BQ-auth/dbt-cloud-bq-id-secret-02.png" title="Доступ к настройкам BigQuery OAuth в dbt Cloud" />

### Создание идентификатора клиента и секрета OAuth 2.0 для BigQuery
Чтобы начать, вам необходимо создать идентификатор клиента и секрет для [аутентификации](https://cloud.google.com/bigquery/docs/authentication) с BigQuery. Этот идентификатор клиента и секрет будут храниться в dbt Cloud для управления соединением OAuth между пользователями dbt Cloud и BigQuery.

В консоли BigQuery перейдите в **APIs & Services** и выберите **Credentials**:

<Lightbox src="/img/docs/dbt-cloud/using-dbt-cloud/dbt-cloud-enterprise/BQ-auth/BQ-nav.gif" title="Навигация BigQuery к учетным данным" />

На странице **Credentials** вы можете увидеть свои существующие ключи, идентификаторы клиентов и учетные записи служб.

Настройте [экран согласия OAuth](https://support.google.com/cloud/answer/6158849), если вы еще этого не сделали. Затем нажмите **+ Создать учетные данные** в верхней части страницы и выберите **Идентификатор клиента OAuth**.

Заполните конфигурацию идентификатора клиента. **Авторизованные JavaScript источники** не применимы. Добавьте элемент в **Авторизованные URI перенаправления** и замените `REDIRECT_URI` на значение, которое вы ранее скопировали из раздела **Настройки OAuth 2.0** соединения в dbt Cloud:

| Конфигурация                | Значение         |
| ---------------------------- | ---------------- |
| **Тип приложения**           | Веб-приложение   |
| **Имя**                     | dbt Cloud        |
| **Авторизованные URI перенаправления** | `REDIRECT_URI`  |

Затем нажмите **Создать**, чтобы создать приложение OAuth для BigQuery и увидеть значения идентификатора клиента и секрета приложения. Эти значения доступны даже если вы закроете экран приложения, так что это не единственный шанс их сохранить.

<Lightbox src="/img/docs/dbt-cloud/using-dbt-cloud/dbt-cloud-enterprise/BQ-auth/bq-oauth-app-02.png" title="Создание приложения OAuth в BigQuery" />

### Настройка соединения в dbt Cloud
Теперь, когда у вас есть приложение OAuth, настроенное в BigQuery, вам нужно добавить идентификатор клиента и секрет в dbt Cloud. Для этого:
 - Вернитесь на страницу деталей соединения, как описано в [Найти значение URI перенаправления](#locate-the-redirect-uri-value)
 - Добавьте идентификатор клиента и секрет из приложения OAuth BigQuery в разделе **Настройки OAuth 2.0**

### Аутентификация в BigQuery
После настройки приложения OAuth BigQuery для проекта dbt Cloud каждый пользователь dbt Cloud должен пройти аутентификацию в BigQuery, чтобы использовать IDE. Для этого:

- Перейдите к имени вашей учетной записи, расположенной над значком профиля на левой боковой панели
- Выберите **Настройки учетной записи** в меню
- В левой боковой панели выберите **Учетные данные**
- Выберите проект из списка
- Выберите **Аутентифицировать учетную запись BigQuery**

<Lightbox src="/img/docs/dbt-cloud/using-dbt-cloud/dbt-cloud-enterprise/developer-bq-auth.gif" title="Аутентификация в BigQuery" />

Затем вы будете перенаправлены в BigQuery и попросят одобрить доступ к диску, облачной платформе и областям BigQuery, если соединение не имеет ограниченных прав.
<Lightbox src="/img/docs/dbt-cloud/using-dbt-cloud/dbt-cloud-enterprise/BQ-auth/BQ-access.png" title="Запрос доступа к BigQuery" />

Выберите **Разрешить**. Это перенаправит вас обратно в dbt Cloud. Теперь вы должны быть аутентифицированным пользователем BigQuery, готовым использовать IDE dbt Cloud.

## Часто задаваемые вопросы

<FAQ path="Warehouse/bq-oauth-drive-scope" />