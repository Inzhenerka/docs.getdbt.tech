---
title: "Google Sheets"
description: "Интеграция с Google Sheets для запроса ваших метрик в таблице."
tags: [Semantic Layer]
sidebar_label: "Google Sheets"
---

Слой семантики dbt предлагает бесшовную интеграцию с Google Sheets через пользовательское меню. Этот аддон позволяет вам строить запросы к слою семантики dbt и возвращать данные о ваших метриках непосредственно в Google Sheets.

## Предварительные требования

- Вы [настроили слой семантики dbt](/docs/use-dbt-semantic-layer/setup-sl) и используете dbt версии 1.6 или выше.
- У вас есть учетная запись Google с доступом к Google Sheets и возможностью устанавливать аддоны Google.
- У вас есть [ID окружения dbt Cloud](/docs/use-dbt-semantic-layer/setup-sl#set-up-dbt-semantic-layer) и [токен сервиса](/docs/dbt-cloud-apis/service-tokens) для аутентификации из учетной записи dbt Cloud.
- У вас должна быть учетная запись dbt Cloud Team или Enterprise [аккаунт](https://www.getdbt.com/pricing). Подходит как для многопользовательского, так и для однопользовательского развертывания.
  - Учетные записи с однопользовательским доступом должны связаться со своим представителем для необходимой настройки и активации.

Если вы используете [ограничения IP](/docs/cloud/secure/ip-restrictions), убедитесь, что вы добавили [IP-адреса Google](https://www.gstatic.com/ipranges/goog.txt) в свой список разрешенных IP. В противном случае соединение с Google Sheets не будет успешным.

import SLCourses from '/snippets/_sl-course.md';

<SLCourses/>

## Установка аддона

1. Перейдите в [dbt Semantic Layer for Sheets App](https://gsuite.google.com/marketplace/app/foo/392263010968) для установки аддона. Вы также можете найти его в Google Sheets, перейдя в [**Расширения -> Аддоны -> Получить аддоны**](https://support.google.com/docs/answer/2942256?hl=en&co=GENIE.Platform%3DDesktop&oco=0#zippy=%2Cinstall-add-ons%2Cinstall-an-add-on) и выполнив поиск там.
2. После установки откройте меню **Расширения** и выберите **dbt Semantic Layer for Sheets**. Это откроет пользовательское меню с правой стороны вашего экрана.
3. [Найдите ваш](/docs/use-dbt-semantic-layer/setup-sl#set-up-dbt-semantic-layer) **Host** и **Environment ID** в dbt Cloud.
   - Перейдите в **Настройки учетной записи** и выберите **Проекты** в левой боковой панели.
   - Выберите ваш проект, а затем перейдите в настройки **Слоя семантики**. Вам это нужно для аутентификации в Google Sheets на следующем шаге.
   - Вы можете [сгенерировать свой токен сервиса](/docs/dbt-cloud-apis/service-tokens), нажав **Сгенерировать токен сервиса** на странице конфигурации Слоя семантики или перейдя в **API токены** в dbt Cloud.
4. В Google Sheets выполните аутентификацию с вашим хостом, ID окружения dbt Cloud и токеном сервиса.
   <Lightbox src="/img/docs/dbt-cloud/semantic-layer/sl-and-gsheets.jpg" width="70%" title="Получите доступ к вашему ID окружения, хосту и URL в настройках слоя семантики dbt Cloud. Сгенерируйте токен сервиса в настройках слоя семантики или настройках API токенов." />

5. Начните запрашивать ваши метрики, используя **Конструктор запросов**. Для получения дополнительной информации о функциях меню обратитесь к [функциям конструктора запросов](#query-builder-functions). Чтобы отменить запрос во время выполнения, нажмите кнопку "Отменить".

import Tools from '/snippets/_sl-excel-gsheets.md';

<Tools 
type="Google Sheets"
bullet_1="Операция пользовательского меню имеет ограничение по времени в шесть (6) минут."
bullet_2="Если вы используете этот аддон, убедитесь, что вы вошли в Chrome с тем же профилем Google, который вы использовали для настройки аддона. Входите с одним профилем Google за раз, так как использование нескольких профилей Google одновременно может вызвать проблемы."
queryBuilder="/img/docs/dbt-cloud/semantic-layer/query-builder.png"
PrivateSelections="Вы также можете сделать эти выборы приватными или публичными. Публичные выборы означают, что ваши вводимые данные доступны в меню для всех на листе. 
Приватные выборы означают, что ваши вводимые данные видны только вам. Обратите внимание, что любой, добавленный на лист, все равно сможет видеть данные из этих приватных выборов, но не сможет взаимодействовать с выбором в меню или воспользоваться автоматическим обновлением."
/>

**Раскрытие информации о политике ограниченного использования**

Использование слоя семантики dbt для Sheets и передача информации, полученной от Google API, в любое другое приложение будет соответствовать [Политике использования данных пользователей Google API Services](https://developers.google.com/terms/api-services-user-data-policy), включая требования ограниченного использования.

## Часто задаваемые вопросы
<FAQ path="Troubleshooting/sl-alpn-error" />