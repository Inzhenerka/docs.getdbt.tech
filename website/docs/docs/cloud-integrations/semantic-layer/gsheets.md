---
title: "Google Sheets"
description: "Интеграция с Google Sheets для запроса ваших метрик в электронной таблице."
tags: [Semantic Layer]
sidebar_label: "Google Sheets"
---

Семантический слой dbt предлагает бесшовную интеграцию с Google Sheets через пользовательское меню. Этот аддон позволяет создавать запросы к Семантическому слою dbt и возвращать данные по вашим метрикам непосредственно в Google Sheets.

## Предварительные требования

- Вы [настроили Семантический слой dbt](/docs/use-dbt-semantic-layer/setup-sl) и используете dbt версии 1.6 или выше.
- У вас есть учетная запись Google с доступом к Google Sheets и возможностью устанавливать дополнения Google.
- У вас есть [ID окружения dbt Cloud](/docs/use-dbt-semantic-layer/setup-sl#set-up-dbt-semantic-layer) и [токен сервиса](/docs/dbt-cloud-apis/service-tokens) для аутентификации из учетной записи dbt Cloud.
- У вас должна быть учетная запись dbt Cloud Team или Enterprise [account](https://www.getdbt.com/pricing). Подходит как для многопользовательского, так и для однопользовательского развертывания.
  - Владельцы однопользовательских учетных записей должны связаться с представителем своей учетной записи для необходимой настройки и активации.

Если вы используете [ограничения по IP](/docs/cloud/secure/ip-restrictions), убедитесь, что вы добавили [IP-адреса Google](https://www.gstatic.com/ipranges/goog.txt) в свой список разрешенных IP. В противном случае подключение к Google Sheets не удастся.

import SLCourses from '/snippets/_sl-course.md';

<SLCourses/>

## Установка дополнения

1. Перейдите к [приложению dbt Semantic Layer для Sheets](https://gsuite.google.com/marketplace/app/foo/392263010968), чтобы установить дополнение. Вы также можете найти его в Google Sheets, перейдя в [**Расширения -> Дополнения -> Получить дополнения**](https://support.google.com/docs/answer/2942256?hl=en&co=GENIE.Platform%3DDesktop&oco=0#zippy=%2Cinstall-add-ons%2Cinstall-an-add-on) и найдя его там.
2. После установки откройте меню **Расширения** и выберите **dbt Semantic Layer for Sheets**. Это откроет пользовательское меню на правой стороне вашего экрана.
3. [Найдите ваш](/docs/use-dbt-semantic-layer/setup-sl#set-up-dbt-semantic-layer) **Host** и **ID окружения** в dbt Cloud.
   - Перейдите в **Настройки учетной записи** и выберите **Проекты** на левой боковой панели.
   - Выберите ваш проект, а затем перейдите к настройкам **Семантического слоя**. Вам это понадобится для аутентификации в Google Sheets на следующем шаге.
   - Вы можете [создать ваш токен сервиса](/docs/dbt-cloud-apis/service-tokens), нажав **Создать токен сервиса** на странице конфигурации Семантического слоя или перейдя в **API токены** в dbt Cloud.
4. В Google Sheets выполните аутентификацию с вашим хостом, ID окружения dbt Cloud и токеном сервиса.
   <Lightbox src="/img/docs/dbt-cloud/semantic-layer/sl-and-gsheets.jpg" width="70%" title="Доступ к вашему ID окружения, хосту и URL в настройках Семантического слоя dbt Cloud. Создайте токен сервиса в настройках Семантического слоя или настройках API токенов" />

5. Начните запрашивать ваши метрики, используя **Конструктор запросов**. Для получения дополнительной информации о функциях меню обратитесь к [функциям Конструктора запросов](#query-builder-functions). Чтобы отменить запрос во время выполнения, нажмите кнопку "Отмена".

import Tools from '/snippets/_sl-excel-gsheets.md';

<Tools 
type="Google Sheets"
bullet_1="Операция пользовательского меню имеет ограничение по времени в шесть (6) минут."
bullet_2="Если вы используете это расширение, убедитесь, что вы вошли в Chrome с тем же профилем Google, который вы использовали для настройки дополнения. Входите с одним профилем Google за раз, так как использование нескольких профилей Google одновременно может вызвать проблемы."
queryBuilder="/img/docs/dbt-cloud/semantic-layer/query-builder.png"
PrivateSelections="Вы также можете сделать эти выборы приватными или публичными. Публичные выборы означают, что ваши вводимые данные доступны в меню всем на листе. 
Приватные выборы означают, что ваши вводимые данные видны только вам. Обратите внимание, что любой, добавленный на лист, все равно может видеть данные из этих приватных выборов, но они не смогут взаимодействовать с выбором в меню или получать выгоду от автоматического обновления."
/>

**Раскрытие политики ограниченного использования**

Использование и передача информации, полученной от Google API, Семантическим слоем dbt для Sheets будет соответствовать [Политике использования данных пользователей Google API Services](https://developers.google.com/terms/api-services-user-data-policy), включая требования ограниченного использования.

## Часто задаваемые вопросы
<FAQ path="Troubleshooting/sl-alpn-error" />