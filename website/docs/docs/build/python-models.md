---
title: "Python –º–æ–¥–µ–ª–∏"
id: "python-models"
---

–û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ, —á—Ç–æ —Ç–æ–ª—å–∫–æ [–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–µ –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã –¥–∞–Ω–Ω—ã—Ö](#specific-data-platforms) –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç –º–æ–¥–µ–ª–∏ dbt-py.

–ú—ã —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º –≤–∞–º:
- –ü—Ä–æ—á–∏—Ç–∞—Ç—å [–æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–µ –æ–±—Å—É–∂–¥–µ–Ω–∏–µ](https://github.com/dbt-labs/dbt-core/discussions/5261), –≤ –∫–æ—Ç–æ—Ä–æ–º –±—ã–ª–æ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–æ —ç—Ç–æ –Ω–æ–≤–æ–≤–≤–µ–¥–µ–Ω–∏–µ.
- –í–Ω–µ—Å—Ç–∏ —Å–≤–æ–π –≤–∫–ª–∞–¥ –≤ [–ª—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ Python –º–æ–¥–µ–ª–µ–π –≤ dbt](https://discourse.getdbt.com/t/dbt-python-model-dbt-py-best-practices/5204).
- –ü–æ–¥–µ–ª–∏—Ç—å—Å—è —Å–≤–æ–∏–º–∏ –º—ã—Å–ª—è–º–∏ –∏ –∏–¥–µ—è–º–∏ –æ [—Å–ª–µ–¥—É—é—â–∏—Ö —à–∞–≥–∞—Ö –¥–ª—è Python –º–æ–¥–µ–ª–µ–π](https://github.com/dbt-labs/dbt-core/discussions/5742).
- –ü—Ä–∏—Å–æ–µ–¥–∏–Ω–∏—Ç—å—Å—è –∫ –∫–∞–Ω–∞–ª—É **#dbt-core-python-models** –≤ [—Å–æ–æ–±—â–µ—Å—Ç–≤–µ dbt –≤ Slack](https://www.getdbt.com/community/join-the-community/).

## –û–±–∑–æ—Ä

Python –º–æ–¥–µ–ª–∏ dbt (`dbt-py`) –º–æ–≥—É—Ç –ø–æ–º–æ—á—å –≤–∞–º —Ä–µ—à–∏—Ç—å –∑–∞–¥–∞—á–∏, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ —Ä–µ—à–∏—Ç—å —Å –ø–æ–º–æ—â—å—é SQL. –í—ã –º–æ–∂–µ—Ç–µ –≤—ã–ø–æ–ª–Ω—è—Ç—å –∞–Ω–∞–ª–∏–∑—ã, –∏—Å–ø–æ–ª—å–∑—É—è –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã, –¥–æ—Å—Ç—É–ø–Ω—ã–µ –≤ —ç–∫–æ—Å–∏—Å—Ç–µ–º–µ Python —Å –æ—Ç–∫—Ä—ã—Ç—ã–º –∏—Å—Ö–æ–¥–Ω—ã–º –∫–æ–¥–æ–º, –≤–∫–ª—é—á–∞—è –ø–µ—Ä–µ–¥–æ–≤—ã–µ –ø–∞–∫–µ—Ç—ã –¥–ª—è –Ω–∞—É–∫–∏ –æ –¥–∞–Ω–Ω—ã—Ö –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏. –†–∞–Ω–µ–µ –≤–∞–º —Ç—Ä–µ–±–æ–≤–∞–ª–∞—Å—å –±—ã –æ—Ç–¥–µ–ª—å–Ω–∞—è –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –∏ –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏—è –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è Python —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–π –≤ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–µ–Ω–Ω–æ–π —Å—Ä–µ–¥–µ. Python —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–∏, –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–µ –≤ dbt, —è–≤–ª—è—é—Ç—Å—è –º–æ–¥–µ–ª—è–º–∏ –≤ –≤–∞—à–µ–º –ø—Ä–æ–µ–∫—Ç–µ —Å —Ç–µ–º–∏ –∂–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—è–º–∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è, –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ –∏ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è.

<File name='models/my_python_model.py'>

```python
import ...

def model(dbt, session):

    my_sql_model_df = dbt.ref("my_sql_model")

    final_df = ...  # —Ç–æ, —á—Ç–æ –Ω–µ–ª—å–∑—è –Ω–∞–ø–∏—Å–∞—Ç—å –Ω–∞ SQL!

    return final_df
```

</File>

<File name='models/config.yml'>

```yml
version: 2

models:
  - name: my_python_model

    # –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ –≤ —Ç–æ–º –∂–µ –∫–æ–¥–µ
    description: –ú–æ—è —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—è, –Ω–∞–ø–∏—Å–∞–Ω–Ω–∞—è –Ω–∞ Python

    # –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –∏–Ω—Ç—É–∏—Ç–∏–≤–Ω–æ –∏ –ø—Ä–∏–≤—ã—á–Ω–æ
    config:
      materialized: table
      tags: ['python']

    # –¢–µ—Å—Ç–∏—Ä—É–π—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –º–æ–µ–π Python —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–∏
    columns:
      - name: id
        # –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –¥–ª—è 'grain' —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ Python
        tests:
          - unique
          - not_null
    tests:
      # –ù–∞–ø–∏—à–∏—Ç–µ —Å–≤–æ—é —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—É—é –ª–æ–≥–∏–∫—É –ø—Ä–æ–≤–µ—Ä–∫–∏ (–Ω–∞ SQL) –¥–ª—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ Python
      - [custom_generic_test](/best-practices/writing-custom-generic-tests)
```

</File>

<!--- TODO: –∫–∞–∫ —Å–¥–µ–ª–∞—Ç—å —ç—Ç–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –±–æ–ª—å—à–µ? --->
<Lightbox src="/img/docs/building-a-dbt-project/building-models/python-models/python-model-dag.png" title="SQL + Python, –≤–º–µ—Å—Ç–µ –Ω–∞–∫–æ–Ω–µ—Ü" style="width:200%"/>

–ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —É—Å–ª–æ–≤–∏—è –¥–ª—è Python –º–æ–¥–µ–ª–µ–π dbt –≤–∫–ª—é—á–∞—é—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∞–¥–∞–ø—Ç–µ—Ä–∞ –¥–ª—è –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã –¥–∞–Ω–Ω—ã—Ö, –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—â–µ–π –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ Python. –í Python –º–æ–¥–µ–ª–∏ dbt –≤–µ—Å—å Python –∫–æ–¥ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è —É–¥–∞–ª–µ–Ω–Ω–æ –Ω–∞ –ø–ª–∞—Ç—Ñ–æ—Ä–º–µ. –ù–∏—á–µ–≥–æ –∏–∑ —ç—Ç–æ–≥–æ –Ω–µ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è dbt –ª–æ–∫–∞–ª—å–Ω–æ. –ú—ã –≤–µ—Ä–∏–º –≤ —á–µ—Ç–∫–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ _–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –º–æ–¥–µ–ª–∏_ –æ—Ç _–≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –º–æ–¥–µ–ª–∏_. –í —ç—Ç–æ–º –∏ –≤–æ –º–Ω–æ–≥–∏—Ö –¥—Ä—É–≥–∏—Ö –∞—Å–ø–µ–∫—Ç–∞—Ö –ø–æ–¥—Ö–æ–¥ dbt –∫ Python –º–æ–¥–µ–ª—è–º –æ—Ç—Ä–∞–∂–∞–µ—Ç –µ–≥–æ –¥–∞–≤–Ω–∏–π –ø–æ–¥—Ö–æ–¥ –∫ –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏—é –¥–∞–Ω–Ω—ã—Ö –≤ SQL.

–ú—ã –Ω–∞–ø–∏—Å–∞–ª–∏ —ç—Ç–æ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ, –ø—Ä–µ–¥–ø–æ–ª–∞–≥–∞—è, —á—Ç–æ –≤—ã –∑–Ω–∞–∫–æ–º—ã —Å dbt. –ï—Å–ª–∏ –≤—ã –Ω–∏–∫–æ–≥–¥–∞ —Ä–∞–Ω—å—à–µ –Ω–µ –ø–∏—Å–∞–ª–∏ –º–æ–¥–µ–ª—å dbt, –º—ã —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º –Ω–∞—á–∞—Ç—å —Å —á—Ç–µ–Ω–∏—è [dbt Models](/docs/build/models). –ù–∞ –ø—Ä–æ—Ç—è–∂–µ–Ω–∏–∏ –≤—Å–µ–≥–æ —Ç–µ–∫—Å—Ç–∞ –º—ã –±—É–¥–µ–º –ø—Ä–æ–≤–æ–¥–∏—Ç—å –ø–∞—Ä–∞–ª–ª–µ–ª–∏ –º–µ–∂–¥—É Python –º–æ–¥–µ–ª—è–º–∏ –∏ SQL –º–æ–¥–µ–ª—è–º–∏, –∞ —Ç–∞–∫–∂–µ —á–µ—Ç–∫–æ —É–∫–∞–∑—ã–≤–∞—Ç—å –∏—Ö —Ä–∞–∑–ª–∏—á–∏—è.

### –ß—Ç–æ —Ç–∞–∫–æ–µ Python –º–æ–¥–µ–ª—å?

Python –º–æ–¥–µ–ª—å dbt ‚Äî —ç—Ç–æ —Ñ—É–Ω–∫—Ü–∏—è, –∫–æ—Ç–æ—Ä–∞—è —á–∏—Ç–∞–µ—Ç –∏—Å—Ç–æ—á–Ω–∏–∫–∏ dbt –∏–ª–∏ –¥—Ä—É–≥–∏–µ –º–æ–¥–µ–ª–∏, –ø—Ä–∏–º–µ–Ω—è–µ—Ç —Å–µ—Ä–∏—é —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–π –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–Ω—ã–π –Ω–∞–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö. –û–ø–µ—Ä–∞—Ü–∏–∏ <Term id="dataframe">DataFrame</Term> –æ–ø—Ä–µ–¥–µ–ª—è—é—Ç –Ω–∞—á–∞–ª—å–Ω—ã–µ —Ç–æ—á–∫–∏, –∫–æ–Ω–µ—á–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∏ –∫–∞–∂–¥—ã–π —à–∞–≥ –Ω–∞ –ø—É—Ç–∏.

–≠—Ç–æ –ø–æ—Ö–æ–∂–µ –Ω–∞ —Ä–æ–ª—å <Term id="cte">CTE</Term> –≤ SQL –º–æ–¥–µ–ª—è—Ö dbt. –ú—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º CTE –¥–ª—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –∏–∑ –≤—ã—à–µ—Å—Ç–æ—è—â–∏—Ö –Ω–∞–±–æ—Ä–æ–≤ –¥–∞–Ω–Ω—ã—Ö, –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è (–∏ –∏–º–µ–Ω–æ–≤–∞–Ω–∏—è) —Å–µ—Ä–∏–∏ –∑–Ω–∞—á–∏–º—ã—Ö —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–π –∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Å –ø–æ–º–æ—â—å—é —Ñ–∏–Ω–∞–ª—å–Ω–æ–≥–æ –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞ `select`. –í—ã –º–æ–∂–µ—Ç–µ –∑–∞–ø—É—Å—Ç–∏—Ç—å —Å–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞–Ω–Ω—É—é –≤–µ—Ä—Å–∏—é SQL –º–æ–¥–µ–ª–∏ dbt, —á—Ç–æ–±—ã —É–≤–∏–¥–µ—Ç—å –¥–∞–Ω–Ω—ã–µ, –≤–∫–ª—é—á–µ–Ω–Ω—ã–µ –≤ —Ä–µ–∑—É–ª—å—Ç–∏—Ä—É—é—â–µ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –∏–ª–∏ —Ç–∞–±–ª–∏—Ü—É. –ö–æ–≥–¥–∞ –≤—ã –≤—ã–ø–æ–ª–Ω—è–µ—Ç–µ `dbt run`, dbt –æ–±–æ—Ä–∞—á–∏–≤–∞–µ—Ç —ç—Ç–æ—Ç –∑–∞–ø—Ä–æ—Å –≤ `create view`, `create table` –∏–ª–∏ –±–æ–ª–µ–µ —Å–ª–æ–∂–Ω—ã–µ DDL, —á—Ç–æ–±—ã —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –µ–≥–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö.

–í–º–µ—Å—Ç–æ —Ñ–∏–Ω–∞–ª—å–Ω–æ–≥–æ –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞ `select` –∫–∞–∂–¥–∞—è Python –º–æ–¥–µ–ª—å –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ñ–∏–Ω–∞–ª—å–Ω—ã–π DataFrame. –ö–∞–∂–¥–∞—è –æ–ø–µ—Ä–∞—Ü–∏—è DataFrame "–ª–µ–Ω–∏–≤–æ –æ—Ü–µ–Ω–∏–≤–∞–µ—Ç—Å—è". –í –ø—Ä–æ—Ü–µ—Å—Å–µ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –≤—ã –º–æ–∂–µ—Ç–µ –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ –ø—Ä–æ—Å–º–æ—Ç—Ä–µ—Ç—å –µ–≥–æ –¥–∞–Ω–Ω—ã–µ, –∏—Å–ø–æ–ª—å–∑—É—è –º–µ—Ç–æ–¥—ã, —Ç–∞–∫–∏–µ –∫–∞–∫ `.show()` –∏–ª–∏ `.head()`. –ö–æ–≥–¥–∞ –≤—ã –∑–∞–ø—É—Å–∫–∞–µ—Ç–µ Python –º–æ–¥–µ–ª—å, –ø–æ–ª–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Ñ–∏–Ω–∞–ª—å–Ω–æ–≥–æ DataFrame –±—É–¥–µ—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω –∫–∞–∫ —Ç–∞–±–ª–∏—Ü–∞ –≤ –≤–∞—à–µ–º —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –¥–∞–Ω–Ω—ã—Ö.

Python –º–æ–¥–µ–ª–∏ dbt –∏–º–µ—é—Ç –¥–æ—Å—Ç—É–ø –ø–æ—á—Ç–∏ –∫–æ –≤—Å–µ–º —Ç–µ–º –∂–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏, —á—Ç–æ –∏ SQL –º–æ–¥–µ–ª–∏. –í—ã –º–æ–∂–µ—Ç–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –∏ –¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –∏—Ö, –¥–æ–±–∞–≤–ª—è—Ç—å —Å–≤–æ–π—Å—Ç–≤–∞ `tags` –∏ `meta`, –∞ —Ç–∞–∫–∂–µ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—Ç—å –¥–æ—Å—Ç—É–ø –∫ –∏—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º –¥—Ä—É–≥–∏–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º. –í—ã –º–æ–∂–µ—Ç–µ –≤—ã–±–∏—Ä–∞—Ç—å –∏—Ö –ø–æ –∏–º–µ–Ω–∏, –ø—É—Ç–∏ –∫ —Ñ–∞–π–ª—É, –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è–º, –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–æ–≥–æ, —è–≤–ª—è—é—Ç—Å—è –ª–∏ –æ–Ω–∏ –≤—ã—à–µ—Å—Ç–æ—è—â–∏–º–∏ –∏–ª–∏ –Ω–∏–∂–µ—Å—Ç–æ—è—â–∏–º–∏ –ø–æ –æ—Ç–Ω–æ—à–µ–Ω–∏—é –∫ –¥—Ä—É–≥–æ–π –º–æ–¥–µ–ª–∏, –∏–ª–∏ –µ—Å–ª–∏ –æ–Ω–∏ –±—ã–ª–∏ –∏–∑–º–µ–Ω–µ–Ω—ã –ø–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é —Å –ø—Ä–µ–¥—ã–¥—É—â–∏–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º –ø—Ä–æ–µ–∫—Ç–∞.

### –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ Python –º–æ–¥–µ–ª–∏

–ö–∞–∂–¥–∞—è Python –º–æ–¥–µ–ª—å –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ —Ñ–∞–π–ª–µ `.py` –≤ –≤–∞—à–µ–π –ø–∞–ø–∫–µ `models/`. –û–Ω–∞ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Ñ—É–Ω–∫—Ü–∏—é —Å –∏–º–µ–Ω–µ–º **`model()`**, –∫–æ—Ç–æ—Ä–∞—è –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –¥–≤–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞:
- **`dbt`**: –ö–ª–∞—Å—Å, —Å–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–π dbt Core, —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –¥–ª—è –∫–∞–∂–¥–æ–π –º–æ–¥–µ–ª–∏, –ø–æ–∑–≤–æ–ª—è–µ—Ç –≤–∞–º –∑–∞–ø—É—Å–∫–∞—Ç—å –≤–∞—à Python –∫–æ–¥ –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ –≤–∞—à–µ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞ dbt –∏ DAG.
- **`session`**: –ö–ª–∞—Å—Å, –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é—â–∏–π —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –≤–∞—à–µ–π –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã –¥–∞–Ω–Ω—ã—Ö —Å Python –±—ç–∫–µ–Ω–¥–æ–º. –°–µ—Å—Å–∏—è –Ω–µ–æ–±—Ö–æ–¥–∏–º–∞ –¥–ª—è —á—Ç–µ–Ω–∏—è —Ç–∞–±–ª–∏—Ü –∫–∞–∫ DataFrame –∏ –∑–∞–ø–∏—Å–∏ DataFrame –æ–±—Ä–∞—Ç–Ω–æ –≤ —Ç–∞–±–ª–∏—Ü—ã. –í PySpark, –ø–æ —Å–æ–≥–ª–∞—à–µ–Ω–∏—é, `SparkSession` –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è `spark` –∏ –¥–æ—Å—Ç—É–ø–µ–Ω –≥–ª–æ–±–∞–ª—å–Ω–æ. –î–ª—è —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç–∏ –º–µ–∂–¥—É –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞–º–∏ –º—ã –≤—Å–µ–≥–¥–∞ –ø–µ—Ä–µ–¥–∞–µ–º –µ–≥–æ –≤ —Ñ—É–Ω–∫—Ü–∏—é `model` –∫–∞–∫ —è–≤–Ω—ã–π –∞—Ä–≥—É–º–µ–Ω—Ç, –Ω–∞–∑—ã–≤–∞–µ–º—ã–π `session`.

–§—É–Ω–∫—Ü–∏—è `model()` –¥–æ–ª–∂–Ω–∞ –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å –æ–¥–∏–Ω DataFrame. –ù–∞ Snowpark (Snowflake) —ç—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å Snowpark –∏–ª–∏ pandas DataFrame. –ß–µ—Ä–µ–∑ PySpark (Databricks + BigQuery) —ç—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å Spark, pandas –∏–ª–∏ pandas-on-Spark DataFrame. –î–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –≤—ã–±–æ—Ä–µ –º–µ–∂–¥—É pandas –∏ –Ω–∞—Ç–∏–≤–Ω—ã–º–∏ DataFrame, —Å–º. [API –∏ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å DataFrame](#dataframe-api-and-syntax).

–ö–æ–≥–¥–∞ –≤—ã –≤—ã–ø–æ–ª–Ω—è–µ—Ç–µ `dbt run --select python_model`, dbt –ø–æ–¥–≥–æ—Ç–æ–≤–∏—Ç –∏ –ø–µ—Ä–µ–¥–∞—Å—Ç –æ–±–∞ –∞—Ä–≥—É–º–µ–Ω—Ç–∞ (`dbt` –∏ `session`). –í—Å–µ, —á—Ç–æ –≤–∞–º –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å, —ç—Ç–æ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å —Ñ—É–Ω–∫—Ü–∏—é. –í–æ—Ç –∫–∞–∫ –¥–æ–ª–∂–Ω–∞ –≤—ã–≥–ª—è–¥–µ—Ç—å –∫–∞–∂–¥–∞—è Python –º–æ–¥–µ–ª—å:

<File name='models/my_python_model.py'>

```python
def model(dbt, session):

    ...

    return final_df
```

</File>

### –°—Å—ã–ª–∫–∏ –Ω–∞ –¥—Ä—É–≥–∏–µ –º–æ–¥–µ–ª–∏

Python –º–æ–¥–µ–ª–∏ –ø–æ–ª–Ω–æ—Å—Ç—å—é —É—á–∞—Å—Ç–≤—É—é—Ç –≤ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω–æ–º –∞—Ü–∏–∫–ª–∏—á–µ—Å–∫–æ–º –≥—Ä–∞—Ñ–µ (DAG) —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–π dbt. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –º–µ—Ç–æ–¥ `dbt.ref()` –≤ Python –º–æ–¥–µ–ª–∏, —á—Ç–æ–±—ã —á–∏—Ç–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –∏–∑ –¥—Ä—É–≥–∏—Ö –º–æ–¥–µ–ª–µ–π (SQL –∏–ª–∏ Python). –ï—Å–ª–∏ –≤—ã —Ö–æ—Ç–∏—Ç–µ —á–∏—Ç–∞—Ç—å –Ω–∞–ø—Ä—è–º—É—é –∏–∑ –∏—Å—Ö–æ–¥–Ω–æ–π —Ç–∞–±–ª–∏—Ü—ã, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `dbt.source()`. –≠—Ç–∏ –º–µ—Ç–æ–¥—ã –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç DataFrame, —É–∫–∞–∑—ã–≤–∞—é—â–∏–µ –Ω–∞ –≤—ã—à–µ—Å—Ç–æ—è—â–∏–π –∏—Å—Ç–æ—á–Ω–∏–∫, –º–æ–¥–µ–ª—å, seed –∏–ª–∏ snapshot.

<File name='models/my_python_model.py'>

```python
def model(dbt, session):

    # DataFrame, –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é—â–∏–π –≤—ã—à–µ—Å—Ç–æ—è—â—É—é –º–æ–¥–µ–ª—å
    upstream_model = dbt.ref("upstream_model_name")

    # DataFrame, –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é—â–∏–π –≤—ã—à–µ—Å—Ç–æ—è—â–∏–π –∏—Å—Ç–æ—á–Ω–∏–∫
    upstream_source = dbt.source("upstream_source_name", "table_name")

    ...
```

</File>

–ö–æ–Ω–µ—á–Ω–æ, –≤—ã –º–æ–∂–µ—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `ref()` –¥–ª—è –≤–∞—à–µ–π Python –º–æ–¥–µ–ª–∏ –≤ –Ω–∏–∂–µ—Å—Ç–æ—è—â–∏—Ö SQL –º–æ–¥–µ–ª—è—Ö:

<File name='models/downstream_model.sql'>

```sql
with upstream_python_model as (

    select * from {{ ref('my_python_model') }}

),

...
```

</File>

:::caution

–°—Å—ã–ª–∫–∏ –Ω–∞ [—ç—Ñ–µ–º–µ—Ä–Ω—ã–µ](/docs/build/materializations#ephemeral) –º–æ–¥–µ–ª–∏ –≤ –Ω–∞—Å—Ç–æ—è—â–µ–µ –≤—Ä–µ–º—è –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è (—Å–º. [–∑–∞–ø—Ä–æ—Å –Ω–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏](https://github.com/dbt-labs/dbt-core/issues/7288)) 
:::

<VersionBlock firstVersion="1.8">

–ù–∞—á–∏–Ω–∞—è —Å –≤–µ—Ä—Å–∏–∏ dbt 1.8, Python –º–æ–¥–µ–ª–∏ —Ç–∞–∫–∂–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –≤ Python f-—Å—Ç—Ä–æ–∫–∞—Ö. –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –±–æ–ª–µ–µ —Ç–æ–Ω–∫–æ –∏ –¥–∏–Ω–∞–º–∏—á–Ω–æ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—Ç—å –º–æ–¥–µ–ª–∏ –Ω–µ–ø–æ—Å—Ä–µ–¥—Å—Ç–≤–µ–Ω–Ω–æ –≤ –≤–∞—à–µ–º Python –∫–æ–¥–µ. –ù–∞–ø—Ä–∏–º–µ—Ä:

<File name='models/my_python_model.py'>

```python
# –†–∞–Ω–µ–µ –ø–æ–ø—ã—Ç–∫–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ –∑–Ω–∞—á–µ–Ω–∏—é –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ —Ç–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º –ø—Ä–∏–≤–æ–¥–∏–ª–∞ –∫ None
print(f"{dbt.config.get('my_var')}")  # –í—ã–≤–æ–¥ –¥–æ –∏–∑–º–µ–Ω–µ–Ω–∏—è: None

# –¢–µ–ø–µ—Ä—å –≤—ã –º–æ–∂–µ—Ç–µ –ø–æ–ª—É—á–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫ —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–æ–º—É –∑–Ω–∞—á–µ–Ω–∏—é –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
# –ü—Ä–µ–¥–ø–æ–ª–∞–≥–∞—è, —á—Ç–æ 'my_var' –Ω–∞—Å—Ç—Ä–æ–µ–Ω –Ω–∞ 5 –¥–ª—è —Ç–µ–∫—É—â–µ–π –º–æ–¥–µ–ª–∏
print(f"{dbt.config.get('my_var')}")  # –í—ã–≤–æ–¥ –ø–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è: 5
```

–≠—Ç–æ —Ç–∞–∫–∂–µ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –≤—ã –º–æ–∂–µ—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `dbt.config.get()` –≤ Python –º–æ–¥–µ–ª—è—Ö, —á—Ç–æ–±—ã –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å, —á—Ç–æ –∑–Ω–∞—á–µ–Ω–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ –¥–æ—Å—Ç—É–ø–Ω—ã –∏ –º–æ–≥—É—Ç –±—ã—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω—ã –≤ Python f-—Å—Ç—Ä–æ–∫–∞—Ö.

</File>
</VersionBlock>

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Python –º–æ–¥–µ–ª–µ–π

–ö–∞–∫ –∏ SQL –º–æ–¥–µ–ª–∏, Python –º–æ–¥–µ–ª–∏ –º–æ–∂–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å —Ç—Ä–µ–º—è —Å–ø–æ—Å–æ–±–∞–º–∏:
1. –í `dbt_project.yml`, –≥–¥–µ –≤—ã –º–æ–∂–µ—Ç–µ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –º–Ω–æ–∂–µ—Å—Ç–≤–æ –º–æ–¥–µ–ª–µ–π –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ
2. –í –æ—Ç–¥–µ–ª—å–Ω–æ–º `.yml` —Ñ–∞–π–ª–µ –≤ –∫–∞—Ç–∞–ª–æ–≥–µ `models/`
3. –í–Ω—É—Ç—Ä–∏ —Ñ–∞–π–ª–∞ `.py` –º–æ–¥–µ–ª–∏, –∏—Å–ø–æ–ª—å–∑—É—è –º–µ—Ç–æ–¥ `dbt.config()`

–í—ã–∑–æ–≤ –º–µ—Ç–æ–¥–∞ `dbt.config()` —É—Å—Ç–∞–Ω–æ–≤–∏—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –¥–ª—è –≤–∞—à–µ–π –º–æ–¥–µ–ª–∏ –≤ –≤–∞—à–µ–º `.py` —Ñ–∞–π–ª–µ, –∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ –º–∞–∫—Ä–æ—Å—É `{{ config() }}` –≤ —Ñ–∞–π–ª–∞—Ö `.sql` –º–æ–¥–µ–ª–µ–π:

<File name='models/my_python_model.py'>

```python
def model(dbt, session):

    # —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
    dbt.config(materialized="table")
```

</File>

–°—É—â–µ—Å—Ç–≤—É–µ—Ç –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –Ω–∞ —Å–ª–æ–∂–Ω–æ—Å—Ç—å, –∫–æ—Ç–æ—Ä—É—é –≤—ã –º–æ–∂–µ—Ç–µ –¥–æ—Å—Ç–∏—á—å —Å –ø–æ–º–æ—â—å—é –º–µ—Ç–æ–¥–∞ `dbt.config()`. –û–Ω –ø—Ä–∏–Ω–∏–º–∞–µ—Ç _—Ç–æ–ª—å–∫–æ_ –±—É–∫–≤–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è (—Å—Ç—Ä–æ–∫–∏, –ª–æ–≥–∏—á–µ—Å–∫–∏–µ –∏ —á–∏—Å–ª–æ–≤—ã–µ —Ç–∏–ø—ã) –∏ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫—É—é –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é. –ü–µ—Ä–µ–¥–∞—á–∞ –¥—Ä—É–≥–æ–π —Ñ—É–Ω–∫—Ü–∏–∏ –∏–ª–∏ –±–æ–ª–µ–µ —Å–ª–æ–∂–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∞–Ω–Ω—ã—Ö –Ω–µ–≤–æ–∑–º–æ–∂–Ω–∞. –ü—Ä–∏—á–∏–Ω–∞ –≤ —Ç–æ–º, —á—Ç–æ dbt —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏ –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –∞—Ä–≥—É–º–µ–Ω—Ç—ã –¥–ª—è `config()` –ø—Ä–∏ —Ä–∞–∑–±–æ—Ä–µ –≤–∞—à–µ–π –º–æ–¥–µ–ª–∏ –±–µ–∑ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –≤–∞—à–µ–≥–æ Python –∫–æ–¥–∞. –ï—Å–ª–∏ –≤–∞–º –Ω—É–∂–Ω–æ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –±–æ–ª–µ–µ —Å–ª–æ–∂–Ω—É—é –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é, –º—ã —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –µ–µ, –∏—Å–ø–æ–ª—å–∑—É—è —Å–≤–æ–π—Å—Ç–≤–æ [`config`](/reference/resource-properties/config) –≤ YAML —Ñ–∞–π–ª–µ.

#### –î–æ—Å—Ç—É–ø –∫ –∫–æ–Ω—Ç–µ–∫—Å—Ç—É –ø—Ä–æ–µ–∫—Ç–∞

Python –º–æ–¥–µ–ª–∏ dbt –Ω–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç Jinja –¥–ª—è —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞ —Å–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –∫–æ–¥–∞. Python –º–æ–¥–µ–ª–∏ –∏–º–µ—é—Ç –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫ –≥–ª–æ–±–∞–ª—å–Ω—ã–º –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞–º –ø—Ä–æ–µ–∫—Ç–∞ –ø–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é —Å SQL –º–æ–¥–µ–ª—è–º–∏. –≠—Ç–æ—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –∏–∑ –∫–ª–∞—Å—Å–∞ `dbt`, –ø–µ—Ä–µ–¥–∞–Ω–Ω–æ–≥–æ –≤ –∫–∞—á–µ—Å—Ç–≤–µ –∞—Ä–≥—É–º–µ–Ω—Ç–∞ —Ñ—É–Ω–∫—Ü–∏–∏ `model()`.

–ò–∑ –∫–æ—Ä–æ–±–∫–∏ –∫–ª–∞—Å—Å `dbt` –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç:
- –í–æ–∑–≤—Ä–∞—â–µ–Ω–∏–µ DataFrame, —Å—Å—ã–ª–∞—é—â–∏—Ö—Å—è –Ω–∞ –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏—è –¥—Ä—É–≥–∏—Ö —Ä–µ—Å—É—Ä—Å–æ–≤: `dbt.ref()` + `dbt.source()`
- –î–æ—Å—Ç—É–ø –∫ –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏—é –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö —Ç–µ–∫—É—â–µ–π –º–æ–¥–µ–ª–∏: `dbt.this()` (—Ç–∞–∫–∂–µ: `dbt.this.database`, `.schema`, `.identifier`)
- –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ, —è–≤–ª—è–µ—Ç—Å—è –ª–∏ —Ç–µ–∫—É—â–∏–π –∑–∞–ø—É—Å–∫ –º–æ–¥–µ–ª–∏ –∏–Ω–∫—Ä–µ–º–µ–Ω—Ç–Ω—ã–º: `dbt.is_incremental`

–í–æ–∑–º–æ–∂–Ω–æ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ —ç—Ç–æ–≥–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –ø—É—Ç–µ–º "–ø–æ–ª—É—á–µ–Ω–∏—è" –∏—Ö —Å –ø–æ–º–æ—â—å—é `dbt.config.get()` –ø–æ—Å–ª–µ —Ç–æ–≥–æ, –∫–∞–∫ –æ–Ω–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã –≤ [–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –º–æ–¥–µ–ª–∏](/reference/model-configs). –ù–∞—á–∏–Ω–∞—è —Å dbt v1.8, –º–µ—Ç–æ–¥ `dbt.config.get()` –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π –¥–æ—Å—Ç—É–ø –∫ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è–º –≤ Python –º–æ–¥–µ–ª—è—Ö, —É–≤–µ–ª–∏—á–∏–≤–∞—è –≥–∏–±–∫–æ—Å—Ç—å –≤ –ª–æ–≥–∏–∫–µ –º–æ–¥–µ–ª–∏. –≠—Ç–æ –≤–∫–ª—é—á–∞–µ—Ç –≤—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ, —Ç–∞–∫–∏–µ –∫–∞–∫ `var`, `env_var` –∏ `target`. –ï—Å–ª–∏ –≤—ã —Ö–æ—Ç–∏—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —ç—Ç–∏ –∑–Ω–∞—á–µ–Ω–∏—è –¥–ª—è —É—Å–ª–æ–≤–Ω–æ–π –ª–æ–≥–∏–∫–∏ –≤ –≤–∞—à–µ–π –º–æ–¥–µ–ª–∏, –º—ã —Ç—Ä–µ–±—É–µ–º –∏—Ö –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —á–µ—Ä–µ–∑ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º YAML —Ñ–∞–π–ª–µ:

<File name='models/config.yml'>

```yml
version: 2

models:
  - name: my_python_model
    config:
      materialized: table
      target_name: "{{ target.name }}"
      specific_var: "{{ var('SPECIFIC_VAR') }}"
      specific_env_var: "{{ env_var('SPECIFIC_ENV_VAR') }}"
```

</File>

–ó–∞—Ç–µ–º, –≤ Python –∫–æ–¥–µ –º–æ–¥–µ–ª–∏, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ñ—É–Ω–∫—Ü–∏—é `dbt.config.get()`, —á—Ç–æ–±—ã _–ø–æ–ª—É—á–∏—Ç—å –¥–æ—Å—Ç—É–ø_ –∫ –∑–Ω–∞—á–µ–Ω–∏—è–º –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π, –∫–æ—Ç–æ—Ä—ã–µ –±—ã–ª–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã:

<File name='models/my_python_model.py'>

```python
def model(dbt, session):
    target_name = dbt.config.get("target_name")
    specific_var = dbt.config.get("specific_var")
    specific_env_var = dbt.config.get("specific_env_var")

    orders_df = dbt.ref("fct_orders")

    # –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –≤ dev
    if target_name == "dev":
        orders_df = orders_df.limit(500)
```

</File>

<VersionBlock firstVersion="1.8">

#### –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

–í –¥–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –∫ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º –º–µ—Ç–æ–¥–∞–º –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ Python –º–æ–¥–µ–ª–µ–π, –≤—ã —Ç–∞–∫–∂–µ –∏–º–µ–µ—Ç–µ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π –¥–æ—Å—Ç—É–ø –∫ –∑–Ω–∞—á–µ–Ω–∏—è–º –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏, —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–º —Å –ø–æ–º–æ—â—å—é `dbt.config()` –≤ Python –º–æ–¥–µ–ª—è—Ö, –∏—Å–ø–æ–ª—å–∑—É—è f-—Å—Ç—Ä–æ–∫–∏. –≠—Ç–æ —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–π –ª–æ–≥–∏–∫–∏ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π.

<File name='models/my_python_model.py'>

```python
def model(dbt, session):
    dbt.config(materialized="table")
    
    # –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π –¥–æ—Å—Ç—É–ø –∫ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –≤ Python f-—Å—Ç—Ä–æ–∫–∞—Ö, 
    # —á—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏ –ø–æ–ª—É—á–∞—Ç—å –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∑–Ω–∞—á–µ–Ω–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏.
    # –ü—Ä–µ–¥–ø–æ–ª–∞–≥–∞—è, —á—Ç–æ 'my_var' —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –Ω–∞ 5, —ç—Ç–æ –≤—ã–≤–µ–¥–µ—Ç: Dynamic config value: 5
    print(f"Dynamic config value: {dbt.config.get('my_var')}")
```

</File>
</VersionBlock>

### –ú–∞—Ç–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏–∏

Python –º–æ–¥–µ–ª–∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç —Å–ª–µ–¥—É—é—â–∏–µ –º–∞—Ç–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏–∏:
- `table` (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
- `incremental`

–ò–Ω–∫—Ä–µ–º–µ–Ω—Ç–Ω—ã–µ Python –º–æ–¥–µ–ª–∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç –≤—Å–µ —Ç–µ –∂–µ [–∏–Ω–∫—Ä–µ–º–µ–Ω—Ç–Ω—ã–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏](/docs/build/incremental-strategy), —á—Ç–æ –∏ –∏—Ö SQL –∞–Ω–∞–ª–æ–≥–∏. –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –∑–∞–≤–∏—Å—è—Ç –æ—Ç –≤–∞—à–µ–≥–æ –∞–¥–∞–ø—Ç–µ—Ä–∞. –ù–∞–ø—Ä–∏–º–µ—Ä, –∏–Ω–∫—Ä–µ–º–µ–Ω—Ç–Ω—ã–µ –º–æ–¥–µ–ª–∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è –Ω–∞ BigQuery —Å Dataproc –¥–ª—è —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ `merge`; —Å—Ç—Ä–∞—Ç–µ–≥–∏—è `insert_overwrite` –ø–æ–∫–∞ –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è.

Python –º–æ–¥–µ–ª–∏ –Ω–µ –º–æ–≥—É—Ç –±—ã—Ç—å –º–∞—Ç–µ—Ä–∏–∞–ª–∏–∑–æ–≤–∞–Ω—ã –∫–∞–∫ `view` –∏–ª–∏ `ephemeral`. Python –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è –¥–ª—è —Ä–µ—Å—É—Ä—Å–æ–≤, –æ—Ç–ª–∏—á–Ω—ã—Ö –æ—Ç –º–æ–¥–µ–ª–µ–π (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Ç–µ—Å—Ç–æ–≤ –∏ —Å–Ω–∏–º–∫–æ–≤).

–î–ª—è –∏–Ω–∫—Ä–µ–º–µ–Ω—Ç–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π, –∫–∞–∫ –∏ –¥–ª—è SQL –º–æ–¥–µ–ª–µ–π, –≤–∞–º –Ω—É–∂–Ω–æ —Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å –≤—Ö–æ–¥—è—â–∏–µ —Ç–∞–±–ª–∏—Ü—ã —Ç–æ–ª—å–∫–æ –Ω–∞ –Ω–æ–≤—ã–µ —Å—Ç—Ä–æ–∫–∏ –¥–∞–Ω–Ω—ã—Ö:

<WHCode>

<div warehouse="Snowpark">

<File name='models/my_python_model.py'>

```python
import snowflake.snowpark.functions as F

def model(dbt, session):
    dbt.config(materialized = "incremental")
    df = dbt.ref("upstream_table")

    if dbt.is_incremental:

        # —Ç–æ–ª—å–∫–æ –Ω–æ–≤—ã–µ —Å—Ç—Ä–æ–∫–∏ –ø–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é —Å –º–∞–∫—Å–∏–º—É–º–æ–º –≤ —Ç–µ–∫—É—â–µ–π —Ç–∞–±–ª–∏—Ü–µ
        max_from_this = f"select max(updated_at) from {dbt.this}"
        df = df.filter(df.updated_at >= session.sql(max_from_this).collect()[0][0])

        # –∏–ª–∏ —Ç–æ–ª—å–∫–æ —Å—Ç—Ä–æ–∫–∏ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 3 –¥–Ω—è
        df = df.filter(df.updated_at >= F.dateadd("day", F.lit(-3), F.current_timestamp()))

    ...

    return df
```

</File>

</div>

<div warehouse="PySpark">

<File name='models/my_python_model.py'>

```python
import pyspark.sql.functions as F

def model(dbt, session):
    dbt.config(materialized = "incremental")
    df = dbt.ref("upstream_table")

    if dbt.is_incremental:

        # —Ç–æ–ª—å–∫–æ –Ω–æ–≤—ã–µ —Å—Ç—Ä–æ–∫–∏ –ø–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é —Å –º–∞–∫—Å–∏–º—É–º–æ–º –≤ —Ç–µ–∫—É—â–µ–π —Ç–∞–±–ª–∏—Ü–µ
        max_from_this = f"select max(updated_at) from {dbt.this}"
        df = df.filter(df.updated_at >= session.sql(max_from_this).collect()[0][0])

        # –∏–ª–∏ —Ç–æ–ª—å–∫–æ —Å—Ç—Ä–æ–∫–∏ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 3 –¥–Ω—è
        df = df.filter(df.updated_at >= F.date_add(F.current_timestamp(), F.lit(-3)))

    ...

    return df
```

</File>

</div>

</WHCode>

## –°–ø–µ—Ü–∏—Ñ–∏—á–µ—Å–∫–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å Python

### –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–π

–í –¥–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –∫ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—é —Ñ—É–Ω–∫—Ü–∏–∏ `model`, Python –º–æ–¥–µ–ª—å –º–æ–∂–µ—Ç –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –¥—Ä—É–≥–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ –∏–ª–∏ –æ–ø—Ä–µ–¥–µ–ª—è—Ç—å —Å–≤–æ–∏ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–µ. –í–æ—Ç –ø—Ä–∏–º–µ—Ä –Ω–∞ Snowpark, –æ–ø—Ä–µ–¥–µ–ª—è—é—â–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫—É—é —Ñ—É–Ω–∫—Ü–∏—é `add_one`:

<File name='models/my_python_model.py'>

```python
def add_one(x):
    return x + 1

def model(dbt, session):
    dbt.config(materialized="table")
    temps_df = dbt.ref("temperatures")

    # –Ω–µ–º–Ω–æ–≥–æ —Å–æ–≥—Ä–µ–µ–º
    df = temps_df.withColumn("degree_plus_one", add_one(temps_df["degree"]))
    return df
```

</File>

–í –Ω–∞—Å—Ç–æ—è—â–µ–µ –≤—Ä–µ–º—è —Ñ—É–Ω–∫—Ü–∏–∏ Python, –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–µ –≤ –æ–¥–Ω–æ–π –º–æ–¥–µ–ª–∏ dbt, –Ω–µ –º–æ–≥—É—Ç –±—ã—Ç—å –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã –∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω—ã –≤ –¥—Ä—É–≥–∏—Ö –º–æ–¥–µ–ª—è—Ö. –û–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∫ [–ü–æ–≤—Ç–æ—Ä–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞](#code-reuse) –¥–ª—è –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã—Ö —Ä–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞–µ–º—ã—Ö —à–∞–±–ª–æ–Ω–æ–≤.

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞–∫–µ—Ç–æ–≤ PyPI

–í—ã —Ç–∞–∫–∂–µ –º–æ–∂–µ—Ç–µ –æ–ø—Ä–µ–¥–µ–ª—è—Ç—å —Ñ—É–Ω–∫—Ü–∏–∏, –∫–æ—Ç–æ—Ä—ã–µ –∑–∞–≤–∏—Å—è—Ç –æ—Ç —Å—Ç–æ—Ä–æ–Ω–Ω–∏—Ö –ø–∞–∫–µ—Ç–æ–≤, –ø—Ä–∏ —É—Å–ª–æ–≤–∏–∏, —á—Ç–æ —ç—Ç–∏ –ø–∞–∫–µ—Ç—ã —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –∏ –¥–æ—Å—Ç—É–ø–Ω—ã –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è Python –Ω–∞ –≤–∞—à–µ–π –ø–ª–∞—Ç—Ñ–æ—Ä–º–µ –¥–∞–Ω–Ω—ã—Ö. –°–º. –∑–∞–º–µ—Ç–∫–∏ –æ "–£—Å—Ç–∞–Ω–æ–≤–∫–µ –ø–∞–∫–µ—Ç–æ–≤" –¥–ª—è [–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã—Ö –ø–ª–∞—Ç—Ñ–æ—Ä–º –¥–∞–Ω–Ω—ã—Ö](#specific-data-platforms).

–í —ç—Ç–æ–º –ø—Ä–∏–º–µ—Ä–µ –º—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º –ø–∞–∫–µ—Ç `holidays`, —á—Ç–æ–±—ã –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å, —è–≤–ª—è–µ—Ç—Å—è –ª–∏ –¥–∞–Ω–Ω–∞—è –¥–∞—Ç–∞ –ø—Ä–∞–∑–¥–Ω–∏–∫–æ–º –≤–æ –§—Ä–∞–Ω—Ü–∏–∏. –ö–æ–¥ –Ω–∏–∂–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç API pandas –¥–ª—è –ø—Ä–æ—Å—Ç–æ—Ç—ã –∏ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç–∏ –º–µ–∂–¥—É –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞–º–∏. –¢–æ—á–Ω—ã–π —Å–∏–Ω—Ç–∞–∫—Å–∏—Å –∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç—å —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞ –¥–ª—è –º–Ω–æ–≥–æ–∑–∞–¥–∞—á–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ –≤—Å–µ –µ—â–µ —Ä–∞–∑–ª–∏—á–∞—é—Ç—Å—è.

<WHCode>

<div warehouse="Snowpark">

<File name='models/my_python_model.py'>

```python
import holidays

def is_holiday(date_col):
    # Chez Jaffle
    french_holidays = holidays.France()
    is_holiday = (date_col in french_holidays)
    return is_holiday

def model(dbt, session):
    dbt.config(
        materialized = "table",
        packages = ["holidays"]
    )

    orders_df = dbt.ref("stg_orders")

    df = orders_df.to_pandas()

    # –ø—Ä–∏–º–µ–Ω—è–µ–º –Ω–∞—à—É —Ñ—É–Ω–∫—Ü–∏—é
    # (—Å—Ç–æ–ª–±—Ü—ã –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –≤ –≤–µ—Ä—Ö–Ω–µ–º —Ä–µ–≥–∏—Å—Ç—Ä–µ –Ω–∞ Snowpark)
    df["IS_HOLIDAY"] = df["ORDER_DATE"].apply(is_holiday)
    df["ORDER_DATE"].dt.tz_localize('UTC') # –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –∏–∑ Number/Long –≤ tz-aware Datetime

    # –≤–æ–∑–≤—Ä–∞—â–∞–µ–º —Ñ–∏–Ω–∞–ª—å–Ω—ã–π –Ω–∞–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö (Pandas DataFrame)
    return df
```

</File>

</div>

<div warehouse="PySpark">

<File name='models/my_python_model.py'>

```python
import holidays

def is_holiday(date_col):
    # Chez Jaffle
    french_holidays = holidays.France()
    is_holiday = (date_col in french_holidays)
    return is_holiday

def model(dbt, session):
    dbt.config(
        materialized = "table",
        packages = ["holidays"]
    )

    orders_df = dbt.ref("stg_orders")

    df = orders_df.to_pandas_on_spark()  # Spark 3.2+
    # df = orders_df.toPandas() –≤ –±–æ–ª–µ–µ —Ä–∞–Ω–Ω–∏—Ö –≤–µ—Ä—Å–∏—è—Ö

    # –ø—Ä–∏–º–µ–Ω—è–µ–º –Ω–∞—à—É —Ñ—É–Ω–∫—Ü–∏—é
    df["is_holiday"] = df["order_date"].apply(is_holiday)

    # –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –æ–±—Ä–∞—Ç–Ω–æ –≤ PySpark
    df = df.to_spark()               # Spark 3.2+
    # df = session.createDataFrame(df) –≤ –±–æ–ª–µ–µ —Ä–∞–Ω–Ω–∏—Ö –≤–µ—Ä—Å–∏—è—Ö

    # –≤–æ–∑–≤—Ä–∞—â–∞–µ–º —Ñ–∏–Ω–∞–ª—å–Ω—ã–π –Ω–∞–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö (PySpark DataFrame)
    return df
```

</File>

</div>

</WHCode>

#### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–∞–∫–µ—Ç–æ–≤

–ú—ã —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º –≤–∞–º –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—Ç—å –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –ø–∞–∫–µ—Ç—ã –∏ –≤–µ—Ä—Å–∏–∏, —á—Ç–æ–±—ã dbt –º–æ–≥ –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å –∏—Ö –≤ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö –ø—Ä–æ–µ–∫—Ç–∞. –≠—Ç–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Ç—Ä–µ–±—É–µ—Ç—Å—è –¥–ª—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –Ω–∞ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞—Ö. –ï—Å–ª–∏ –≤–∞–º –Ω—É–∂–Ω—ã –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –≤–µ—Ä—Å–∏–∏ –ø–∞–∫–µ—Ç–æ–≤, —É–∫–∞–∂–∏—Ç–µ –∏—Ö.

<File name='models/my_python_model.py'>

```python
def model(dbt, session):
    dbt.config(
        packages = ["numpy==1.23.1", "scikit-learn"]
    )
```

</File>

<File name='models/config.yml'>

```yml
version: 2

models:
  - name: my_python_model
    config:
      packages:
        - "numpy==1.23.1"
        - scikit-learn
```

</File>

#### –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ (UDF)

–í—ã –º–æ–∂–µ—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä `@udf` –∏–ª–∏ —Ñ—É–Ω–∫—Ü–∏—é `udf`, —á—Ç–æ–±—ã –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å "–∞–Ω–æ–Ω–∏–º–Ω—É—é" —Ñ—É–Ω–∫—Ü–∏—é –∏ –≤—ã–∑–≤–∞—Ç—å –µ–µ –≤ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–∏ DataFrame —Ñ—É–Ω–∫—Ü–∏–∏ `model`. –≠—Ç–æ —Ç–∏–ø–∏—á–Ω—ã–π —à–∞–±–ª–æ–Ω –¥–ª—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –±–æ–ª–µ–µ —Å–ª–æ–∂–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π –≤ –∫–∞—á–µ—Å—Ç–≤–µ –æ–ø–µ—Ä–∞—Ü–∏–π DataFrame, –æ—Å–æ–±–µ–Ω–Ω–æ –µ—Å–ª–∏ —ç—Ç–∏ —Ñ—É–Ω–∫—Ü–∏–∏ —Ç—Ä–µ–±—É—é—Ç –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –æ—Ç —Å—Ç–æ—Ä–æ–Ω–Ω–∏—Ö –ø–∞–∫–µ—Ç–æ–≤.
- [Snowpark Python: –°–æ–∑–¥–∞–Ω–∏–µ UDF](https://docs.snowflake.com/en/developer-guide/snowpark/python/creating-udfs.html)
- [PySpark —Ñ—É–Ω–∫—Ü–∏–∏: udf](https://spark.apache.org/docs/latest/api/python/reference/pyspark.sql/api/pyspark.sql.functions.udf.html)

<WHCode>

<div warehouse="Snowpark">

<File name='models/my_python_model.py'>

```python
import snowflake.snowpark.types as T
import snowflake.snowpark.functions as F
import numpy

def register_udf_add_random():
    add_random = F.udf(
        # –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å 'lambda' –¥–ª—è –ø—Ä–æ—Å—Ç–æ–≥–æ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–≥–æ –ø–æ–≤–µ–¥–µ–Ω–∏—è
        lambda x: x + numpy.random.normal(),
        return_type=T.FloatType(),
        input_types=[T.FloatType()]
    )
    return add_random

def model(dbt, session):

    dbt.config(
        materialized = "table",
        packages = ["numpy"]
    )

    temps_df = dbt.ref("temperatures")

    add_random = register_udf_add_random()

    # —Å–æ–≥—Ä–µ–µ–º, –∫—Ç–æ –∑–Ω–∞–µ—Ç –Ω–∞ —Å–∫–æ–ª—å–∫–æ
    df = temps_df.withColumn("degree_plus_random", add_random("degree"))
    return df
```

</File>

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** –ò–∑-–∑–∞ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è Snowpark –≤ –Ω–∞—Å—Ç–æ—è—â–µ–µ –≤—Ä–µ–º—è –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å —Å–ª–æ–∂–Ω—ã–µ –∏–º–µ–Ω–æ–≤–∞–Ω–Ω—ã–µ UDF –≤ —Ö—Ä–∞–Ω–∏–º—ã—Ö –ø—Ä–æ—Ü–µ–¥—É—Ä–∞—Ö –∏, —Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ, –≤ Python –º–æ–¥–µ–ª—è—Ö dbt. –ú—ã –ø–ª–∞–Ω–∏—Ä—É–µ–º –¥–æ–±–∞–≤–∏—Ç—å –Ω–∞—Ç–∏–≤–Ω—É—é –ø–æ–¥–¥–µ—Ä–∂–∫—É Python UDF –≤ –∫–∞—á–µ—Å—Ç–≤–µ —Ä–µ—Å—É—Ä—Å–∞ –ø—Ä–æ–µ–∫—Ç–∞/DAG –≤ –±—É–¥—É—â–∏—Ö –≤—ã–ø—É—Å–∫–∞—Ö. –ù–∞ –¥–∞–Ω–Ω—ã–π –º–æ–º–µ–Ω—Ç, –µ—Å–ª–∏ –≤—ã —Ö–æ—Ç–∏—Ç–µ —Å–æ–∑–¥–∞—Ç—å "–≤–µ–∫—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—É—é" Python UDF —á–µ—Ä–µ–∑ Batch API, –º—ã —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º –ª–∏–±–æ:
- –ù–∞–ø–∏—Å–∞—Ç—å [`create function`](https://docs.snowflake.com/en/developer-guide/udf/python/udf-python-batch.html) –≤–Ω—É—Ç—Ä–∏ SQL –º–∞–∫—Ä–æ—Å–∞, —á—Ç–æ–±—ã –∑–∞–ø—É—Å—Ç–∏—Ç—å –∫–∞–∫ hook –∏–ª–∏ run-operation
- [–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∏–∑ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω–æ–≥–æ —Ñ–∞–π–ª–∞](https://docs.snowflake.com/en/developer-guide/snowpark/python/creating-udfs#creating-a-udf-from-a-python-source-file) –≤ –≤–∞—à–µ–º Python –∫–æ–¥–µ –º–æ–¥–µ–ª–∏

</div>

<div warehouse="PySpark">

<File name='models/my_python_model.py'>

```python
import pyspark.sql.types as T
import pyspark.sql.functions as F
import numpy

# –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ '–¥–µ–∫–æ—Ä–∞—Ç–æ—Ä' –¥–ª—è –±–æ–ª–µ–µ —á–∏—Ç–∞–µ–º–æ–≥–æ –∫–æ–¥–∞
@F.udf(returnType=T.DoubleType())
def add_random(x):
    random_number = numpy.random.normal()
    return x + random_number

def model(dbt, session):
    dbt.config(
        materialized = "table",
        packages = ["numpy"]
    )

    temps_df = dbt.ref("temperatures")

    # —Å–æ–≥—Ä–µ–µ–º, –∫—Ç–æ –∑–Ω–∞–µ—Ç –Ω–∞ —Å–∫–æ–ª—å–∫–æ
    df = temps_df.withColumn("degree_plus_random", add_random("degree"))
    return df
```

</File>

</div>

</WHCode>

#### –ü–æ–≤—Ç–æ—Ä–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞

–í –Ω–∞—Å—Ç–æ—è—â–µ–µ –≤—Ä–µ–º—è —Ñ—É–Ω–∫—Ü–∏–∏ Python, –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–µ –≤ –æ–¥–Ω–æ–π –º–æ–¥–µ–ª–∏ dbt, –Ω–µ –º–æ–≥—É—Ç –±—ã—Ç—å –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã –∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω—ã –≤ –¥—Ä—É–≥–∏—Ö –º–æ–¥–µ–ª—è—Ö. –≠—Ç–æ —Ç–æ, —á—Ç–æ dbt Labs —Ö–æ—Ç–µ–ª –±—ã –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å, –ø–æ—ç—Ç–æ–º—É –º—ã —Ä–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞–µ–º –¥–≤–∞ —à–∞–±–ª–æ–Ω–∞:

- –°–æ–∑–¥–∞–Ω–∏–µ –∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è **"–∏–º–µ–Ω–æ–≤–∞–Ω–Ω—ã—Ö" UDF** &mdash; –≠—Ç–æ—Ç –ø—Ä–æ—Ü–µ—Å—Å –æ—Ç–ª–∏—á–∞–µ—Ç—Å—è –Ω–∞ —Ä–∞–∑–Ω—ã—Ö –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞—Ö –¥–∞–Ω–Ω—ã—Ö –∏ –∏–º–µ–µ—Ç –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –ø–æ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏. –ù–∞–ø—Ä–∏–º–µ—Ä, Snowpark –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç [–≤–µ–∫—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–µ UDF](https://docs.snowflake.com/en/developer-guide/udf/python/udf-python-batch.html) –¥–ª—è —Ñ—É–Ω–∫—Ü–∏–π, –ø–æ–¥–æ–±–Ω—ã—Ö pandas, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–∂–Ω–æ –≤—ã–ø–æ–ª–Ω—è—Ç—å –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ.
- **–ß–∞—Å—Ç–Ω—ã–µ Python –ø–∞–∫–µ—Ç—ã** &mdash; –í –¥–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –∫ –∏–º–ø–æ—Ä—Ç—É –ø–æ–≤—Ç–æ—Ä–Ω–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π –∏–∑ –ø—É–±–ª–∏—á–Ω—ã—Ö –ø–∞–∫–µ—Ç–æ–≤ PyPI, –º–Ω–æ–≥–∏–µ –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã –¥–∞–Ω–Ω—ã—Ö –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç –∑–∞–≥—Ä—É–∑–∫—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö Python –∞–∫—Ç–∏–≤–æ–≤ –∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—é –∏—Ö –∫–∞–∫ –ø–∞–∫–µ—Ç–æ–≤. –ü—Ä–æ—Ü–µ—Å—Å –∑–∞–≥—Ä—É–∑–∫–∏ –≤—ã–≥–ª—è–¥–∏—Ç –ø–æ-—Ä–∞–∑–Ω–æ–º—É –Ω–∞ —Ä–∞–∑–Ω—ã—Ö –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞—Ö, –Ω–æ —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏–π `import` –≤–∞—à–µ–≥–æ –∫–æ–¥–∞ –≤—ã–≥–ª—è–¥–∏—Ç –æ–¥–∏–Ω–∞–∫–æ–≤–æ.

:::note ‚ùì –í–æ–ø—Ä–æ—Å—ã dbt

- –î–æ–ª–∂–µ–Ω –ª–∏ dbt –∏–≥—Ä–∞—Ç—å —Ä–æ–ª—å –≤ –∞–±—Å—Ç—Ä–∞–≥–∏—Ä–æ–≤–∞–Ω–∏–∏ –Ω–∞–¥ UDF? –î–æ–ª–∂–µ–Ω –ª–∏ dbt –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å –Ω–æ–≤—ã–π —Ç–∏–ø —É–∑–ª–∞ DAG, `function`? –ë—É–¥–µ—Ç –ª–∏ –æ—Å–Ω–æ–≤–Ω—ã–º —Å–ª—É—á–∞–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –ø–æ–≤—Ç–æ—Ä–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞ –≤ Python –º–æ–¥–µ–ª—è—Ö –∏–ª–∏ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–π –Ω–∞ —è–∑—ã–∫–µ Python, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–∂–Ω–æ –≤—ã–∑—ã–≤–∞—Ç—å –∏–∑ SQL –º–æ–¥–µ–ª–µ–π?
- –ö–∞–∫ dbt –º–æ–∂–µ—Ç –ø–æ–º–æ—á—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –∏–ª–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ —á–∞—Å—Ç–Ω—ã—Ö Python –∞–∫—Ç–∏–≤–æ–≤? –≠—Ç–æ –Ω–æ–≤–∞—è —Ñ–æ—Ä–º–∞ `dbt deps`?
- –ö–∞–∫ dbt –º–æ–∂–µ—Ç –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –∫–æ—Ç–æ—Ä—ã–µ —Ö–æ—Ç—è—Ç —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏? –ï—Å–ª–∏ –æ–Ω–∏ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã –∫–∞–∫ UDF: "—é–Ω–∏—Ç-—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ" –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö? –ï—Å–ª–∏ "—á–∏—Å—Ç—ã–µ" —Ñ—É–Ω–∫—Ü–∏–∏ –≤ –ø–∞–∫–µ—Ç–∞—Ö: –ø–æ–æ—â—Ä—è—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `pytest`?

üí¨ –û–±—Å—É–∂–¥–µ–Ω–∏–µ: ["Python –º–æ–¥–µ–ª–∏: –ø–∞–∫–µ—Ç, —Ö—Ä–∞–Ω–µ–Ω–∏–µ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–≤/–æ–±—ä–µ–∫—Ç–æ–≤ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ UDF –≤ dbt"](https://github.com/dbt-labs/dbt-core/discussions/5741)
:::

### API –∏ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å DataFrame

–ó–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–µ –¥–µ—Å—è—Ç–∏–ª–µ—Ç–∏–µ –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ –ª—é–¥–µ–π, –ø–∏—à—É—â–∏—Ö [—Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö](https://www.getdbt.com/analytics-engineering/transformation/) –Ω–∞ Python, –ø—Ä–∏–Ω—è–ª–∏ <Term id="dataframe">DataFrame</Term> –≤ –∫–∞—á–µ—Å—Ç–≤–µ —Å–≤–æ–µ–π –æ–±—â–µ–π –∞–±—Å—Ç—Ä–∞–∫—Ü–∏–∏. dbt —Å–ª–µ–¥—É–µ—Ç —ç—Ç–æ–π –∫–æ–Ω–≤–µ–Ω—Ü–∏–∏, –≤–æ–∑–≤—Ä–∞—â–∞—è `ref()` –∏ `source()` –∫–∞–∫ DataFrame, –∏ –æ–∂–∏–¥–∞–µ—Ç, —á—Ç–æ –≤—Å–µ Python –º–æ–¥–µ–ª–∏ –±—É–¥—É—Ç –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å DataFrame.

DataFrame ‚Äî —ç—Ç–æ –¥–≤—É–º–µ—Ä–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö (—Å—Ç—Ä–æ–∫–∏ –∏ —Å—Ç–æ–ª–±—Ü—ã). –û–Ω –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —É–¥–æ–±–Ω—ã–µ –º–µ—Ç–æ–¥—ã –¥–ª—è –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è —ç—Ç–∏—Ö –¥–∞–Ω–Ω—ã—Ö –∏ —Å–æ–∑–¥–∞–Ω–∏—è –Ω–æ–≤—ã—Ö —Å—Ç–æ–ª–±—Ü–æ–≤ –∏–∑ –≤—ã—á–∏—Å–ª–µ–Ω–∏–π, –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã—Ö –Ω–∞ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö —Å—Ç–æ–ª–±—Ü–∞—Ö. –û–Ω —Ç–∞–∫–∂–µ –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç —É–¥–æ–±–Ω—ã–µ —Å–ø–æ—Å–æ–±—ã –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ–≥–æ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏ –ª–æ–∫–∞–ª—å–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ –∏–ª–∏ –≤ –Ω–æ—É—Ç–±—É–∫–µ.

–ù–∞ —ç—Ç–æ–º —Å–æ–≥–ª–∞—Å–∏–µ –∑–∞–∫–∞–Ω—á–∏–≤–∞–µ—Ç—Å—è. –°—É—â–µ—Å—Ç–≤—É–µ—Ç –º–Ω–æ–∂–µ—Å—Ç–≤–æ —Ñ—Ä–µ–π–º–≤–æ—Ä–∫–æ–≤ —Å —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–º–∏ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–∞–º–∏ –∏ API –¥–ª—è DataFrame. –ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ [pandas](https://pandas.pydata.org/docs/) –ø—Ä–µ–¥–ª–æ–∂–∏–ª–∞ –æ–¥–∏–Ω –∏–∑ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã—Ö API –¥–ª—è DataFrame, –∏ –µ–µ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å —è–≤–ª—è–µ—Ç—Å—è –Ω–∞–∏–±–æ–ª–µ–µ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–Ω—ã–º –¥–ª—è –∏–∑—É—á–µ–Ω–∏—è –Ω–æ–≤—ã–º–∏ —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–∞–º–∏ –ø–æ –¥–∞–Ω–Ω—ã–º. –ë–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ –Ω–æ–≤—ã—Ö API –¥–ª—è DataFrame —Å–æ–≤–º–µ—Å—Ç–∏–º—ã —Å —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–æ–º pandas, —Ö–æ—Ç—è –Ω–µ–º–Ω–æ–≥–∏–µ –º–æ–≥—É—Ç –ø—Ä–µ–¥–ª–æ–∂–∏—Ç—å –∏–¥–µ–∞–ª—å–Ω—É—é —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å. –≠—Ç–æ –≤–µ—Ä–Ω–æ –¥–ª—è Snowpark –∏ PySpark, —É –∫–æ—Ç–æ—Ä—ã—Ö –µ—Å—Ç—å —Å–≤–æ–∏ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–µ API –¥–ª—è DataFrame.

–ü—Ä–∏ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ Python –º–æ–¥–µ–ª–∏ –≤—ã –±—É–¥–µ—Ç–µ –∑–∞–¥–∞–≤–∞—Ç—å—Å—è —Å–ª–µ–¥—É—é—â–∏–º–∏ –≤–æ–ø—Ä–æ—Å–∞–º–∏:

**–ü–æ—á–µ–º—É pandas?** &mdash; –≠—Ç–æ —Å–∞–º—ã–π —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–Ω—ã–π API –¥–ª—è DataFrame. –û–Ω —É–ø—Ä–æ—â–∞–µ—Ç –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ –≤—ã–±–æ—Ä–æ—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –∏ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫—É —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–π –ª–æ–∫–∞–ª—å–Ω–æ. –í—ã –º–æ–∂–µ—Ç–µ "–ø—Ä–æ–¥–≤–∏–≥–∞—Ç—å" —Å–≤–æ–π –∫–æ–¥ –∫–∞–∫ –µ—Å—Ç—å –≤ –º–æ–¥–µ–ª–∏ dbt –∏ –∑–∞–ø—É—Å–∫–∞—Ç—å –µ–≥–æ –≤ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–µ–Ω–Ω–æ–π —Å—Ä–µ–¥–µ –¥–ª—è –Ω–µ–±–æ–ª—å—à–∏—Ö –Ω–∞–±–æ—Ä–æ–≤ –¥–∞–Ω–Ω—ã—Ö.

**–ü–æ—á–µ–º—É _–Ω–µ_ pandas?** &mdash; –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å. pandas –≤—ã–ø–æ–ª–Ω—è–µ—Ç "–æ–¥–Ω–æ—É–∑–ª–æ–≤—ã–µ" —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–∏, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ –º–æ–≥—É—Ç –≤–æ—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –ø–∞—Ä–∞–ª–ª–µ–ª–∏–∑–º–æ–º –∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–º–∏ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è–º–∏, –ø—Ä–µ–¥–ª–∞–≥–∞–µ–º—ã–º–∏ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–º–∏ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞–º–∏ –¥–∞–Ω–Ω—ã—Ö. –≠—Ç–æ –±—ã—Å—Ç—Ä–æ —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –ø—Ä–æ–±–ª–µ–º–æ–π, –∫–æ–≥–¥–∞ –≤—ã —Ä–∞–±–æ—Ç–∞–µ—Ç–µ —Å –±–æ–ª—å—à–∏–º–∏ –Ω–∞–±–æ—Ä–∞–º–∏ –¥–∞–Ω–Ω—ã—Ö. –ù–µ–∫–æ—Ç–æ—Ä—ã–µ –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã –¥–∞–Ω–Ω—ã—Ö –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –¥–ª—è –∫–æ–¥–∞, –Ω–∞–ø–∏—Å–∞–Ω–Ω–æ–≥–æ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º API DataFrame pandas, –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞—è –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç—å –≤ –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω—ã—Ö —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞—Ö. –ù–∞–ø—Ä–∏–º–µ—Ä, [pandas –Ω–∞ PySpark](https://spark.apache.org/docs/latest/api/python/getting_started/quickstart_ps.html) –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç –ø–æ–¥–¥–µ—Ä–∂–∫—É 95% —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏ pandas, –∏—Å–ø–æ–ª—å–∑—É—è —Ç–æ—Ç –∂–µ API, –ø—Ä–∏ —ç—Ç–æ–º –≤—Å–µ –µ—â–µ –∏—Å–ø–æ–ª—å–∑—É—è –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—É—é –æ–±—Ä–∞–±–æ—Ç–∫—É.

:::note ‚ùì –í–æ–ø—Ä–æ—Å—ã dbt
- –ü—Ä–∏ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ –Ω–æ–≤–æ–π Python –º–æ–¥–µ–ª–∏ dbt, —Å–ª–µ–¥—É–µ—Ç –ª–∏ —Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞—Ç—å —Å–∏–Ω—Ç–∞–∫—Å–∏—Å –≤ —Å—Ç–∏–ª–µ pandas –¥–ª—è –±—ã—Å—Ç—Ä–æ–π –∏—Ç–µ—Ä–∞—Ü–∏–∏, –∞ –∑–∞—Ç–µ–º —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥?
- –ö–∞–∫–∏–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ —Å –æ—Ç–∫—Ä—ã—Ç—ã–º –∏—Å—Ö–æ–¥–Ω—ã–º –∫–æ–¥–æ–º –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—é—Ç —É–±–µ–¥–∏—Ç–µ–ª—å–Ω—ã–µ –∞–±—Å—Ç—Ä–∞–∫—Ü–∏–∏ –¥–ª—è —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –¥–≤–∏–∂–∫–æ–≤ –¥–∞–Ω–Ω—ã—Ö –∏ —Å–ø–µ—Ü–∏—Ñ–∏—á–µ—Å–∫–∏—Ö –¥–ª—è –ø–æ—Å—Ç–∞–≤—â–∏–∫–æ–≤ API?
- –î–æ–ª–∂–µ–Ω –ª–∏ dbt –ø—ã—Ç–∞—Ç—å—Å—è –∏–≥—Ä–∞—Ç—å –¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω—É—é —Ä–æ–ª—å –≤ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∞—Ü–∏–∏ —Å—Ä–µ–¥–∏ –Ω–∏—Ö?

üí¨ –û–±—Å—É–∂–¥–µ–Ω–∏–µ: ["Python –º–æ–¥–µ–ª–∏: –ø—Ä–æ–±–ª–µ–º–∞ pandas (–∏ –≤–æ–∑–º–æ–∂–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ)"](https://github.com/dbt-labs/dbt-core/discussions/5738)
:::

## –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è

Python –º–æ–¥–µ–ª–∏ –∏–º–µ—é—Ç –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏, –∫–æ—Ç–æ—Ä—ã—Ö –Ω–µ—Ç —É SQL –º–æ–¥–µ–ª–µ–π. –£ –Ω–∏—Ö —Ç–∞–∫–∂–µ –µ—Å—Ç—å –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –Ω–µ–¥–æ—Å—Ç–∞—Ç–∫–∏ –ø–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é —Å SQL –º–æ–¥–µ–ª—è–º–∏:

- **–í—Ä–µ–º—è –∏ —Å—Ç–æ–∏–º–æ—Å—Ç—å.** Python –º–æ–¥–µ–ª–∏ —Ä–∞–±–æ—Ç–∞—é—Ç –º–µ–¥–ª–µ–Ω–Ω–µ–µ, —á–µ–º SQL –º–æ–¥–µ–ª–∏, –∏ –æ–±–ª–∞—á–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã, –∫–æ—Ç–æ—Ä—ã–µ –∏—Ö –∑–∞–ø—É—Å–∫–∞—é—Ç, –º–æ–≥—É—Ç –±—ã—Ç—å –¥–æ—Ä–æ–∂–µ. –ó–∞–ø—É—Å–∫ Python —Ç—Ä–µ–±—É–µ—Ç –±–æ–ª–µ–µ –æ–±—â–∏—Ö –≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω—ã—Ö —Ä–µ—Å—É—Ä—Å–æ–≤. –≠—Ç–∏ –≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã –º–æ–≥—É—Ç –∏–Ω–æ–≥–¥–∞ –Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è –Ω–∞ –æ—Ç–¥–µ–ª—å–Ω–æ–π —Å–ª—É–∂–±–µ –∏–ª–∏ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ –æ—Ç –≤–∞—à–∏—Ö SQL –º–æ–¥–µ–ª–µ–π. **–û–¥–Ω–∞–∫–æ:** –ú—ã —Å—á–∏—Ç–∞–µ–º, —á—Ç–æ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ Python –º–æ–¥–µ–ª–µ–π —á–µ—Ä–µ–∑ dbt ‚Äî —Å –µ–¥–∏–Ω–æ–π –ª–∏–Ω–∏–µ–π, —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º –∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–µ–π ‚Äî —Å —á–µ–ª–æ–≤–µ—á–µ—Å–∫–æ–π —Ç–æ—á–∫–∏ –∑—Ä–µ–Ω–∏—è, **–∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ** –±—ã—Å—Ç—Ä–µ–µ –∏ –¥–µ—à–µ–≤–ª–µ. –ü–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é —Å —ç—Ç–∏–º, —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ –æ—Ç–¥–µ–ª—å–Ω–æ–π –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–ª—è –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏–∏ Python —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–π –≤ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–µ–Ω–Ω–æ–π —Å—Ä–µ–¥–µ –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å dbt –∑–∞–Ω–∏–º–∞–µ—Ç –≥–æ—Ä–∞–∑–¥–æ –±–æ–ª—å—à–µ –≤—Ä–µ–º–µ–Ω–∏ –∏ –¥–æ—Ä–æ–∂–µ.
- **–†–∞–∑–ª–∏—á–∏—è –≤ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–µ** –µ—â–µ –±–æ–ª–µ–µ –≤—ã—Ä–∞–∂–µ–Ω—ã. –ó–∞ —ç—Ç–∏ –≥–æ–¥—ã dbt —Å–¥–µ–ª–∞–ª –º–Ω–æ–≥–æ–µ, –∏—Å–ø–æ–ª—å–∑—É—è —à–∞–±–ª–æ–Ω—ã –¥–∏—Å–ø–µ—Ç—á–µ—Ä–∏–∑–∞—Ü–∏–∏ –∏ –ø–∞–∫–µ—Ç—ã, —Ç–∞–∫–∏–µ –∫–∞–∫ `dbt_utils`, —á—Ç–æ–±—ã –∞–±—Å—Ç—Ä–∞–≥–∏—Ä–æ–≤–∞—Ç—å —Ä–∞–∑–ª–∏—á–∏—è –≤ SQL –¥–∏–∞–ª–µ–∫—Ç–∞—Ö —Å—Ä–µ–¥–∏ –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö —Ö—Ä–∞–Ω–∏–ª–∏—â –¥–∞–Ω–Ω—ã—Ö. Python –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç **–≥–æ—Ä–∞–∑–¥–æ** –±–æ–ª–µ–µ —à–∏—Ä–æ–∫–æ–µ –ø–æ–ª–µ –¥–ª—è –∏–≥—Ä—ã. –ï—Å–ª–∏ –µ—Å—Ç—å –ø—è—Ç—å —Å–ø–æ—Å–æ–±–æ–≤ —Å–¥–µ–ª–∞—Ç—å —á—Ç–æ-—Ç–æ –≤ SQL, —Ç–æ –≤ Python –∏—Ö 500, –≤—Å–µ —Å —Ä–∞–∑–ª–∏—á–Ω–æ–π –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å—é –∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∞–º. –≠—Ç–∏ –≤–∞—Ä–∏–∞–Ω—Ç—ã –º–æ–≥—É—Ç –±—ã—Ç—å –æ—à–µ–ª–æ–º–ª—è—é—â–∏–º–∏. –ö–∞–∫ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—â–∏–µ dbt, –º—ã –±—É–¥–µ–º —É—á–∏—Ç—å—Å—è —É –ø–µ—Ä–µ–¥–æ–≤—ã—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤, —Ä–µ—à–∞—é—â–∏—Ö —ç—Ç—É –ø—Ä–æ–±–ª–µ–º—É, –∏ –¥–µ–ª–∏—Ç—å—Å—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è–º–∏ –ø–æ –º–µ—Ä–µ –∏—Ö —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏.
- **–≠—Ç–∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –æ—á–µ–Ω—å –Ω–æ–≤—ã–µ.** –ü–æ –º–µ—Ä–µ —Ç–æ–≥–æ, –∫–∞–∫ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞ –¥–∞–Ω–Ω—ã—Ö —Ä–∞–∑—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç –Ω–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏, –º—ã –æ–∂–∏–¥–∞–µ–º, —á—Ç–æ –æ–Ω–∏ –ø—Ä–µ–¥–ª–æ–∂–∞—Ç –±–æ–ª–µ–µ –¥–µ—à–µ–≤—ã–µ, –±—ã—Å—Ç—Ä—ã–µ –∏ –∏–Ω—Ç—É–∏—Ç–∏–≤–Ω–æ –ø–æ–Ω—è—Ç–Ω—ã–µ –º–µ—Ö–∞–Ω–∏–∑–º—ã –¥–ª—è —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è Python —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–π. **–ú—ã –æ—Å—Ç–∞–≤–ª—è–µ–º –∑–∞ —Å–æ–±–æ–π –ø—Ä–∞–≤–æ –∏–∑–º–µ–Ω–∏—Ç—å –æ—Å–Ω–æ–≤–Ω—É—é —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è Python –º–æ–¥–µ–ª–µ–π –≤ –±—É–¥—É—â–∏—Ö –≤—ã–ø—É—Å–∫–∞—Ö.** –ù–∞—à–∞ –ø—Ä–∏–≤–µ—Ä–∂–µ–Ω–Ω–æ—Å—Ç—å –≤–∞–º –∑–∞–∫–ª—é—á–∞–µ—Ç—Å—è –≤ –∫–æ–¥–µ –≤ –≤–∞—à–∏—Ö —Ñ–∞–π–ª–∞—Ö –º–æ–¥–µ–ª–∏ `.py`, —Å–ª–µ–¥—É—è –¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–º –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—è–º –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è–º, –∫–æ—Ç–æ—Ä—ã–µ –º—ã –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ–º –∑–¥–µ—Å—å.
- **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ø–æ–¥–¥–µ—Ä–∂–∫–∏ `print()`.** –ü–ª–∞—Ç—Ñ–æ—Ä–º–∞ –¥–∞–Ω–Ω—ã—Ö –∑–∞–ø—É—Å–∫–∞–µ—Ç –∏ –∫–æ–º–ø–∏–ª–∏—Ä—É–µ—Ç –≤–∞—à—É Python –º–æ–¥–µ–ª—å –±–µ–∑ –Ω–∞–¥–∑–æ—Ä–∞ dbt. –≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –æ–Ω–∞ –Ω–µ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç –≤—ã–≤–æ–¥ –∫–æ–º–∞–Ω–¥, —Ç–∞–∫–∏—Ö –∫–∞–∫ –≤—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è Python [`print()`](https://docs.python.org/3/library/functions.html#print) –≤ –ª–æ–≥–∞—Ö dbt.

- <Expandable alt_header="–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é print() –≤ Python –º–æ–¥–µ–ª—è—Ö">

    –°–ª–µ–¥—É—é—â–µ–µ –æ–±—ä—è—Å–Ω—è–µ—Ç –¥—Ä—É–≥–∏–µ –º–µ—Ç–æ–¥—ã, –∫–æ—Ç–æ—Ä—ã–µ –≤—ã –º–æ–∂–µ—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏, —Ç–∞–∫–∏–µ –∫–∞–∫ –∑–∞–ø–∏—Å—å —Å–æ–æ–±—â–µ–Ω–∏–π –≤ —Å—Ç–æ–ª–±–µ—Ü dataframe:
    
    - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ª–æ–≥–æ–≤ –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã: –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ª–æ–≥–∏ –≤–∞—à–µ–π –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏ –≤–∞—à–∏—Ö Python –º–æ–¥–µ–ª–µ–π.
    - –í–æ–∑–≤—Ä–∞—Ç –ª–æ–≥–æ–≤ –∫–∞–∫ dataframe: –°–æ–∑–¥–∞–π—Ç–µ dataframe, —Å–æ–¥–µ—Ä–∂–∞—â–∏–π –≤–∞—à–∏ –ª–æ–≥–∏, –∏ –ø–æ—Å—Ç—Ä–æ–π—Ç–µ –µ–≥–æ –≤ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ.
    - –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –ª–æ–∫–∞–ª—å–Ω–æ —Å DuckDB: –¢–µ—Å—Ç–∏—Ä—É–π—Ç–µ –∏ –æ—Ç–ª–∞–∂–∏–≤–∞–π—Ç–µ –≤–∞—à–∏ –º–æ–¥–µ–ª–∏ –ª–æ–∫–∞–ª—å–Ω–æ, –∏—Å–ø–æ–ª—å–∑—É—è DuckDB, –ø–µ—Ä–µ–¥ –∏—Ö —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ–º.
    
    –í–æ—Ç –ø—Ä–∏–º–µ—Ä –æ—Ç–ª–∞–¥–∫–∏ –≤ Python –º–æ–¥–µ–ª–∏:

    ```python
    def model(dbt, session):
        dbt.config(
            materialized = "table"
        )
    
        df = dbt.ref("my_source_table").df()
    
        # –û–¥–∏–Ω –∏–∑ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ –æ—Ç–ª–∞–¥–∫–∏: –∑–∞–ø–∏—Å—å —Å–æ–æ–±—â–µ–Ω–∏–π –≤–æ –≤—Ä–µ–º–µ–Ω–Ω—ã–π —Å—Ç–æ–ª–±–µ—Ü —Ç–∞–±–ª–∏—Ü—ã
        # –ü–ª—é—Å—ã: –≤–∏–¥–∏–º–æ—Å—Ç—å
        # –ú–∏–Ω—É—Å—ã: –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–µ—Ç, –µ—Å–ª–∏ —Ç–∞–±–ª–∏—Ü–∞ –Ω–µ —Å—Ç—Ä–æ–∏—Ç—Å—è –ø–æ –∫–∞–∫–æ–π-—Ç–æ –ø—Ä–∏—á–∏–Ω–µ
        msg = "—á—Ç–æ-—Ç–æ"
        df["debugging"] = f"–ú–æ–µ –æ—Ç–ª–∞–¥–æ—á–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –∑–¥–µ—Å—å: {msg}"
    
        return df
    ```
    </Expandable>

–ö–∞–∫ –æ–±—â–µ–µ –ø—Ä–∞–≤–∏–ª–æ, –µ—Å–ª–∏ –µ—Å—Ç—å —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—è, –∫–æ—Ç–æ—Ä—É—é –≤—ã –º–æ–≥–ª–∏ –±—ã –Ω–∞–ø–∏—Å–∞—Ç—å –æ–¥–∏–Ω–∞–∫–æ–≤–æ —Ö–æ—Ä–æ—à–æ –Ω–∞ SQL –∏–ª–∏ Python, –º—ã —Å—á–∏—Ç–∞–µ–º, —á—Ç–æ —Ö–æ—Ä–æ—à–æ –Ω–∞–ø–∏—Å–∞–Ω–Ω—ã–π SQL –ø—Ä–µ–¥–ø–æ—á—Ç–∏—Ç–µ–ª—å–Ω–µ–µ: –æ–Ω –±–æ–ª–µ–µ –¥–æ—Å—Ç—É–ø–µ–Ω –¥–ª—è –±–æ–ª—å—à–µ–≥–æ —á–∏—Å–ª–∞ –∫–æ–ª–ª–µ–≥, –∏ –µ–≥–æ –ª–µ–≥—á–µ –Ω–∞–ø–∏—Å–∞—Ç—å —Ç–∞–∫, —á—Ç–æ–±—ã –æ–Ω –±—ã–ª –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω—ã–º –≤ –º–∞—Å—à—Ç–∞–±–µ. –ï—Å–ª–∏ –µ—Å—Ç—å —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—è, –∫–æ—Ç–æ—Ä—É—é –≤—ã _–Ω–µ –º–æ–∂–µ—Ç–µ_ –Ω–∞–ø–∏—Å–∞—Ç—å –Ω–∞ SQL, –∏–ª–∏ –≥–¥–µ –¥–µ—Å—è—Ç—å —Å—Ç—Ä–æ–∫ —ç–ª–µ–≥–∞–Ω—Ç–Ω–æ–≥–æ –∏ —Ö–æ—Ä–æ—à–æ –∞–Ω–Ω–æ—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ Python –º–æ–≥—É—Ç —Å—ç–∫–æ–Ω–æ–º–∏—Ç—å –≤–∞–º 1000 —Å—Ç—Ä–æ–∫ —Ç—Ä—É–¥–Ω–æ —á–∏—Ç–∞–µ–º–æ–≥–æ Jinja-SQL, Python ‚Äî —ç—Ç–æ –ø—É—Ç—å.

## –û–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–µ –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã –¥–∞–Ω–Ω—ã—Ö {#specific-data-platforms}

–í —Å–≤–æ–µ–º –ø–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω–æ–º –∑–∞–ø—É—Å–∫–µ Python –º–æ–¥–µ–ª–∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è –Ω–∞ —Ç—Ä–µ—Ö –∏–∑ —Å–∞–º—ã—Ö –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö –ø–ª–∞—Ç—Ñ–æ—Ä–º –¥–∞–Ω–Ω—ã—Ö: Snowflake, Databricks –∏ BigQuery/GCP (—á–µ—Ä–µ–∑ Dataproc). –ò Databricks, –∏ Dataproc –æ—Ç GCP –∏—Å–ø–æ–ª—å–∑—É—é—Ç PySpark –≤ –∫–∞—á–µ—Å—Ç–≤–µ —Ñ—Ä–µ–π–º–≤–æ—Ä–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏. Snowflake –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å–≤–æ–π —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π —Ñ—Ä–µ–π–º–≤–æ—Ä–∫, Snowpark, –∫–æ—Ç–æ—Ä—ã–π –∏–º–µ–µ—Ç –º–Ω–æ–≥–æ —Å—Ö–æ–¥—Å—Ç–≤ —Å PySpark.

<WHCode>

<div warehouse="Snowflake">

**–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞:** –í–∞–º –Ω—É–∂–Ω–æ –±—É–¥–µ—Ç [–ø—Ä–∏–∑–Ω–∞—Ç—å –∏ –ø—Ä–∏–Ω—è—Ç—å —É—Å–ª–æ–≤–∏—è —Ç—Ä–µ—Ç—å–∏—Ö —Å—Ç–æ—Ä–æ–Ω Snowflake](https://docs.snowflake.com/en/developer-guide/udf/python/udf-python-packages.html#getting-started), —á—Ç–æ–±—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–∞–∫–µ—Ç—ã Anaconda.

**–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–∞–∫–µ—Ç–æ–≤:** Snowpark –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö –ø–∞–∫–µ—Ç–æ–≤ —á–µ—Ä–µ–∑ Anaconda. –û–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∫ [–ø–æ–ª–Ω–æ–º—É —Å–ø–∏—Å–∫—É](https://repo.anaconda.com/pkgs/snowflake/) –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏. –ü–∞–∫–µ—Ç—ã —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é—Ç—Å—è –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ –≤–∞—à–µ–π –º–æ–¥–µ–ª–∏. –†–∞–∑–Ω—ã–µ –º–æ–¥–µ–ª–∏ –º–æ–≥—É—Ç –∏–º–µ—Ç—å —Ä–∞–∑–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –ø–∞–∫–µ—Ç–æ–≤. –ï—Å–ª–∏ –≤—ã –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ —Å—Ç–æ—Ä–æ–Ω–Ω–∏–µ –ø–∞–∫–µ—Ç—ã, Snowflake —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤—ã–¥–µ–ª–µ–Ω–Ω—ã–π –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–π —Å–∫–ª–∞–¥ –¥–ª—è –ª—É—á—à–µ–π –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏, –∞ –Ω–µ —Ç–æ—Ç, –∫–æ—Ç–æ—Ä—ã–π –∏–º–µ–µ—Ç –º–Ω–æ–≥–æ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.

**–í–µ—Ä—Å–∏—è Python:** –ß—Ç–æ–±—ã —É–∫–∞–∑–∞—Ç—å –¥—Ä—É–≥—É—é –≤–µ—Ä—Å–∏—é Python, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–ª–µ–¥—É—é—â—É—é –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é:

```python
def model(dbt, session):
    dbt.config(
        materialized = "table",
        python_version="3.11"
    )
```

<VersionBlock firstVersion="1.8">

**–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –≤–Ω–µ—à–Ω–µ–≥–æ –¥–æ—Å—Ç—É–ø–∞ –∏ —Å–µ–∫—Ä–µ—Ç—ã**: –ß—Ç–æ–±—ã –≤—ã–ø–æ–ª–Ω—è—Ç—å –∑–∞–ø—Ä–æ—Å—ã –∫ –≤–Ω–µ—à–Ω–∏–º API –≤ Python –º–æ–¥–µ–ª—è—Ö dbt, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ [–≤–Ω–µ—à–Ω–∏–π –¥–æ—Å—Ç—É–ø](https://docs.snowflake.com/en/developer-guide/external-network-access/external-network-access-overview) Snowflake –≤–º–µ—Å—Ç–µ —Å [—Å–µ–∫—Ä–µ—Ç–∞–º–∏](https://docs.snowflake.com/en/developer-guide/external-network-access/secret-api-reference). –í–æ—Ç –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏, –∫–æ—Ç–æ—Ä—ã–µ –≤—ã –º–æ–∂–µ—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:

```python
import pandas
import snowflake.snowpark as snowpark

def model(dbt, session: snowpark.Session):
    dbt.config(
        materialized="table",
        secrets={"secret_variable_name": "test_secret"},
        external_access_integrations=["test_external_access_integration"],
    )
    import _snowflake
    return session.create_dataframe(
        pandas.DataFrame(
            [{"secret_value": _snowflake.get_generic_secret_string('secret_variable_name')}]
        )
    )
```

</VersionBlock>

**–û "sprocs":** dbt –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç Python –º–æ–¥–µ–ª–∏ –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –≤ –≤–∏–¥–µ _—Ö—Ä–∞–Ω–∏–º—ã—Ö –ø—Ä–æ—Ü–µ–¥—É—Ä_, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –ª—é–¥–∏ –Ω–∞–∑—ã–≤–∞—é—Ç _sprocs_ –¥–ª—è –∫—Ä–∞—Ç–∫–æ—Å—Ç–∏. –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é dbt –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å _–≤—Ä–µ–º–µ–Ω–Ω—ã–µ_ –∏–ª–∏ _–∞–Ω–æ–Ω–∏–º–Ω—ã–µ_ —Ö—Ä–∞–Ω–∏–º—ã–µ –ø—Ä–æ—Ü–µ–¥—É—Ä—ã Snowpark ([–¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è](https://docs.snowflake.com/en/sql-reference/sql/call-with.html)), –∫–æ—Ç–æ—Ä—ã–µ –±—ã—Å—Ç—Ä–µ–µ –∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç –∏—Å—Ç–æ—Ä–∏—é –∑–∞–ø—Ä–æ—Å–æ–≤ —á–∏—â–µ, —á–µ–º –∏–º–µ–Ω–æ–≤–∞–Ω–Ω—ã–µ sprocs, —Å–æ–¥–µ—Ä–∂–∞—â–∏–µ —Å–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–π Python –∫–æ–¥ –≤–∞—à–µ–π –º–æ–¥–µ–ª–∏. –ß—Ç–æ–±—ã –æ—Ç–∫–ª—é—á–∏—Ç—å —ç—Ç—É —Ñ—É–Ω–∫—Ü–∏—é, —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ `use_anonymous_sproc: False` –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –≤–∞—à–µ–π –º–æ–¥–µ–ª–∏. 

**–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:** ["–†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞: Snowpark Python"](https://docs.snowflake.com/en/developer-guide/snowpark/python/index.html)

#### –°—Ç–æ—Ä–æ–Ω–Ω–∏–µ –ø–∞–∫–µ—Ç—ã Snowflake

–ß—Ç–æ–±—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å—Ç–æ—Ä–æ–Ω–Ω–∏–π –ø–∞–∫–µ—Ç Snowflake, –∫–æ—Ç–æ—Ä—ã–π –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω –≤ Snowflake Anaconda, –∑–∞–≥—Ä—É–∑–∏—Ç–µ –≤–∞—à –ø–∞–∫–µ—Ç, —Å–ª–µ–¥—É—è [—ç—Ç–æ–º—É –ø—Ä–∏–º–µ—Ä—É](https://docs.snowflake.com/en/developer-guide/udf/python/udf-python-packages#importing-packages-through-a-snowflake-stage), –∞ –∑–∞—Ç–µ–º –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä `imports` –≤ Python –º–æ–¥–µ–ª–∏ dbt, —á—Ç–æ–±—ã —Å—Å—ã–ª–∞—Ç—å—Å—è –Ω–∞ zip —Ñ–∞–π–ª –≤ –≤–∞—à–µ–π Snowflake —Å—Ç–∞–¥–∏–∏.

–í–æ—Ç –ø–æ–ª–Ω—ã–π –ø—Ä–∏–º–µ—Ä –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º zip —Ñ–∞–π–ª–∞, –≤–∫–ª—é—á–∞—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `imports` –≤ Python –º–æ–¥–µ–ª–∏:

```python

def model(dbt, session):
    # –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –º–æ–¥–µ–ª–∏
    dbt.config(
        materialized="table",
        imports=["@mystage/mycustompackage.zip"],  # –£–∫–∞–∂–∏—Ç–µ –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ –≤–Ω–µ—à–Ω–µ–≥–æ –ø–∞–∫–µ—Ç–∞
    )
    
    # –ü—Ä–∏–º–µ—Ä –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –ø–∞–∫–µ—Ç–∞
    # (–ü—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ—Ç—Å—è, —á—Ç–æ `some_external_package` –∏–º–µ–µ—Ç —Ñ—É–Ω–∫—Ü–∏—é, –∫–æ—Ç–æ—Ä—É—é –º—ã –º–æ–∂–µ–º –≤—ã–∑–≤–∞—Ç—å)
    data = {
        "name": ["Alice", "Bob", "Charlie"],
        "score": [85, 90, 88]
    }
    df = pd.DataFrame(data)

    # –û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö —Å –ø–æ–º–æ—â—å—é –≤–Ω–µ—à–Ω–µ–≥–æ –ø–∞–∫–µ—Ç–∞
    df["adjusted_score"] = df["score"].apply(lambda x: some_external_package.adjust_score(x))
    
    # –í–æ–∑–≤—Ä–∞—â–∞–µ–º DataFrame –∫–∞–∫ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –º–æ–¥–µ–ª–∏
    return df

```

–î–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ —ç—Ç–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –æ–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∫ [–¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ Snowflake](https://community.snowflake.com/s/article/how-to-use-other-python-packages-in-snowpark) –æ –∑–∞–≥—Ä—É–∑–∫–µ –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ –¥—Ä—É–≥–∏—Ö python –ø–∞–∫–µ—Ç–æ–≤ –≤ Snowpark, –Ω–µ –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–Ω—ã—Ö –Ω–∞ –∫–∞–Ω–∞–ª–µ Anaconda Snowflake.


</div>

<div warehouse="Databricks">

**–ú–µ—Ç–æ–¥—ã –æ—Ç–ø—Ä–∞–≤–∫–∏:** Databricks –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –º–µ—Ö–∞–Ω–∏–∑–º–æ–≤ –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ PySpark –∫–æ–¥–∞, –∫–∞–∂–¥—ã–π –∏–∑ –∫–æ—Ç–æ—Ä—ã—Ö –∏–º–µ–µ—Ç –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞. –ù–µ–∫–æ—Ç–æ—Ä—ã–µ –∏–∑ –Ω–∏—Ö –ª—É—á—à–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç –∏—Ç–µ—Ä–∞—Ç–∏–≤–Ω—É—é —Ä–∞–∑—Ä–∞–±–æ—Ç–∫—É, –≤ —Ç–æ –≤—Ä–µ–º—è –∫–∞–∫ –¥—Ä—É–≥–∏–µ –ª—É—á—à–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç –±–æ–ª–µ–µ –¥–µ—à–µ–≤—ã–µ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–µ–Ω–Ω—ã–µ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è. –í–∞—Ä–∏–∞–Ω—Ç—ã —Å–ª–µ–¥—É—é—â–∏–µ:
- `all_purpose_cluster` (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é): dbt –±—É–¥–µ—Ç –∑–∞–ø—É—Å–∫–∞—Ç—å –≤–∞—à—É Python –º–æ–¥–µ–ª—å, –∏—Å–ø–æ–ª—å–∑—É—è –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –∫–ª–∞—Å—Ç–µ—Ä–∞, –Ω–∞—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π –∫–∞–∫ `cluster` –≤ –≤–∞—à–µ–º –ø—Ä–æ—Ñ–∏–ª–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∏–ª–∏ –¥–ª—è —ç—Ç–æ–π –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –º–æ–¥–µ–ª–∏. –≠—Ç–∏ –∫–ª–∞—Å—Ç–µ—Ä—ã –¥–æ—Ä–æ–∂–µ, –Ω–æ —Ç–∞–∫–∂–µ –≥–æ—Ä–∞–∑–¥–æ –±–æ–ª–µ–µ –æ—Ç–∑—ã–≤—á–∏–≤—ã. –ú—ã —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª–∞—Å—Ç–µ—Ä –æ–±—â–µ–≥–æ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è –¥–ª—è –±–æ–ª–µ–µ –±—ã—Å—Ç—Ä–æ–π –∏—Ç–µ—Ä–∞—Ü–∏–∏ –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏.
  - `create_notebook: True`: dbt –∑–∞–≥—Ä—É–∑–∏—Ç —Å–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–π PySpark –∫–æ–¥ –≤–∞—à–µ–π –º–æ–¥–µ–ª–∏ –≤ –Ω–æ—É—Ç–±—É–∫ –≤ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ –∏–º–µ–Ω `/Shared/dbt_python_model/{schema}`, –≥–¥–µ `{schema}` ‚Äî —ç—Ç–æ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è —Å—Ö–µ–º–∞ –¥–ª—è –º–æ–¥–µ–ª–∏, –∏ –≤—ã–ø–æ–ª–Ω–∏—Ç —ç—Ç–æ—Ç –Ω–æ—É—Ç–±—É–∫ –¥–ª—è –∑–∞–ø—É—Å–∫–∞ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –∫–ª–∞—Å—Ç–µ—Ä–∞ –æ–±—â–µ–≥–æ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è. –ü—Ä–∏–≤–ª–µ–∫–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å —ç—Ç–æ–≥–æ –ø–æ–¥—Ö–æ–¥–∞ –∑–∞–∫–ª—é—á–∞–µ—Ç—Å—è –≤ —Ç–æ–º, —á—Ç–æ –≤—ã –º–æ–∂–µ—Ç–µ –ª–µ–≥–∫–æ –æ—Ç–∫—Ä—ã—Ç—å –Ω–æ—É—Ç–±—É–∫ –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ Databricks –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏ –∏–ª–∏ —Ç–æ–Ω–∫–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ –≤–∞—à–µ–π –º–æ–¥–µ–ª–∏. –ù–µ –∑–∞–±—É–¥—å—Ç–µ —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –ª—é–±—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –≤–∞—à –∫–æ–¥ –º–æ–¥–µ–ª–∏ dbt `.py` –ø–µ—Ä–µ–¥ –ø–æ–≤—Ç–æ—Ä–Ω—ã–º –∑–∞–ø—É—Å–∫–æ–º.
  - `create_notebook: False` (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é): dbt –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å [Command API](https://docs.databricks.com/dev-tools/api/1.2/index.html#run-a-command), –∫–æ—Ç–æ—Ä—ã–π –Ω–µ–º–Ω–æ–≥–æ –±—ã—Å—Ç—Ä–µ–µ.
- `job_cluster`: dbt –∑–∞–≥—Ä—É–∑–∏—Ç —Å–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–π PySpark –∫–æ–¥ –≤–∞—à–µ–π –º–æ–¥–µ–ª–∏ –≤ –Ω–æ—É—Ç–±—É–∫ –≤ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ –∏–º–µ–Ω `/Shared/dbt_python_model/{schema}`, –≥–¥–µ `{schema}` ‚Äî —ç—Ç–æ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è —Å—Ö–µ–º–∞ –¥–ª—è –º–æ–¥–µ–ª–∏, –∏ –≤—ã–ø–æ–ª–Ω–∏—Ç —ç—Ç–æ—Ç –Ω–æ—É—Ç–±—É–∫ –¥–ª—è –∑–∞–ø—É—Å–∫–∞ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –∫—Ä–∞—Ç–∫–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ –∫–ª–∞—Å—Ç–µ—Ä–∞ –∑–∞–¥–∞–Ω–∏–π. –î–ª—è –∫–∞–∂–¥–æ–π Python –º–æ–¥–µ–ª–∏ Databricks –ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è –∑–∞–ø—É—Å—Ç–∏—Ç—å –∫–ª–∞—Å—Ç–µ—Ä, –≤—ã–ø–æ–ª–Ω–∏—Ç—å PySpark —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—é –º–æ–¥–µ–ª–∏, –∞ –∑–∞—Ç–µ–º –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∫–ª–∞—Å—Ç–µ—Ä. –¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, –∫–ª–∞—Å—Ç–µ—Ä—ã –∑–∞–¥–∞–Ω–∏–π –∑–∞–Ω–∏–º–∞—é—Ç –±–æ–ª—å—à–µ –≤—Ä–µ–º–µ–Ω–∏ –¥–æ –∏ –ø–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –º–æ–¥–µ–ª–∏, –Ω–æ –æ–Ω–∏ —Ç–∞–∫–∂–µ –º–µ–Ω–µ–µ –¥–æ—Ä–æ–≥–∏, –ø–æ—ç—Ç–æ–º—É –º—ã —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º –∏—Ö –¥–ª—è –±–æ–ª–µ–µ –¥–ª–∏—Ç–µ–ª—å–Ω—ã—Ö Python –º–æ–¥–µ–ª–µ–π –≤ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–µ–Ω–Ω–æ–π —Å—Ä–µ–¥–µ. –ß—Ç–æ–±—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –º–µ—Ç–æ–¥ –æ—Ç–ø—Ä–∞–≤–∫–∏ `job_cluster`, –≤–∞—à–∞ –º–æ–¥–µ–ª—å –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞ —Å `job_cluster_config`, –∫–æ—Ç–æ—Ä—ã–π –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Å–≤–æ–π—Å—Ç–≤–∞ –∫–ª—é—á-–∑–Ω–∞—á–µ–Ω–∏–µ –¥–ª—è `new_cluster`, –∫–∞–∫ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–æ –≤ [JobRunsSubmit API](https://docs.databricks.com/dev-tools/api/latest/jobs.html#operation/JobsRunsSubmit).

–í—ã –º–æ–∂–µ—Ç–µ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å `submission_method` –∫–∞–∂–¥–æ–π –º–æ–¥–µ–ª–∏ –≤—Å–µ–º–∏ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–º–∏ —Å–ø–æ—Å–æ–±–∞–º–∏, –∫–æ—Ç–æ—Ä—ã–µ –≤—ã –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç–µ –¥–ª—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏:

```python
def model(dbt, session):
    dbt.config(
        submission_method="all_purpose_cluster",
        create_notebook=True,
        cluster_id="abcd-1234-wxyz"
    )
    ...
```
```yml
version: 2
models:
  - name: my_python_model
    config:
      submission_method: job_cluster
      job_cluster_config:
        spark_version: ...
        node_type_id: ...
```
```yml
# dbt_project.yml
models:
  project_name:
    subfolder:
      # —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–Ω–∞—á–µ–Ω–∏—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –¥–ª—è –≤—Å–µ—Ö .py –º–æ–¥–µ–ª–µ–π, –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã—Ö –≤ —ç—Ç–æ–π –ø–æ–¥–ø–∞–ø–∫–µ
      +submission_method: all_purpose_cluster
      +create_notebook: False
      +cluster_id: abcd-1234-wxyz
```

–ï—Å–ª–∏ –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ, `dbt-spark` –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: –∫–ª–∞—Å—Ç–µ—Ä –æ–±—â–µ–≥–æ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è (–æ—Å–Ω–æ–≤–∞–Ω–Ω—ã–π –Ω–∞ `cluster` –≤ –≤–∞—à–µ–º –ø—Ä–æ—Ñ–∏–ª–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è) –±–µ–∑ —Å–æ–∑–¥–∞–Ω–∏—è –Ω–æ—É—Ç–±—É–∫–∞. –ê–¥–∞–ø—Ç–µ—Ä `dbt-databricks` –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–ª–∞—Å—Ç–µ—Ä, –Ω–∞—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π –≤ `http_path`. –ú—ã —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º —è–≤–Ω–æ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—Ç—å –∫–ª–∞—Å—Ç–µ—Ä—ã –¥–ª—è Python –º–æ–¥–µ–ª–µ–π –≤ –ø—Ä–æ–µ–∫—Ç–∞—Ö Databricks.

**–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–∞–∫–µ—Ç–æ–≤:** –ü—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ –∫–ª–∞—Å—Ç–µ—Ä–æ–≤ –æ–±—â–µ–≥–æ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è –º—ã —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å –ø–∞–∫–µ—Ç—ã, –∫–æ—Ç–æ—Ä—ã–µ –≤—ã –±—É–¥–µ—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –≤–∞—à–∏—Ö Python –º–æ–¥–µ–ª–µ–π.

**–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:**
- [–°–∏–Ω—Ç–∞–∫—Å–∏—Å PySpark DataFrame](https://spark.apache.org/docs/latest/api/python/reference/pyspark.sql/api/pyspark.sql.DataFrame.html)
- [Databricks: –í–≤–µ–¥–µ–Ω–∏–µ –≤ DataFrame - Python](https://docs.databricks.com/spark/latest/dataframes-datasets/introduction-to-dataframes-python.html)

</div>

<div warehouse="BigQuery">

–ê–¥–∞–ø—Ç–µ—Ä `dbt-bigquery` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å–µ—Ä–≤–∏—Å –ø–æ–¥ –Ω–∞–∑–≤–∞–Ω–∏–µ–º Dataproc –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –≤–∞—à–∏—Ö Python –º–æ–¥–µ–ª–µ–π –∫–∞–∫ PySpark –∑–∞–¥–∞–Ω–∏–π. –≠—Ç–æ—Ç Python/PySpark –∫–æ–¥ –±—É–¥–µ—Ç —á–∏—Ç–∞—Ç—å –∏–∑ –≤–∞—à–∏—Ö —Ç–∞–±–ª–∏—Ü –∏ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–π –≤ BigQuery, –≤—ã–ø–æ–ª–Ω—è—Ç—å –≤—Å–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –≤ Dataproc –∏ –∑–∞–ø–∏—Å—ã–≤–∞—Ç—å —Ñ–∏–Ω–∞–ª—å–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç –æ–±—Ä–∞—Ç–Ω–æ –≤ BigQuery.

**–ú–µ—Ç–æ–¥—ã –æ—Ç–ø—Ä–∞–≤–∫–∏.** Dataproc –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –¥–≤–∞ –º–µ—Ç–æ–¥–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏: `serverless` –∏ `cluster`. Dataproc Serverless –Ω–µ —Ç—Ä–µ–±—É–µ—Ç –≥–æ—Ç–æ–≤–æ–≥–æ –∫–ª–∞—Å—Ç–µ—Ä–∞, —á—Ç–æ —ç–∫–æ–Ω–æ–º–∏—Ç –Ω–∞ —Ö–ª–æ–ø–æ—Ç–∞—Ö –∏ –∑–∞—Ç—Ä–∞—Ç–∞—Ö ‚Äî –Ω–æ –æ–Ω –º–µ–¥–ª–µ–Ω–Ω–µ–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –∏ –≥–æ—Ä–∞–∑–¥–æ –±–æ–ª–µ–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω —Å —Ç–æ—á–∫–∏ –∑—Ä–µ–Ω–∏—è –¥–æ—Å—Ç—É–ø–Ω–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏. –ù–∞–ø—Ä–∏–º–µ—Ä, Dataproc Serverless –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Ç–æ–ª—å–∫–æ –Ω–µ–±–æ–ª—å—à–æ–π –Ω–∞–±–æ—Ä Python –ø–∞–∫–µ—Ç–æ–≤, —Ö–æ—Ç—è –æ–Ω –≤–∫–ª—é—á–∞–µ—Ç `pandas`, `numpy` –∏ `scikit-learn`. (–°–º. –ø–æ–ª–Ω—ã–π —Å–ø–∏—Å–æ–∫ [–∑–¥–µ—Å—å](https://cloud.google.com/dataproc-serverless/docs/guides/custom-containers#example_custom_container_image_build), –≤ —Ä–∞–∑–¥–µ–ª–µ "–°–ª–µ–¥—É—é—â–∏–µ –ø–∞–∫–µ—Ç—ã —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –≤ –æ–±—Ä–∞–∑–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é"). –¢–æ–≥–¥–∞ –∫–∞–∫, —Å–æ–∑–¥–∞–≤–∞—è –∫–ª–∞—Å—Ç–µ—Ä Dataproc –∑–∞—Ä–∞–Ω–µ–µ, –≤—ã –º–æ–∂–µ—Ç–µ —Ç–æ—á–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –∫–ª–∞—Å—Ç–µ—Ä–∞, —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ª—é–±—ã–µ –ø–∞–∫–µ—Ç—ã PyPI, –∫–æ—Ç–æ—Ä—ã–µ –≤–∞–º –Ω—É–∂–Ω—ã, –∏ –≤–æ—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –±–æ–ª–µ–µ –±—ã—Å—Ç—Ä—ã–º–∏ –∏ –æ—Ç–∑—ã–≤—á–∏–≤—ã–º–∏ —Å—Ä–µ–¥–∞–º–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è.

–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –º–µ—Ç–æ–¥ –æ—Ç–ø—Ä–∞–≤–∫–∏ `cluster` —Å –≤—ã–¥–µ–ª–µ–Ω–Ω—ã–º–∏ –∫–ª–∞—Å—Ç–µ—Ä–∞–º–∏ Dataproc, –∫–æ—Ç–æ—Ä—ã–µ –≤—ã –∏–ª–∏ –≤–∞—à–∞ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è —É–ø—Ä–∞–≤–ª—è–µ—Ç–µ. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –º–µ—Ç–æ–¥ –æ—Ç–ø—Ä–∞–≤–∫–∏ `serverless`, —á—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫–ª–∞—Å—Ç–µ—Ä–æ–º Spark. –ü–æ—Å–ª–µ–¥–Ω–∏–π –º–æ–∂–µ—Ç –±—ã—Ç—å –±—ã—Å—Ç—Ä–µ–µ –¥–ª—è –Ω–∞—á–∞–ª–∞ —Ä–∞–±–æ—Ç—ã, –Ω–æ –æ–±–∞ –ø–æ–¥—Ö–æ–¥—è—Ç –¥–ª—è –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–∞.

**–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞:**
- –°–æ–∑–¥–∞–π—Ç–µ –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π [Cloud Storage bucket](https://cloud.google.com/storage/docs/creating-buckets)
- –í–∫–ª—é—á–∏—Ç–µ Dataproc API –¥–ª—è –≤–∞—à–µ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞ + —Ä–µ–≥–∏–æ–Ω–∞
- –ï—Å–ª–∏ –≤—ã –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ –º–µ—Ç–æ–¥ –æ—Ç–ø—Ä–∞–≤–∫–∏ `cluster`: –°–æ–∑–¥–∞–π—Ç–µ –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π [–∫–ª–∞—Å—Ç–µ—Ä Dataproc](https://cloud.google.com/dataproc/docs/guides/create-cluster) —Å [–∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–µ–π —Å–æ–µ–¥–∏–Ω–∏—Ç–µ–ª—è Spark BigQuery](https://github.com/GoogleCloudDataproc/initialization-actions/tree/master/connectors#bigquery-connectors). (Google —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –¥–µ–π—Å—Ç–≤–∏–µ –≤ –≤–∞—à —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π Cloud Storage bucket, –∞ –Ω–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø—Ä–∏–º–µ—Ä –≤–µ—Ä—Å–∏–∏, –ø–æ–∫–∞–∑–∞–Ω–Ω–æ–π –Ω–∞ —Å–∫—Ä–∏–Ω—à–æ—Ç–µ)

<Lightbox src="/img/docs/building-a-dbt-project/building-models/python-models/dataproc-connector-initialization.png" title="–î–æ–±–∞–≤—å—Ç–µ —Å–æ–µ–¥–∏–Ω–∏—Ç–µ–ª—å Spark BigQuery –∫–∞–∫ –¥–µ–π—Å—Ç–≤–∏–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏"/>

–°–ª–µ–¥—É—é—â–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã –¥–ª—è –∑–∞–ø—É—Å–∫–∞ Python –º–æ–¥–µ–ª–µ–π –Ω–∞ Dataproc. –í—ã –º–æ–∂–µ—Ç–µ –¥–æ–±–∞–≤–∏—Ç—å –∏—Ö –≤ –≤–∞—à [–ø—Ä–æ—Ñ–∏–ª—å BigQuery](/docs/core/connect-data-platform/bigquery-setup#running-python-models-on-dataproc) –∏–ª–∏ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –∏—Ö –Ω–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö Python –º–æ–¥–µ–ª—è—Ö:
- `gcs_bucket`: –•—Ä–∞–Ω–∏–ª–∏—â–µ, –≤ –∫–æ—Ç–æ—Ä–æ–µ dbt –∑–∞–≥—Ä—É–∑–∏—Ç —Å–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–π PySpark –∫–æ–¥ –≤–∞—à–µ–π –º–æ–¥–µ–ª–∏.
- `dataproc_region`: –†–µ–≥–∏–æ–Ω GCP, –≤ –∫–æ—Ç–æ—Ä–æ–º –≤—ã –≤–∫–ª—é—á–∏–ª–∏ Dataproc (–Ω–∞–ø—Ä–∏–º–µ—Ä, `us-central1`).
- `dataproc_cluster_name`: –ò–º—è –∫–ª–∞—Å—Ç–µ—Ä–∞ Dataproc, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è Python –º–æ–¥–µ–ª–∏ (–≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ PySpark –∑–∞–¥–∞–Ω–∏—è). –¢—Ä–µ–±—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ `submission_method: cluster`.

```python
def model(dbt, session):
    dbt.config(
        submission_method="cluster",
        dataproc_cluster_name="my-favorite-cluster"
    )
    ...
```
```yml
version: 2
models:
  - name: my_python_model
    config:
      submission_method: serverless
```

Python –º–æ–¥–µ–ª–∏, —Ä–∞–±–æ—Ç–∞—é—â–∏–µ –Ω–∞ Dataproc Serverless, –º–æ–≥—É—Ç –±—ã—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã –≤ –≤–∞—à–µ–º [–ø—Ä–æ—Ñ–∏–ª–µ BigQuery](/docs/core/connect-data-platform/bigquery-setup#running-python-models-on-dataproc).

–õ—é–±–æ–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∏–ª–∏ —É—á–µ—Ç–Ω–∞—è –∑–∞–ø–∏—Å—å —Å–ª—É–∂–±—ã, –∫–æ—Ç–æ—Ä–∞—è –∑–∞–ø—É—Å–∫–∞–µ—Ç Python –º–æ–¥–µ–ª–∏ dbt, –±—É–¥–µ—Ç –Ω—É–∂–¥–∞—Ç—å—Å—è –≤ —Å–ª–µ–¥—É—é—â–∏—Ö —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è—Ö (–≤ –¥–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –∫ —Ç—Ä–µ–±—É–µ–º—ã–º —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è–º BigQuery) ([–¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è](https://cloud.google.com/dataproc/docs/concepts/iam/iam)):
```
dataproc.batches.create
dataproc.clusters.use
dataproc.jobs.create
dataproc.jobs.get
dataproc.operations.get
dataproc.operations.list
storage.buckets.get
storage.objects.create
storage.objects.delete
```

**–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–∞–∫–µ—Ç–æ–≤:** –ï—Å–ª–∏ –≤—ã –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ –∫–ª–∞—Å—Ç–µ—Ä Dataproc (–≤ –æ—Ç–ª–∏—á–∏–µ –æ—Ç Dataproc Serverless), –≤—ã –º–æ–∂–µ—Ç–µ –¥–æ–±–∞–≤–∏—Ç—å —Å—Ç–æ—Ä–æ–Ω–Ω–∏–µ –ø–∞–∫–µ—Ç—ã –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∫–ª–∞—Å—Ç–µ—Ä–∞.

Google —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å Python –ø–∞–∫–µ—Ç—ã –Ω–∞ –∫–ª–∞—Å—Ç–µ—Ä—ã Dataproc —á–µ—Ä–µ–∑ –¥–µ–π—Å—Ç–≤–∏—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏:
- [–ö–∞–∫ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–µ–π—Å—Ç–≤–∏—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏](https://github.com/GoogleCloudDataproc/initialization-actions/blob/master/README.md#how-initialization-actions-are-used)
- [–î–µ–π—Å—Ç–≤–∏—è –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ —á–µ—Ä–µ–∑ `pip` –∏–ª–∏ `conda`](https://github.com/GoogleCloudDataproc/initialization-actions/tree/master/python)

–í—ã —Ç–∞–∫–∂–µ –º–æ–∂–µ—Ç–µ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø–∞–∫–µ—Ç—ã –≤–æ –≤—Ä–µ–º—è —Å–æ–∑–¥–∞–Ω–∏—è –∫–ª–∞—Å—Ç–µ—Ä–∞, [–æ–ø—Ä–µ–¥–µ–ª–∏–≤ —Å–≤–æ–π—Å—Ç–≤–∞ –∫–ª–∞—Å—Ç–µ—Ä–∞](https://cloud.google.com/dataproc/docs/tutorials/python-configuration#image_version_20): `dataproc:pip.packages` –∏–ª–∏ `dataproc:conda.packages`.

<Lightbox src="/img/docs/building-a-dbt-project/building-models/python-models/dataproc-pip-packages.png" title="–î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø–∞–∫–µ—Ç–æ–≤ –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ —á–µ—Ä–µ–∑ pip –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ –∫–ª–∞—Å—Ç–µ—Ä–∞"/>

**–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:**

- [–û–±–∑–æ—Ä Dataproc](https://cloud.google.com/dataproc/docs/concepts/overview)
- [–°–æ–∑–¥–∞–Ω–∏–µ –∫–ª–∞—Å—Ç–µ—Ä–∞ Dataproc](https://cloud.google.com/dataproc/docs/guides/create-cluster)
- [–°–æ–∑–¥–∞–Ω–∏–µ Cloud Storage bucket](https://cloud.google.com/storage/docs/creating-buckets)
- [–°–∏–Ω—Ç–∞–∫—Å–∏—Å PySpark DataFrame](https://spark.apache.org/docs/latest/api/python/reference/pyspark.sql/api/pyspark.sql.DataFrame.html)

</div>

</WHCode>