---
title: "Python-–º–æ–¥–µ–ª–∏"
description: "–ù–∞—Å—Ç—Ä–æ–π–∫–∞ Python-–º–æ–¥–µ–ª–µ–π –¥–ª—è —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π –≤–∞—à–µ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞ dbt."
id: "python-models"
---

–û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ, —á—Ç–æ —Ç–æ–ª—å–∫–æ –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã–µ –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã –¥–∞–Ω–Ω—ã—Ö –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç –º–æ–¥–µ–ª–∏ `dbt-py`. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ [—Å—Ç—Ä–∞–Ω–∏—Ü—ã –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –ø–ª–∞—Ç—Ñ–æ—Ä–º](/reference/resource-configs/resource-configs), —á—Ç–æ–±—ã —É–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ Python-–º–æ–¥–µ–ª–∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è.

–ú—ã —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º –≤–∞–º:
- –ü—Ä–æ—á–∏—Ç–∞—Ç—å [–æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–µ –æ–±—Å—É–∂–¥–µ–Ω–∏–µ](https://github.com/dbt-labs/dbt-core/discussions/5261), –≤ —Ä–∞–º–∫–∞—Ö –∫–æ—Ç–æ—Ä–æ–≥–æ –±—ã–ª–∞ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∞ —ç—Ç–∞ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å.
- –í–Ω–µ—Å—Ç–∏ –≤–∫–ª–∞–¥ –≤ —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ [–ª—É—á—à–∏—Ö –ø—Ä–∞–∫—Ç–∏–∫ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ Python-–º–æ–¥–µ–ª–µ–π –≤ dbt](https://discourse.getdbt.com/t/dbt-python-model-dbt-py-best-practices/5204).
- –ü–æ–¥–µ–ª–∏—Ç—å—Å—è —Å–≤–æ–∏–º–∏ –º—ã—Å–ª—è–º–∏ –∏ –∏–¥–µ—è–º–∏ –æ [–¥–∞–ª—å–Ω–µ–π—à–∏—Ö —à–∞–≥–∞—Ö —Ä–∞–∑–≤–∏—Ç–∏—è Python-–º–æ–¥–µ–ª–µ–π](https://github.com/dbt-labs/dbt-core/discussions/5742).
- –ü—Ä–∏—Å–æ–µ–¥–∏–Ω–∏—Ç—å—Å—è –∫ –∫–∞–Ω–∞–ª—É **#<Constant name="core" />-python-models** –≤ [—Å–æ–æ–±—â–µ—Å—Ç–≤–µ dbt Community Slack](https://www.getdbt.com/community/join-the-community/).

## –û–±–∑–æ—Ä

Python –º–æ–¥–µ–ª–∏ dbt (`dbt-py`) –º–æ–≥—É—Ç –ø–æ–º–æ—á—å –≤–∞–º —Ä–µ—à–∏—Ç—å –∑–∞–¥–∞—á–∏, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ —Ä–µ—à–∏—Ç—å —Å –ø–æ–º–æ—â—å—é SQL. –í—ã –º–æ–∂–µ—Ç–µ –≤—ã–ø–æ–ª–Ω—è—Ç—å –∞–Ω–∞–ª–∏–∑—ã, –∏—Å–ø–æ–ª—å–∑—É—è –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã, –¥–æ—Å—Ç—É–ø–Ω—ã–µ –≤ —ç–∫–æ—Å–∏—Å—Ç–µ–º–µ Python —Å –æ—Ç–∫—Ä—ã—Ç—ã–º –∏—Å—Ö–æ–¥–Ω—ã–º –∫–æ–¥–æ–º, –≤–∫–ª—é—á–∞—è –ø–µ—Ä–µ–¥–æ–≤—ã–µ –ø–∞–∫–µ—Ç—ã –¥–ª—è –Ω–∞—É–∫–∏ –æ –¥–∞–Ω–Ω—ã—Ö –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏. –†–∞–Ω–µ–µ –≤–∞–º —Ç—Ä–µ–±–æ–≤–∞–ª–∞—Å—å –±—ã –æ—Ç–¥–µ–ª—å–Ω–∞—è –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –∏ –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏—è –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è Python —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–π –≤ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–µ–Ω–Ω–æ–π —Å—Ä–µ–¥–µ. Python —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–∏, –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–µ –≤ dbt, —è–≤–ª—è—é—Ç—Å—è –º–æ–¥–µ–ª—è–º–∏ –≤ –≤–∞—à–µ–º –ø—Ä–æ–µ–∫—Ç–µ —Å —Ç–µ–º–∏ –∂–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—è–º–∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è, –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ –∏ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è.

<File name='models/my_python_model.py'>

```python
import ...

def model(dbt, session):

    my_sql_model_df = dbt.ref("my_sql_model")

    final_df = ...  # —Ç–æ, —á—Ç–æ –Ω–µ–ª—å–∑—è –Ω–∞–ø–∏—Å–∞—Ç—å –Ω–∞ SQL!

    return final_df
```

</File>

<File name='models/config.yml'>

```yml

models:
  - name: my_python_model

    # –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ –≤ —Ç–æ–º –∂–µ –∫–æ–¥–µ
    description: –ú–æ—è —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—è, –Ω–∞–ø–∏—Å–∞–Ω–Ω–∞—è –Ω–∞ Python

    # –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –∏–Ω—Ç—É–∏—Ç–∏–≤–Ω–æ –∏ –ø—Ä–∏–≤—ã—á–Ω–æ
    config:
      materialized: table
      tags: ['python']

    # –¢–µ—Å—Ç–∏—Ä—É–π—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –º–æ–µ–π Python —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–∏
    columns:
      - name: id
        # –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è –¥–ª—è ¬´–∑–µ—Ä–Ω–∞¬ª (grain) —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ Python
        data_tests:
          - unique
          - not_null
    data_tests:
      # –ù–∞–ø–∏—à–∏—Ç–µ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—É—é –ª–æ–≥–∏–∫—É –≤–∞–ª–∏–¥–∞—Ü–∏–∏ (–Ω–∞ SQL) –¥–ª—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ Python
      - [custom_generic_test](/best-practices/writing-custom-generic-tests)
```

</File>

<!--- TODO: –∫–∞–∫ —Å–¥–µ–ª–∞—Ç—å —ç—Ç–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –±–æ–ª—å—à–µ? --->
<Lightbox src="/img/docs/building-a-dbt-project/building-models/python-models/python-model-dag.png" title="SQL + Python, –≤–º–µ—Å—Ç–µ –Ω–∞–∫–æ–Ω–µ—Ü" style="width:200%"/>

–ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —É—Å–ª–æ–≤–∏—è –¥–ª—è Python –º–æ–¥–µ–ª–µ–π dbt –≤–∫–ª—é—á–∞—é—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∞–¥–∞–ø—Ç–µ—Ä–∞ –¥–ª—è –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã –¥–∞–Ω–Ω—ã—Ö, –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—â–µ–π –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ Python. –í Python –º–æ–¥–µ–ª–∏ dbt –≤–µ—Å—å Python –∫–æ–¥ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è —É–¥–∞–ª–µ–Ω–Ω–æ –Ω–∞ –ø–ª–∞—Ç—Ñ–æ—Ä–º–µ. –ù–∏—á–µ–≥–æ –∏–∑ —ç—Ç–æ–≥–æ –Ω–µ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è dbt –ª–æ–∫–∞–ª—å–Ω–æ. –ú—ã –≤–µ—Ä–∏–º –≤ —á–µ—Ç–∫–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ _–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –º–æ–¥–µ–ª–∏_ –æ—Ç _–≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –º–æ–¥–µ–ª–∏_. –í —ç—Ç–æ–º –∏ –≤–æ –º–Ω–æ–≥–∏—Ö –¥—Ä—É–≥–∏—Ö –∞—Å–ø–µ–∫—Ç–∞—Ö –ø–æ–¥—Ö–æ–¥ dbt –∫ Python –º–æ–¥–µ–ª—è–º –æ—Ç—Ä–∞–∂–∞–µ—Ç –µ–≥–æ –¥–∞–≤–Ω–∏–π –ø–æ–¥—Ö–æ–¥ –∫ –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏—é –¥–∞–Ω–Ω—ã—Ö –≤ SQL.

–ú—ã –Ω–∞–ø–∏—Å–∞–ª–∏ —ç—Ç–æ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ, –ø—Ä–µ–¥–ø–æ–ª–∞–≥–∞—è, —á—Ç–æ –≤—ã –∑–Ω–∞–∫–æ–º—ã —Å dbt. –ï—Å–ª–∏ –≤—ã –Ω–∏–∫–æ–≥–¥–∞ —Ä–∞–Ω—å—à–µ –Ω–µ –ø–∏—Å–∞–ª–∏ –º–æ–¥–µ–ª—å dbt, –º—ã —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º –Ω–∞—á–∞—Ç—å —Å —á—Ç–µ–Ω–∏—è [dbt Models](/docs/build/models). –ù–∞ –ø—Ä–æ—Ç—è–∂–µ–Ω–∏–∏ –≤—Å–µ–≥–æ —Ç–µ–∫—Å—Ç–∞ –º—ã –±—É–¥–µ–º –ø—Ä–æ–≤–æ–¥–∏—Ç—å –ø–∞—Ä–∞–ª–ª–µ–ª–∏ –º–µ–∂–¥—É Python –º–æ–¥–µ–ª—è–º–∏ –∏ SQL –º–æ–¥–µ–ª—è–º–∏, –∞ —Ç–∞–∫–∂–µ —á–µ—Ç–∫–æ —É–∫–∞–∑—ã–≤–∞—Ç—å –∏—Ö —Ä–∞–∑–ª–∏—á–∏—è.

### –ß—Ç–æ —Ç–∞–∫–æ–µ Python –º–æ–¥–µ–ª—å?

Python –º–æ–¥–µ–ª—å dbt ‚Äî —ç—Ç–æ —Ñ—É–Ω–∫—Ü–∏—è, –∫–æ—Ç–æ—Ä–∞—è —á–∏—Ç–∞–µ—Ç –∏—Å—Ç–æ—á–Ω–∏–∫–∏ dbt –∏–ª–∏ –¥—Ä—É–≥–∏–µ –º–æ–¥–µ–ª–∏, –ø—Ä–∏–º–µ–Ω—è–µ—Ç —Å–µ—Ä–∏—é —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–π –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–Ω—ã–π –Ω–∞–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö. –û–ø–µ—Ä–∞—Ü–∏–∏ <Term id="dataframe">DataFrame</Term> –æ–ø—Ä–µ–¥–µ–ª—è—é—Ç –Ω–∞—á–∞–ª—å–Ω—ã–µ —Ç–æ—á–∫–∏, –∫–æ–Ω–µ—á–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∏ –∫–∞–∂–¥—ã–π —à–∞–≥ –Ω–∞ –ø—É—Ç–∏.

–≠—Ç–æ –ø–æ—Ö–æ–∂–µ –Ω–∞ —Ä–æ–ª—å <Term id="cte">CTE</Term> –≤ SQL –º–æ–¥–µ–ª—è—Ö dbt. –ú—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º CTE –¥–ª—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –∏–∑ –≤—ã—à–µ—Å—Ç–æ—è—â–∏—Ö –Ω–∞–±–æ—Ä–æ–≤ –¥–∞–Ω–Ω—ã—Ö, –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è (–∏ –∏–º–µ–Ω–æ–≤–∞–Ω–∏—è) —Å–µ—Ä–∏–∏ –∑–Ω–∞—á–∏–º—ã—Ö —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–π –∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Å –ø–æ–º–æ—â—å—é —Ñ–∏–Ω–∞–ª—å–Ω–æ–≥–æ –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞ `select`. –í—ã –º–æ–∂–µ—Ç–µ –∑–∞–ø—É—Å—Ç–∏—Ç—å —Å–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞–Ω–Ω—É—é –≤–µ—Ä—Å–∏—é SQL –º–æ–¥–µ–ª–∏ dbt, —á—Ç–æ–±—ã —É–≤–∏–¥–µ—Ç—å –¥–∞–Ω–Ω—ã–µ, –≤–∫–ª—é—á–µ–Ω–Ω—ã–µ –≤ —Ä–µ–∑—É–ª—å—Ç–∏—Ä—É—é—â–µ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –∏–ª–∏ —Ç–∞–±–ª–∏—Ü—É. –ö–æ–≥–¥–∞ –≤—ã –≤—ã–ø–æ–ª–Ω—è–µ—Ç–µ `dbt run`, dbt –æ–±–æ—Ä–∞—á–∏–≤–∞–µ—Ç —ç—Ç–æ—Ç –∑–∞–ø—Ä–æ—Å –≤ `create view`, `create table` –∏–ª–∏ –±–æ–ª–µ–µ —Å–ª–æ–∂–Ω—ã–µ DDL, —á—Ç–æ–±—ã —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –µ–≥–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö.

–í–º–µ—Å—Ç–æ —Ñ–∏–Ω–∞–ª—å–Ω–æ–≥–æ –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞ `select` –∫–∞–∂–¥–∞—è Python –º–æ–¥–µ–ª—å –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ñ–∏–Ω–∞–ª—å–Ω—ã–π DataFrame. –ö–∞–∂–¥–∞—è –æ–ø–µ—Ä–∞—Ü–∏—è DataFrame "–ª–µ–Ω–∏–≤–æ –æ—Ü–µ–Ω–∏–≤–∞–µ—Ç—Å—è". –í –ø—Ä–æ—Ü–µ—Å—Å–µ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –≤—ã –º–æ–∂–µ—Ç–µ –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ –ø—Ä–æ—Å–º–æ—Ç—Ä–µ—Ç—å –µ–≥–æ –¥–∞–Ω–Ω—ã–µ, –∏—Å–ø–æ–ª—å–∑—É—è –º–µ—Ç–æ–¥—ã, —Ç–∞–∫–∏–µ –∫–∞–∫ `.show()` –∏–ª–∏ `.head()`. –ö–æ–≥–¥–∞ –≤—ã –∑–∞–ø—É—Å–∫–∞–µ—Ç–µ Python –º–æ–¥–µ–ª—å, –ø–æ–ª–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Ñ–∏–Ω–∞–ª—å–Ω–æ–≥–æ DataFrame –±—É–¥–µ—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω –∫–∞–∫ —Ç–∞–±–ª–∏—Ü–∞ –≤ –≤–∞—à–µ–º —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –¥–∞–Ω–Ω—ã—Ö.

Python –º–æ–¥–µ–ª–∏ dbt –∏–º–µ—é—Ç –¥–æ—Å—Ç—É–ø –ø–æ—á—Ç–∏ –∫–æ –≤—Å–µ–º —Ç–µ–º –∂–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏, —á—Ç–æ –∏ SQL –º–æ–¥–µ–ª–∏. –í—ã –º–æ–∂–µ—Ç–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –∏ –¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –∏—Ö, –¥–æ–±–∞–≤–ª—è—Ç—å —Å–≤–æ–π—Å—Ç–≤–∞ `tags` –∏ `meta`, –∞ —Ç–∞–∫–∂–µ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—Ç—å –¥–æ—Å—Ç—É–ø –∫ –∏—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º –¥—Ä—É–≥–∏–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º. –í—ã –º–æ–∂–µ—Ç–µ –≤—ã–±–∏—Ä–∞—Ç—å –∏—Ö –ø–æ –∏–º–µ–Ω–∏, –ø—É—Ç–∏ –∫ —Ñ–∞–π–ª—É, –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è–º, –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–æ–≥–æ, —è–≤–ª—è—é—Ç—Å—è –ª–∏ –æ–Ω–∏ –≤—ã—à–µ—Å—Ç–æ—è—â–∏–º–∏ –∏–ª–∏ –Ω–∏–∂–µ—Å—Ç–æ—è—â–∏–º–∏ –ø–æ –æ—Ç–Ω–æ—à–µ–Ω–∏—é –∫ –¥—Ä—É–≥–æ–π –º–æ–¥–µ–ª–∏, –∏–ª–∏ –µ—Å–ª–∏ –æ–Ω–∏ –±—ã–ª–∏ –∏–∑–º–µ–Ω–µ–Ω—ã –ø–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é —Å –ø—Ä–µ–¥—ã–¥—É—â–∏–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º –ø—Ä–æ–µ–∫—Ç–∞.

### –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ Python –º–æ–¥–µ–ª–∏

–ö–∞–∂–¥–∞—è Python –º–æ–¥–µ–ª—å –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ —Ñ–∞–π–ª–µ `.py` –≤ –≤–∞—à–µ–π –ø–∞–ø–∫–µ `models/`. –û–Ω–∞ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Ñ—É–Ω–∫—Ü–∏—é —Å –∏–º–µ–Ω–µ–º **`model()`**, –∫–æ—Ç–æ—Ä–∞—è –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –¥–≤–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞:
- **`dbt`**: –ö–ª–∞—Å—Å, —Å–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–π dbt Core, —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –¥–ª—è –∫–∞–∂–¥–æ–π –º–æ–¥–µ–ª–∏, –ø–æ–∑–≤–æ–ª—è–µ—Ç –≤–∞–º –∑–∞–ø—É—Å–∫–∞—Ç—å –≤–∞—à Python –∫–æ–¥ –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ –≤–∞—à–µ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞ dbt –∏ DAG.
- **`session`**: –ö–ª–∞—Å—Å, –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é—â–∏–π —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –≤–∞—à–µ–π –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã –¥–∞–Ω–Ω—ã—Ö —Å Python –±—ç–∫–µ–Ω–¥–æ–º. –°–µ—Å—Å–∏—è –Ω–µ–æ–±—Ö–æ–¥–∏–º–∞ –¥–ª—è —á—Ç–µ–Ω–∏—è —Ç–∞–±–ª–∏—Ü –∫–∞–∫ DataFrame –∏ –∑–∞–ø–∏—Å–∏ DataFrame –æ–±—Ä–∞—Ç–Ω–æ –≤ —Ç–∞–±–ª–∏—Ü—ã. –í PySpark, –ø–æ —Å–æ–≥–ª–∞—à–µ–Ω–∏—é, `SparkSession` –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è `spark` –∏ –¥–æ—Å—Ç—É–ø–µ–Ω –≥–ª–æ–±–∞–ª—å–Ω–æ. –î–ª—è —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç–∏ –º–µ–∂–¥—É –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞–º–∏ –º—ã –≤—Å–µ–≥–¥–∞ –ø–µ—Ä–µ–¥–∞–µ–º –µ–≥–æ –≤ —Ñ—É–Ω–∫—Ü–∏—é `model` –∫–∞–∫ —è–≤–Ω—ã–π –∞—Ä–≥—É–º–µ–Ω—Ç, –Ω–∞–∑—ã–≤–∞–µ–º—ã–π `session`.

–§—É–Ω–∫—Ü–∏—è `model()` –¥–æ–ª–∂–Ω–∞ –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å –æ–¥–∏–Ω DataFrame. –í Snowpark (Snowflake) —ç—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å Snowpark –∏–ª–∏ pandas DataFrame. –í BigQuery —ç—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å BigFrames, pandas –∏–ª–∏ Spark DataFrame. –ü—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ PySpark (Databricks) —ç—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å Spark, pandas –∏–ª–∏ pandas-on-Spark DataFrame. –ü–æ–¥—Ä–æ–±–Ω–µ–µ –æ –≤—ã–±–æ—Ä–µ –º–µ–∂–¥—É pandas –∏ –Ω–∞—Ç–∏–≤–Ω—ã–º–∏ DataFrame —Å–º. –≤ —Ä–∞–∑–¥–µ–ª–µ [DataFrame API + syntax](#dataframe-api-and-syntax).

–ö–æ–≥–¥–∞ –≤—ã –≤—ã–ø–æ–ª–Ω—è–µ—Ç–µ `dbt run --select python_model`, dbt –ø–æ–¥–≥–æ—Ç–æ–≤–∏—Ç –∏ –ø–µ—Ä–µ–¥–∞—Å—Ç –æ–±–∞ –∞—Ä–≥—É–º–µ–Ω—Ç–∞ (`dbt` –∏ `session`). –í—Å–µ, —á—Ç–æ –≤–∞–º –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å, —ç—Ç–æ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å —Ñ—É–Ω–∫—Ü–∏—é. –í–æ—Ç –∫–∞–∫ –¥–æ–ª–∂–Ω–∞ –≤—ã–≥–ª—è–¥–µ—Ç—å –∫–∞–∂–¥–∞—è Python –º–æ–¥–µ–ª—å:

<File name='models/my_python_model.py'>

```python
def model(dbt, session):

    ...

    return final_df
```

</File>

### –°—Å—ã–ª–∫–∏ –Ω–∞ –¥—Ä—É–≥–∏–µ –º–æ–¥–µ–ª–∏

Python –º–æ–¥–µ–ª–∏ –ø–æ–ª–Ω–æ—Å—Ç—å—é —É—á–∞—Å—Ç–≤—É—é—Ç –≤ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω–æ–º –∞—Ü–∏–∫–ª–∏—á–µ—Å–∫–æ–º –≥—Ä–∞—Ñ–µ (DAG) —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–π dbt. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –º–µ—Ç–æ–¥ `dbt.ref()` –≤ Python –º–æ–¥–µ–ª–∏, —á—Ç–æ–±—ã —á–∏—Ç–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –∏–∑ –¥—Ä—É–≥–∏—Ö –º–æ–¥–µ–ª–µ–π (SQL –∏–ª–∏ Python). –ï—Å–ª–∏ –≤—ã —Ö–æ—Ç–∏—Ç–µ —á–∏—Ç–∞—Ç—å –Ω–∞–ø—Ä—è–º—É—é –∏–∑ –∏—Å—Ö–æ–¥–Ω–æ–π —Ç–∞–±–ª–∏—Ü—ã, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `dbt.source()`. –≠—Ç–∏ –º–µ—Ç–æ–¥—ã –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç DataFrame, —É–∫–∞–∑—ã–≤–∞—é—â–∏–µ –Ω–∞ –≤—ã—à–µ—Å—Ç–æ—è—â–∏–π –∏—Å—Ç–æ—á–Ω–∏–∫, –º–æ–¥–µ–ª—å, seed –∏–ª–∏ snapshot.

<File name='models/my_python_model.py'>

```python
def model(dbt, session):

    # DataFrame, –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é—â–∏–π –≤—ã—à–µ—Å—Ç–æ—è—â—É—é –º–æ–¥–µ–ª—å
    upstream_model = dbt.ref("upstream_model_name")

    # DataFrame, –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é—â–∏–π –≤—ã—à–µ—Å—Ç–æ—è—â–∏–π –∏—Å—Ç–æ—á–Ω–∏–∫
    upstream_source = dbt.source("upstream_source_name", "table_name")

    ...
```

</File>

–ö–æ–Ω–µ—á–Ω–æ, –≤—ã –º–æ–∂–µ—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `ref()` –¥–ª—è –≤–∞—à–µ–π Python –º–æ–¥–µ–ª–∏ –≤ –Ω–∏–∂–µ—Å—Ç–æ—è—â–∏—Ö SQL –º–æ–¥–µ–ª—è—Ö:

<File name='models/downstream_model.sql'>

```sql
with upstream_python_model as (

    select * from {{ ref('my_python_model') }}

),

...
```

</File>

:::caution

–°—Å—ã–ª–∫–∏ –Ω–∞ [—ç—Ñ–µ–º–µ—Ä–Ω—ã–µ](/docs/build/materializations#ephemeral) –º–æ–¥–µ–ª–∏ –≤ –Ω–∞—Å—Ç–æ—è—â–µ–µ –≤—Ä–µ–º—è –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è (—Å–º. [–∑–∞–ø—Ä–æ—Å –Ω–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏](https://github.com/dbt-labs/dbt-core/issues/7288)) 
:::

–ù–∞—á–∏–Ω–∞—è —Å –≤–µ—Ä—Å–∏–∏ dbt 1.8, Python-–º–æ–¥–µ–ª–∏ —Ç–∞–∫–∂–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –≤–Ω—É—Ç—Ä–∏ Python f-—Å—Ç—Ä–æ–∫. –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –∑–∞–¥–∞–≤–∞—Ç—å –±–æ–ª–µ–µ –≥–∏–±–∫–∏–µ –∏ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –º–æ–¥–µ–ª–µ–π –Ω–µ–ø–æ—Å—Ä–µ–¥—Å—Ç–≤–µ–Ω–Ω–æ –≤ –≤–∞—à–µ–º Python-–∫–æ–¥–µ. –ù–∞–ø—Ä–∏–º–µ—Ä:

<File name='models/my_python_model.py'>

```python
# –†–∞–Ω–µ–µ –ø–æ–ø—ã—Ç–∫–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ –∑–Ω–∞—á–µ–Ω–∏—é –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ —Ç–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º –ø—Ä–∏–≤–æ–¥–∏–ª–∞ –∫ None
print(f"{dbt.config.get('my_var')}")  # –í—ã–≤–æ–¥ –¥–æ –∏–∑–º–µ–Ω–µ–Ω–∏—è: None

# –¢–µ–ø–µ—Ä—å –≤—ã –º–æ–∂–µ—Ç–µ –ø–æ–ª—É—á–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫ —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–æ–º—É –∑–Ω–∞—á–µ–Ω–∏—é –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
# –ü—Ä–µ–¥–ø–æ–ª–∞–≥–∞—è, —á—Ç–æ 'my_var' –Ω–∞—Å—Ç—Ä–æ–µ–Ω –Ω–∞ 5 –¥–ª—è —Ç–µ–∫—É—â–µ–π –º–æ–¥–µ–ª–∏
print(f"{dbt.config.get('my_var')}")  # –í—ã–≤–æ–¥ –ø–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è: 5
```

–≠—Ç–æ —Ç–∞–∫–∂–µ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –≤—ã –º–æ–∂–µ—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `dbt.config.get()` –≤ Python –º–æ–¥–µ–ª—è—Ö, —á—Ç–æ–±—ã –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å, —á—Ç–æ –∑–Ω–∞—á–µ–Ω–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ –¥–æ—Å—Ç—É–ø–Ω—ã –∏ –º–æ–≥—É—Ç –±—ã—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω—ã –≤ Python f-—Å—Ç—Ä–æ–∫–∞—Ö.

</File>

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Python –º–æ–¥–µ–ª–µ–π

–ö–∞–∫ –∏ SQL –º–æ–¥–µ–ª–∏, Python –º–æ–¥–µ–ª–∏ –º–æ–∂–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å —Ç—Ä–µ–º—è —Å–ø–æ—Å–æ–±–∞–º–∏:
1. –í `dbt_project.yml`, –≥–¥–µ –≤—ã –º–æ–∂–µ—Ç–µ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –º–Ω–æ–∂–µ—Å—Ç–≤–æ –º–æ–¥–µ–ª–µ–π –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ
2. –í –æ—Ç–¥–µ–ª—å–Ω–æ–º `.yml` —Ñ–∞–π–ª–µ –≤ –∫–∞—Ç–∞–ª–æ–≥–µ `models/`
3. –í–Ω—É—Ç—Ä–∏ —Ñ–∞–π–ª–∞ `.py` –º–æ–¥–µ–ª–∏, –∏—Å–ø–æ–ª—å–∑—É—è –º–µ—Ç–æ–¥ `dbt.config()`

–í—ã–∑–æ–≤ –º–µ—Ç–æ–¥–∞ `dbt.config()` —É—Å—Ç–∞–Ω–æ–≤–∏—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –¥–ª—è –≤–∞—à–µ–π –º–æ–¥–µ–ª–∏ –≤ –≤–∞—à–µ–º `.py` —Ñ–∞–π–ª–µ, –∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ –º–∞–∫—Ä–æ—Å—É `{{ config() }}` –≤ —Ñ–∞–π–ª–∞—Ö `.sql` –º–æ–¥–µ–ª–µ–π:

<File name='models/my_python_model.py'>

```python
def model(dbt, session):

    # —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
    dbt.config(materialized="table")
```

</File>

–°—É—â–µ—Å—Ç–≤—É–µ—Ç –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –Ω–∞ —Å–ª–æ–∂–Ω–æ—Å—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏, –∫–æ—Ç–æ—Ä—É—é –º–æ–∂–Ω–æ –∑–∞–¥–∞—Ç—å —Å –ø–æ–º–æ—â—å—é –º–µ—Ç–æ–¥–∞ `dbt.config()`. –û–Ω –ø—Ä–∏–Ω–∏–º–∞–µ—Ç **—Ç–æ–ª—å–∫–æ** –ª–∏—Ç–µ—Ä–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è (—Å—Ç—Ä–æ–∫–∏, –±—É–ª–µ–≤—ã –∑–Ω–∞—á–µ–Ω–∏—è –∏ —á–∏—Å–ª–æ–≤—ã–µ —Ç–∏–ø—ã), –∞ —Ç–∞–∫–∂–µ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫—É—é –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é. –ü–µ—Ä–µ–¥–∞—á–∞ –¥—Ä—É–≥–æ–π —Ñ—É–Ω–∫—Ü–∏–∏ –∏–ª–∏ –±–æ–ª–µ–µ —Å–ª–æ–∂–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∞–Ω–Ω—ã—Ö –Ω–µ–≤–æ–∑–º–æ–∂–Ω–∞.  

–ü—Ä–∏—á–∏–Ω–∞ –≤ —Ç–æ–º, —á—Ç–æ dbt **—Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏ –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç** –∞—Ä–≥—É–º–µ–Ω—Ç—ã, –ø–µ—Ä–µ–¥–∞–Ω–Ω—ã–µ –≤ `config()`, –≤–æ –≤—Ä–µ–º—è –ø–∞—Ä—Å–∏–Ω–≥–∞ –º–æ–¥–µ–ª–∏, –Ω–µ –≤—ã–ø–æ–ª–Ω—è—è –≤–∞—à Python‚Äë–∫–æ–¥. –ï—Å–ª–∏ –≤–∞–º –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –∑–∞–¥–∞—Ç—å –±–æ–ª–µ–µ —Å–ª–æ–∂–Ω—É—é –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é, –º—ã —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –µ—ë —Å –ø–æ–º–æ—â—å—é —Å–≤–æ–π—Å—Ç–≤–∞ [`config`](/reference/resource-properties/config) –≤ YAML‚Äë—Ñ–∞–π–ª–µ —Å–≤–æ–π—Å—Ç–≤.

#### –î–æ—Å—Ç—É–ø –∫ –∫–æ–Ω—Ç–µ–∫—Å—Ç—É –ø—Ä–æ–µ–∫—Ç–∞

Python –º–æ–¥–µ–ª–∏ dbt –Ω–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç Jinja –¥–ª—è —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞ —Å–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –∫–æ–¥–∞. Python –º–æ–¥–µ–ª–∏ –∏–º–µ—é—Ç –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫ –≥–ª–æ–±–∞–ª—å–Ω—ã–º –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞–º –ø—Ä–æ–µ–∫—Ç–∞ –ø–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é —Å SQL –º–æ–¥–µ–ª—è–º–∏. –≠—Ç–æ—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –∏–∑ –∫–ª–∞—Å—Å–∞ `dbt`, –ø–µ—Ä–µ–¥–∞–Ω–Ω–æ–≥–æ –≤ –∫–∞—á–µ—Å—Ç–≤–µ –∞—Ä–≥—É–º–µ–Ω—Ç–∞ —Ñ—É–Ω–∫—Ü–∏–∏ `model()`.

–ò–∑ –∫–æ—Ä–æ–±–∫–∏ –∫–ª–∞—Å—Å `dbt` –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç:
- –í–æ–∑–≤—Ä–∞—â–µ–Ω–∏–µ DataFrame, —Å—Å—ã–ª–∞—é—â–∏—Ö—Å—è –Ω–∞ –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏—è –¥—Ä—É–≥–∏—Ö —Ä–µ—Å—É—Ä—Å–æ–≤: `dbt.ref()` + `dbt.source()`
- –î–æ—Å—Ç—É–ø –∫ –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏—é –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö —Ç–µ–∫—É—â–µ–π –º–æ–¥–µ–ª–∏: `dbt.this()` (—Ç–∞–∫–∂–µ: `dbt.this.database`, `.schema`, `.identifier`)
- –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ, —è–≤–ª—è–µ—Ç—Å—è –ª–∏ —Ç–µ–∫—É—â–∏–π –∑–∞–ø—É—Å–∫ –º–æ–¥–µ–ª–∏ –∏–Ω–∫—Ä–µ–º–µ–Ω—Ç–Ω—ã–º: `dbt.is_incremental`

–≠—Ç–æ—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç –º–æ–∂–Ω–æ —Ä–∞—Å—à–∏—Ä–∏—Ç—å, ¬´–ø–æ–ª—É—á–∏–≤¬ª –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è —Å –ø–æ–º–æ—â—å—é `dbt.config.get()` –ø–æ—Å–ª–µ —Ç–æ–≥–æ, –∫–∞–∫ –æ–Ω–∏ –±—É–¥—É—Ç –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã –≤ [–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –º–æ–¥–µ–ª–∏](/reference/model-configs). –ú–µ—Ç–æ–¥ `dbt.config.get()` –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π –¥–æ—Å—Ç—É–ø –∫ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è–º –≤–Ω—É—Ç—Ä–∏ Python‚Äë–º–æ–¥–µ–ª–µ–π, —á—Ç–æ –ø–æ–≤—ã—à–∞–µ—Ç –≥–∏–±–∫–æ—Å—Ç—å –ª–æ–≥–∏–∫–∏ –º–æ–¥–µ–ª–∏. –≠—Ç–æ –≤–∫–ª—é—á–∞–µ—Ç —Ç–∞–∫–∏–µ –≤—Ö–æ–¥–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã, –∫–∞–∫ `var`, `env_var` –∏ `target`. –ï—Å–ª–∏ –≤—ã —Ö–æ—Ç–∏—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —ç—Ç–∏ –∑–Ω–∞—á–µ–Ω–∏—è –¥–ª—è —É—Å–ª–æ–≤–Ω–æ–π –ª–æ–≥–∏–∫–∏ –≤ –≤–∞—à–µ–π –º–æ–¥–µ–ª–∏, –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –∑–∞–¥–∞—Ç—å –∏—Ö —á–µ—Ä–µ–∑ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—É—é –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –≤ properties YAML‚Äë—Ñ–∞–π–ª–µ:

<File name='models/config.yml'>

```yml

models:
  - name: my_python_model
    config:
      materialized: table
      target_name: "{{ target.name }}"
      specific_var: "{{ var('SPECIFIC_VAR') }}"
      specific_env_var: "{{ env_var('SPECIFIC_ENV_VAR') }}"
```

</File>

–ó–∞—Ç–µ–º, –≤ Python –∫–æ–¥–µ –º–æ–¥–µ–ª–∏, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ñ—É–Ω–∫—Ü–∏—é `dbt.config.get()`, —á—Ç–æ–±—ã _–ø–æ–ª—É—á–∏—Ç—å –¥–æ—Å—Ç—É–ø_ –∫ –∑–Ω–∞—á–µ–Ω–∏—è–º –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π, –∫–æ—Ç–æ—Ä—ã–µ –±—ã–ª–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã:

<File name='models/my_python_model.py'>

```python
def model(dbt, session):
    target_name = dbt.config.get("target_name")
    specific_var = dbt.config.get("specific_var")
    specific_env_var = dbt.config.get("specific_env_var")

    orders_df = dbt.ref("fct_orders")

    # –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –≤ dev
    if target_name == "dev":
        orders_df = orders_df.limit(500)
```

</File>

#### Accessing custom meta values

To store custom values, use the [`meta` config](/reference/resource-configs/meta). For example, if you have a model named `my_python_model` and you want to store custom values, you can do the following:

<File name='models/schema.yml'>

```yml

models:
  - name: my_python_model
    config:
      meta:
        custom_value: "111"
        another_value: "abc"
```

</File>

Then access them in your Python model using the `dbt.config.get()` method to access the `meta` object first and then access your custom values:

<File name='models/my_python_model.py'>

```python
def model(dbt, session):
    # First, get the meta object
    meta = dbt.config.get("meta")
    
    # Then access your custom values from meta
    custom_value = meta.get("custom_value")
    another_value = meta.get("another_value")
    
    # Use your custom values in your model logic
    orders_df = dbt.ref("fct_orders")
    ...
```

</File>

#### –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

–í –¥–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –∫ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º –º–µ—Ç–æ–¥–∞–º –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ Python –º–æ–¥–µ–ª–µ–π, –≤—ã —Ç–∞–∫–∂–µ –∏–º–µ–µ—Ç–µ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π –¥–æ—Å—Ç—É–ø –∫ –∑–Ω–∞—á–µ–Ω–∏—è–º –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏, —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–º —Å –ø–æ–º–æ—â—å—é `dbt.config()` –≤ Python –º–æ–¥–µ–ª—è—Ö, –∏—Å–ø–æ–ª—å–∑—É—è f-—Å—Ç—Ä–æ–∫–∏. –≠—Ç–æ —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–π –ª–æ–≥–∏–∫–∏ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π.

<File name='models/my_python_model.py'>

```python
def model(dbt, session):
    dbt.config(materialized="table")
    
    # –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π –¥–æ—Å—Ç—É–ø –∫ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –≤ Python f-—Å—Ç—Ä–æ–∫–∞—Ö, 
    # —á—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏ –ø–æ–ª—É—á–∞—Ç—å –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∑–Ω–∞—á–µ–Ω–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏.
    # –ü—Ä–µ–¥–ø–æ–ª–∞–≥–∞—è, —á—Ç–æ 'my_var' —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –Ω–∞ 5, —ç—Ç–æ –≤—ã–≤–µ–¥–µ—Ç: Dynamic config value: 5
    print(f"Dynamic config value: {dbt.config.get('my_var')}")
```

</File>

### –ú–∞—Ç–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏–∏

Python –º–æ–¥–µ–ª–∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç —Å–ª–µ–¥—É—é—â–∏–µ –º–∞—Ç–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏–∏:
- `table` (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
- `incremental`

–ò–Ω–∫—Ä–µ–º–µ–Ω—Ç–Ω—ã–µ Python –º–æ–¥–µ–ª–∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç –≤—Å–µ —Ç–µ –∂–µ [–∏–Ω–∫—Ä–µ–º–µ–Ω—Ç–Ω—ã–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏](/docs/build/incremental-strategy), —á—Ç–æ –∏ –∏—Ö SQL –∞–Ω–∞–ª–æ–≥–∏. –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –∑–∞–≤–∏—Å—è—Ç –æ—Ç –≤–∞—à–µ–≥–æ –∞–¥–∞–ø—Ç–µ—Ä–∞. –ù–∞–ø—Ä–∏–º–µ—Ä, –∏–Ω–∫—Ä–µ–º–µ–Ω—Ç–Ω—ã–µ –º–æ–¥–µ–ª–∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è –Ω–∞ BigQuery —Å Dataproc –¥–ª—è —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ `merge`; —Å—Ç—Ä–∞—Ç–µ–≥–∏—è `insert_overwrite` –ø–æ–∫–∞ –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è.

Python –º–æ–¥–µ–ª–∏ –Ω–µ –º–æ–≥—É—Ç –±—ã—Ç—å –º–∞—Ç–µ—Ä–∏–∞–ª–∏–∑–æ–≤–∞–Ω—ã –∫–∞–∫ `view` –∏–ª–∏ `ephemeral`. Python –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è –¥–ª—è —Ä–µ—Å—É—Ä—Å–æ–≤, –æ—Ç–ª–∏—á–Ω—ã—Ö –æ—Ç –º–æ–¥–µ–ª–µ–π (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Ç–µ—Å—Ç–æ–≤ –∏ —Å–Ω–∏–º–∫–æ–≤).

–î–ª—è –∏–Ω–∫—Ä–µ–º–µ–Ω—Ç–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π, –∫–∞–∫ –∏ –¥–ª—è SQL –º–æ–¥–µ–ª–µ–π, –≤–∞–º –Ω—É–∂–Ω–æ —Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å –≤—Ö–æ–¥—è—â–∏–µ —Ç–∞–±–ª–∏—Ü—ã —Ç–æ–ª—å–∫–æ –Ω–∞ –Ω–æ–≤—ã–µ —Å—Ç—Ä–æ–∫–∏ –¥–∞–Ω–Ω—ã—Ö:

<Tabs>

<TabItem value="Snowpark">

<File name='models/my_python_model.py'>

```python
import snowflake.snowpark.functions as F

def model(dbt, session):
    dbt.config(materialized = "incremental")
    df = dbt.ref("upstream_table")

    if dbt.is_incremental:

        # —Ç–æ–ª—å–∫–æ –Ω–æ–≤—ã–µ —Å—Ç—Ä–æ–∫–∏ –ø–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é —Å –º–∞–∫—Å–∏–º—É–º–æ–º –≤ —Ç–µ–∫—É—â–µ–π —Ç–∞–±–ª–∏—Ü–µ
        max_from_this = f"select max(updated_at) from {dbt.this}"
        df = df.filter(df.updated_at >= session.sql(max_from_this).collect()[0][0])

        # –∏–ª–∏ —Ç–æ–ª—å–∫–æ —Å—Ç—Ä–æ–∫–∏ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 3 –¥–Ω—è
        df = df.filter(df.updated_at >= F.dateadd("day", F.lit(-3), F.current_timestamp()))

    ...

    return df
```

</File>

</TabItem>

<TabItem value="BigQuery DataFrames"> 

<File name='models/my_python_model.py'>

```python
import datetime

def model(dbt, session):
  dbt.config(materialized = "incremental")
  bdf = dbt.ref("upstream_table")

  if dbt.is_incremental:

    # only new rows compared to max in current table
    max_from_this = f"select max(updated_at) from {dbt.this}"

    bdf = bdf[bdf['updated_at'] >= bpd.read_gbq(max_from_this).values[0][0]]
    # or only rows from the past 3 days
    bdf = bdf[bdf['updated_at'] >= datetime.date.today() - datetime.timedelta(days=3)]

    ...

  return bdf
```

</File>

</TabItem>

<TabItem value="PySpark">

<File name='models/my_python_model.py'>

```python
import pyspark.sql.functions as F

def model(dbt, session):
    dbt.config(materialized = "incremental")
    df = dbt.ref("upstream_table")

    if dbt.is_incremental:

        # —Ç–æ–ª—å–∫–æ –Ω–æ–≤—ã–µ —Å—Ç—Ä–æ–∫–∏ –ø–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é —Å –º–∞–∫—Å–∏–º—É–º–æ–º –≤ —Ç–µ–∫—É—â–µ–π —Ç–∞–±–ª–∏—Ü–µ
        max_from_this = f"select max(updated_at) from {dbt.this}"
        df = df.filter(df.updated_at >= session.sql(max_from_this).collect()[0][0])

        # –∏–ª–∏ —Ç–æ–ª—å–∫–æ —Å—Ç—Ä–æ–∫–∏ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 3 –¥–Ω—è
        df = df.filter(df.updated_at >= F.date_add(F.current_timestamp(), F.lit(-3)))

    ...

    return df
```

</File>

</TabItem>

</Tabs>

## –°–ø–µ—Ü–∏—Ñ–∏—á–µ—Å–∫–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å Python

### –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–π

–í –¥–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –∫ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—é —Ñ—É–Ω–∫—Ü–∏–∏ `model`, Python –º–æ–¥–µ–ª—å –º–æ–∂–µ—Ç –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –¥—Ä—É–≥–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ –∏–ª–∏ –æ–ø—Ä–µ–¥–µ–ª—è—Ç—å —Å–≤–æ–∏ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–µ. –í–æ—Ç –ø—Ä–∏–º–µ—Ä –Ω–∞ Snowpark, –æ–ø—Ä–µ–¥–µ–ª—è—é—â–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫—É—é —Ñ—É–Ω–∫—Ü–∏—é `add_one`:

<File name='models/my_python_model.py'>

```python
def add_one(x):
    return x + 1

def model(dbt, session):
    dbt.config(materialized="table")
    temps_df = dbt.ref("temperatures")

    # –Ω–µ–º–Ω–æ–≥–æ —Å–æ–≥—Ä–µ–µ–º
    df = temps_df.withColumn("degree_plus_one", add_one(temps_df["degree"]))
    return df
```

</File>

–í –Ω–∞—Å—Ç–æ—è—â–µ–µ –≤—Ä–µ–º—è —Ñ—É–Ω–∫—Ü–∏–∏ Python, –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–µ –≤ –æ–¥–Ω–æ–π –º–æ–¥–µ–ª–∏ dbt, –Ω–µ –º–æ–≥—É—Ç –±—ã—Ç—å –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã –∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω—ã –≤ –¥—Ä—É–≥–∏—Ö –º–æ–¥–µ–ª—è—Ö. –û–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∫ [–ü–æ–≤—Ç–æ—Ä–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞](#code-reuse) –¥–ª—è –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã—Ö —Ä–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞–µ–º—ã—Ö —à–∞–±–ª–æ–Ω–æ–≤.

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞–∫–µ—Ç–æ–≤ PyPI

–í—ã —Ç–∞–∫–∂–µ –º–æ–∂–µ—Ç–µ –æ–ø—Ä–µ–¥–µ–ª—è—Ç—å —Ñ—É–Ω–∫—Ü–∏–∏, –∫–æ—Ç–æ—Ä—ã–µ –∑–∞–≤–∏—Å—è—Ç –æ—Ç —Å—Ç–æ—Ä–æ–Ω–Ω–∏—Ö –ø–∞–∫–µ—Ç–æ–≤, –ø—Ä–∏ —É—Å–ª–æ–≤–∏–∏, —á—Ç–æ —ç—Ç–∏ –ø–∞–∫–µ—Ç—ã —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –∏ –¥–æ—Å—Ç—É–ø–Ω—ã –¥–ª—è Python runtime –Ω–∞ –≤–∞—à–µ–π –ø–ª–∞—Ç—Ñ–æ—Ä–º–µ –¥–∞–Ω–Ω—ã—Ö.

–í —ç—Ç–æ–º –ø—Ä–∏–º–µ—Ä–µ –º—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º –ø–∞–∫–µ—Ç `holidays`, —á—Ç–æ–±—ã –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å, —è–≤–ª—è–µ—Ç—Å—è –ª–∏ –∑–∞–¥–∞–Ω–Ω–∞—è –¥–∞—Ç–∞ –ø—Ä–∞–∑–¥–Ω–∏—á–Ω—ã–º –¥–Ω—ë–º –≤–æ –§—Ä–∞–Ω—Ü–∏–∏. –í –ø—Ä–∏–≤–µ–¥—ë–Ω–Ω–æ–º –Ω–∏–∂–µ –∫–æ–¥–µ –¥–ª—è –ø—Ä–æ—Å—Ç–æ—Ç—ã –∏ –µ–¥–∏–Ω–æ–æ–±—Ä–∞–∑–∏—è –º–µ–∂–¥—É –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞–º–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è API pandas. –¢–æ—á–Ω—ã–π —Å–∏–Ω—Ç–∞–∫—Å–∏—Å, –∞ —Ç–∞–∫–∂–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç—å —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞ –¥–ª—è –º–Ω–æ–≥–æ–Ω–æ–¥–æ–≤–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏, –≤—Å—ë –µ—â—ë –º–æ–≥—É—Ç —Ä–∞–∑–ª–∏—á–∞—Ç—å—Å—è.
<Tabs>

<TabItem value="Snowpark">

<File name='models/my_python_model.py'>

```python
import holidays

def is_holiday(date_col):
    # Chez Jaffle
    french_holidays = holidays.France()
    is_holiday = (date_col in french_holidays)
    return is_holiday

def model(dbt, session):
    dbt.config(
        materialized = "table",
        packages = ["holidays"]
    )

    orders_df = dbt.ref("stg_orders")

    df = orders_df.to_pandas()

    # –ø—Ä–∏–º–µ–Ω—è–µ–º –Ω–∞—à—É —Ñ—É–Ω–∫—Ü–∏—é
    # (—Å—Ç–æ–ª–±—Ü—ã –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –≤ –≤–µ—Ä—Ö–Ω–µ–º —Ä–µ–≥–∏—Å—Ç—Ä–µ –Ω–∞ Snowpark)
    df["IS_HOLIDAY"] = df["ORDER_DATE"].apply(is_holiday)
    df["ORDER_DATE"].dt.tz_localize('UTC') # –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –∏–∑ Number/Long –≤ tz-aware Datetime

    # –≤–æ–∑–≤—Ä–∞—â–∞–µ–º —Ñ–∏–Ω–∞–ª—å–Ω—ã–π –Ω–∞–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö (Pandas DataFrame)
    return df
```

</File>

</TabItem>

<TabItem value="BigQuery DataFrames">

<File name='models/my_python_model.py'>

```python
import holidays

def model(dbt, session):
    dbt.config(submission_method="bigframes")

    data = {
    'id': [0, 1, 2],
    'name': ['Brian Davis', 'Isaac Smith', 'Marie White'],
    'birthday': ['2024-03-14', '2024-01-01', '2024-11-07']
    }
    bdf = bpd.DataFrame(data)
    bdf['birthday'] = bpd.to_datetime(bdf['birthday'])
    bdf['birthday'] = bdf['birthday'].dt.date

    us_holidays = holidays.US(years=2024)

    return bdf[bdf['birthday'].isin(us_holidays)]
```

</File>

</TabItem>

<TabItem value="PySpark">

<File name='models/my_python_model.py'>

```python
import holidays

def is_holiday(date_col):
    # Chez Jaffle
    french_holidays = holidays.France()
    is_holiday = (date_col in french_holidays)
    return is_holiday

def model(dbt, session):
    dbt.config(
        materialized = "table",
        packages = ["holidays"]
    )

    orders_df = dbt.ref("stg_orders")

    df = orders_df.to_pandas_on_spark()  # Spark 3.2+
    # df = orders_df.toPandas() –≤ –±–æ–ª–µ–µ —Ä–∞–Ω–Ω–∏—Ö –≤–µ—Ä—Å–∏—è—Ö

    # –ø—Ä–∏–º–µ–Ω—è–µ–º –Ω–∞—à—É —Ñ—É–Ω–∫—Ü–∏—é
    df["is_holiday"] = df["order_date"].apply(is_holiday)

    # –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –æ–±—Ä–∞—Ç–Ω–æ –≤ PySpark
    df = df.to_spark()               # Spark 3.2+
    # df = session.createDataFrame(df) –≤ –±–æ–ª–µ–µ —Ä–∞–Ω–Ω–∏—Ö –≤–µ—Ä—Å–∏—è—Ö

    # –≤–æ–∑–≤—Ä–∞—â–∞–µ–º —Ñ–∏–Ω–∞–ª—å–Ω—ã–π –Ω–∞–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö (PySpark DataFrame)
    return df
```

</File>

</TabItem>

</Tabs>

#### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–∞–∫–µ—Ç–æ–≤

–ú—ã —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º –≤–∞–º –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—Ç—å –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –ø–∞–∫–µ—Ç—ã –∏ –≤–µ—Ä—Å–∏–∏, —á—Ç–æ–±—ã dbt –º–æ–≥ –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å –∏—Ö –≤ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö –ø—Ä–æ–µ–∫—Ç–∞. –≠—Ç–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Ç—Ä–µ–±—É–µ—Ç—Å—è –¥–ª—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –Ω–∞ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞—Ö. –ï—Å–ª–∏ –≤–∞–º –Ω—É–∂–Ω—ã –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –≤–µ—Ä—Å–∏–∏ –ø–∞–∫–µ—Ç–æ–≤, —É–∫–∞–∂–∏—Ç–µ –∏—Ö.

<File name='models/my_python_model.py'>

```python
def model(dbt, session):
    dbt.config(
        packages = ["numpy==1.23.1", "scikit-learn"]
    )
```

</File>

<File name='models/config.yml'>

```yml

models:
  - name: my_python_model
    config:
      packages:
        - "numpy==1.23.1"
        - scikit-learn
```

</File>

#### –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ (UDF)

–í—ã –º–æ–∂–µ—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä `@udf` –∏–ª–∏ —Ñ—É–Ω–∫—Ü–∏—é `udf`, —á—Ç–æ–±—ã –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å ¬´–∞–Ω–æ–Ω–∏–º–Ω—É—é¬ª —Ñ—É–Ω–∫—Ü–∏—é –∏ –≤—ã–∑–≤–∞—Ç—å –µ—ë –≤–Ω—É—Ç—Ä–∏ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–π DataFrame –≤ –≤–∞—à–µ–π —Ñ—É–Ω–∫—Ü–∏–∏ `model`. –≠—Ç–æ —Ç–∏–ø–∏—á–Ω—ã–π –ø–∞—Ç—Ç–µ—Ä–Ω –¥–ª—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –±–æ–ª–µ–µ —Å–ª–æ–∂–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π –≤ –≤–∏–¥–µ –æ–ø–µ—Ä–∞—Ü–∏–π –Ω–∞–¥ DataFrame, –æ—Å–æ–±–µ–Ω–Ω–æ –≤ —Ç–µ—Ö —Å–ª—É—á–∞—è—Ö, –∫–æ–≥–¥–∞ —ç—Ç–∏–º —Ñ—É–Ω–∫—Ü–∏—è–º —Ç—Ä–µ–±—É—é—Ç—Å—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –∏–∑ —Å—Ç–æ—Ä–æ–Ω–Ω–∏—Ö –ø–∞–∫–µ—Ç–æ–≤.

- [Snowpark Python: Creating UDFs](https://docs.snowflake.com/en/developer-guide/snowpark/python/creating-udfs.html)
- [BigQuery DataFrames UDFs](https://cloud.google.com/bigquery/docs/use-bigquery-dataframes#custom-python-functions)
- [PySpark functions: udf](https://spark.apache.org/docs/latest/api/python/reference/pyspark.sql/api/pyspark.sql.functions.udf.html)

:::tip
You can also define [SQL or Python UDFs](/docs/build/udfs) as first-class resources under `/functions` with a matching `YAML` file. dbt builds them as part of the DAG, and you reference them from SQL using `{{ function('my_udf') }}`. These UDFs are reusable across tools (BI, notebooks, SQL clients) because they live in your warehouse.
:::

<Tabs>

<TabItem value="Snowpark">

<File name='models/my_python_model.py'>

```python
import snowflake.snowpark.types as T
import snowflake.snowpark.functions as F
import numpy

def register_udf_add_random():
    add_random = F.udf(
        # –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å 'lambda' –¥–ª—è –ø—Ä–æ—Å—Ç–æ–≥–æ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–≥–æ –ø–æ–≤–µ–¥–µ–Ω–∏—è
        lambda x: x + numpy.random.normal(),
        return_type=T.FloatType(),
        input_types=[T.FloatType()]
    )
    return add_random

def model(dbt, session):

    dbt.config(
        materialized = "table",
        packages = ["numpy"]
    )

    temps_df = dbt.ref("temperatures")

    add_random = register_udf_add_random()

    # —Å–æ–≥—Ä–µ–µ–º, –∫—Ç–æ –∑–Ω–∞–µ—Ç –Ω–∞ —Å–∫–æ–ª—å–∫–æ
    df = temps_df.withColumn("degree_plus_random", add_random("degree"))
    return df
```

</File>

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** –ò–∑-–∑–∞ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è Snowpark –≤ –Ω–∞—Å—Ç–æ—è—â–µ–µ –≤—Ä–µ–º—è –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å —Å–ª–æ–∂–Ω—ã–µ –∏–º–µ–Ω–æ–≤–∞–Ω–Ω—ã–µ UDF –≤ —Ö—Ä–∞–Ω–∏–º—ã—Ö –ø—Ä–æ—Ü–µ–¥—É—Ä–∞—Ö –∏, —Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ, –≤ Python –º–æ–¥–µ–ª—è—Ö dbt. –ú—ã –ø–ª–∞–Ω–∏—Ä—É–µ–º –¥–æ–±–∞–≤–∏—Ç—å –Ω–∞—Ç–∏–≤–Ω—É—é –ø–æ–¥–¥–µ—Ä–∂–∫—É Python UDF –≤ –∫–∞—á–µ—Å—Ç–≤–µ —Ä–µ—Å—É—Ä—Å–∞ –ø—Ä–æ–µ–∫—Ç–∞/DAG –≤ –±—É–¥—É—â–∏—Ö –≤—ã–ø—É—Å–∫–∞—Ö. –ù–∞ –¥–∞–Ω–Ω—ã–π –º–æ–º–µ–Ω—Ç, –µ—Å–ª–∏ –≤—ã —Ö–æ—Ç–∏—Ç–µ —Å–æ–∑–¥–∞—Ç—å "–≤–µ–∫—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—É—é" Python UDF —á–µ—Ä–µ–∑ Batch API, –º—ã —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º –ª–∏–±–æ:
- –ù–∞–ø–∏—Å–∞—Ç—å [`create function`](https://docs.snowflake.com/en/developer-guide/udf/python/udf-python-batch.html) –≤–Ω—É—Ç—Ä–∏ SQL –º–∞–∫—Ä–æ—Å–∞, —á—Ç–æ–±—ã –∑–∞–ø—É—Å—Ç–∏—Ç—å –∫–∞–∫ hook –∏–ª–∏ run-operation
- [–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∏–∑ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω–æ–≥–æ —Ñ–∞–π–ª–∞](https://docs.snowflake.com/en/developer-guide/snowpark/python/creating-udfs#creating-a-udf-from-a-python-source-file) –≤ –≤–∞—à–µ–º Python –∫–æ–¥–µ –º–æ–¥–µ–ª–∏

</TabItem>

<TabItem value="BigQuery DataFrames"> 

<File name='models/my_python_model.py'>

```python
def model(dbt, session):
    dbt.config(submission_method="bigframes")

    # You can also use @bpd.udf
    @bpd.remote_function(dataset='jialuo_test_us')
    def my_func(x: int) -> int:
        return x * 1100

    data = {"int": [1, 2], "str": ['a', 'b']}
    bdf = bpd.DataFrame(data=data)
    bdf['int'] = bdf['int'].apply(my_func)

    return bdf
```

</File>

</TabItem>

<TabItem value="PySpark">

<File name='models/my_python_model.py'>

```python
import pyspark.sql.types as T
import pyspark.sql.functions as F
import numpy

# –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ '–¥–µ–∫–æ—Ä–∞—Ç–æ—Ä' –¥–ª—è –±–æ–ª–µ–µ —á–∏—Ç–∞–µ–º–æ–≥–æ –∫–æ–¥–∞
@F.udf(returnType=T.DoubleType())
def add_random(x):
    random_number = numpy.random.normal()
    return x + random_number

def model(dbt, session):
    dbt.config(
        materialized = "table",
        packages = ["numpy"]
    )

    temps_df = dbt.ref("temperatures")

    # —Å–æ–≥—Ä–µ–µ–º, –∫—Ç–æ –∑–Ω–∞–µ—Ç –Ω–∞ —Å–∫–æ–ª—å–∫–æ
    df = temps_df.withColumn("degree_plus_random", add_random("degree"))
    return df
```

</File>

</TabItem>

</Tabs>

#### –ü–æ–≤—Ç–æ—Ä–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞

–ß—Ç–æ–±—ã –ø–æ–≤—Ç–æ—Ä–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Python‚Äë—Ñ—É–Ω–∫—Ü–∏—é –≤ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –º–æ–¥–µ–ª—è—Ö dbt, –≤—ã –º–æ–∂–µ—Ç–µ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å [Python UDF](/docs/build/udfs) –≤ –∫–∞—Ç–∞–ª–æ–≥–µ `/functions` –≤–º–µ—Å—Ç–µ —Å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–º YAML‚Äë—Ñ–∞–π–ª–æ–º. –≠—Ç–∏ UDF —Ä–∞–∑–≤–æ—Ä–∞—á–∏–≤–∞—é—Ç—Å—è –≤ –≤–∞—à–µ–º —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –¥–∞–Ω–Ω—ã—Ö –∏ –º–æ–≥—É—Ç –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è —Ä–∞–∑–Ω—ã–º–∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞–º–∏ (BI‚Äë—Å–∏—Å—Ç–µ–º–∞–º–∏, –Ω–æ—É—Ç–±—É–∫–∞–º–∏, SQL‚Äë–∫–ª–∏–µ–Ω—Ç–∞–º–∏).

–í –±—É–¥—É—â–µ–º –º—ã —Ç–∞–∫–∂–µ —Ä–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞–µ–º –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏ **Private Python packages**. –ü–æ–º–∏–º–æ –∏–º–ø–æ—Ä—Ç–∞ –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π –∏–∑ –ø—É–±–ª–∏—á–Ω—ã—Ö –ø–∞–∫–µ—Ç–æ–≤ PyPI, –º–Ω–æ–≥–∏–µ –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã –¥–∞–Ω–Ω—ã—Ö –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç –∑–∞–≥—Ä—É–∑–∫—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö Python‚Äë–∞—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–≤ –∏ –∏—Ö —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—é –≤ –≤–∏–¥–µ –ø–∞–∫–µ—Ç–æ–≤. –ü—Ä–æ—Ü–µ—Å—Å –∑–∞–≥—Ä—É–∑–∫–∏ –æ—Ç–ª–∏—á–∞–µ—Ç—Å—è –æ—Ç –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã –∫ –ø–ª–∞—Ç—Ñ–æ—Ä–º–µ, –Ω–æ —Å–∞–º `import` –≤–∞—à–µ–≥–æ –∫–æ–¥–∞ –≤—ã–≥–ª—è–¥–∏—Ç –æ–¥–∏–Ω–∞–∫–æ–≤–æ.

:::note ‚ùì –í–æ–ø—Ä–æ—Å—ã dbt

- –ö–∞–∫ dbt –º–æ–∂–µ—Ç –ø–æ–º–æ—á—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –∏–ª–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –ø—Ä–∏–≤–∞—Ç–Ω—ã—Ö Python-–∞—Å—Å–µ—Ç–æ–≤? –Ø–≤–ª—è–µ—Ç—Å—è –ª–∏ —ç—Ç–æ –Ω–æ–≤–æ–π —Ñ–æ—Ä–º–æ–π `dbt deps`?
- –ö–∞–∫ dbt –º–æ–∂–µ—Ç –ø–æ–¥–¥–µ—Ä–∂–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –∫–æ—Ç–æ—Ä—ã–µ —Ö–æ—Ç—è—Ç —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏? –ï—Å–ª–∏ –æ–Ω–∏ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã –∫–∞–∫ UDF: ¬´—é–Ω–∏—Ç‚Äë—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ¬ª –ø—Ä—è–º–æ –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö? –ï—Å–ª–∏ —ç—Ç–æ ¬´—á–∏—Å—Ç—ã–µ¬ª —Ñ—É–Ω–∫—Ü–∏–∏ –≤ –ø–∞–∫–µ—Ç–∞—Ö: —Å—Ç–æ–∏—Ç –ª–∏ –ø–æ–æ—â—Ä—è—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `pytest`?

üí¨ –û–±—Å—É–∂–¥–µ–Ω–∏–µ: ["Python –º–æ–¥–µ–ª–∏: –ø–∞–∫–µ—Ç, —Ö—Ä–∞–Ω–µ–Ω–∏–µ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–≤/–æ–±—ä–µ–∫—Ç–æ–≤ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ UDF –≤ dbt"](https://github.com/dbt-labs/dbt-core/discussions/5741)
:::

### API –∏ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å DataFrame

–ó–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–µ –¥–µ—Å—è—Ç–∏–ª–µ—Ç–∏–µ –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ –ª—é–¥–µ–π, –ø–∏—à—É—â–∏—Ö [—Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö](https://www.getdbt.com/analytics-engineering/transformation/) –Ω–∞ Python, –ø—Ä–∏–Ω—è–ª–∏ <Term id="dataframe">DataFrame</Term> –≤ –∫–∞—á–µ—Å—Ç–≤–µ —Å–≤–æ–µ–π –æ–±—â–µ–π –∞–±—Å—Ç—Ä–∞–∫—Ü–∏–∏. dbt —Å–ª–µ–¥—É–µ—Ç —ç—Ç–æ–π –∫–æ–Ω–≤–µ–Ω—Ü–∏–∏, –≤–æ–∑–≤—Ä–∞—â–∞—è `ref()` –∏ `source()` –∫–∞–∫ DataFrame, –∏ –æ–∂–∏–¥–∞–µ—Ç, —á—Ç–æ –≤—Å–µ Python –º–æ–¥–µ–ª–∏ –±—É–¥—É—Ç –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å DataFrame.

DataFrame ‚Äî —ç—Ç–æ –¥–≤—É–º–µ—Ä–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö (—Å—Ç—Ä–æ–∫–∏ –∏ —Å—Ç–æ–ª–±—Ü—ã). –û–Ω –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —É–¥–æ–±–Ω—ã–µ –º–µ—Ç–æ–¥—ã –¥–ª—è –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è —ç—Ç–∏—Ö –¥–∞–Ω–Ω—ã—Ö –∏ —Å–æ–∑–¥–∞–Ω–∏—è –Ω–æ–≤—ã—Ö —Å—Ç–æ–ª–±—Ü–æ–≤ –∏–∑ –≤—ã—á–∏—Å–ª–µ–Ω–∏–π, –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã—Ö –Ω–∞ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö —Å—Ç–æ–ª–±—Ü–∞—Ö. –û–Ω —Ç–∞–∫–∂–µ –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç —É–¥–æ–±–Ω—ã–µ —Å–ø–æ—Å–æ–±—ã –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ–≥–æ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏ –ª–æ–∫–∞–ª—å–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ –∏–ª–∏ –≤ –Ω–æ—É—Ç–±—É–∫–µ.

–ü—Ä–∏–º–µ—Ä–Ω–æ –Ω–∞ —ç—Ç–æ–º —Å–æ–≥–ª–∞—Å–∏–µ –∏ –∑–∞–∫–∞–Ω—á–∏–≤–∞–µ—Ç—Å—è. –°—É—â–µ—Å—Ç–≤—É–µ—Ç –º–Ω–æ–∂–µ—Å—Ç–≤–æ —Ñ—Ä–µ–π–º–≤–æ—Ä–∫–æ–≤ —Å —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–º–∏ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–∞–º–∏ –∏ API –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å DataFrame. –ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ [pandas](https://pandas.pydata.org/docs/) –ø—Ä–µ–¥–ª–æ–∂–∏–ª–∞ –æ–¥–∏–Ω –∏–∑ —Å–∞–º—ã—Ö –ø–µ—Ä–≤—ã—Ö API –¥–ª—è DataFrame, –∏ –µ—ë —Å–∏–Ω—Ç–∞–∫—Å–∏—Å —è–≤–ª—è–µ—Ç—Å—è —Å–∞–º—ã–º —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—ë–Ω–Ω—ã–º –¥–ª—è –∏–∑—É—á–µ–Ω–∏—è —Å—Ä–µ–¥–∏ –Ω–∞—á–∏–Ω–∞—é—â–∏—Ö —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–æ–≤ –ø–æ –¥–∞–Ω–Ω—ã–º. –ë–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ –±–æ–ª–µ–µ –Ω–æ–≤—ã—Ö API DataFrame —Å–æ–≤–º–µ—Å—Ç–∏–º—ã —Å —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–æ–º –≤ —Å—Ç–∏–ª–µ pandas, —Ö–æ—Ç—è –Ω–µ–º–Ω–æ–≥–∏–µ –º–æ–≥—É—Ç –æ–±–µ—Å–ø–µ—á–∏—Ç—å –ø–æ–ª–Ω—É—é –≤–∑–∞–∏–º–Ω—É—é —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å. –≠—Ç–æ —Å–ø—Ä–∞–≤–µ–¥–ª–∏–≤–æ –∏ –¥–ª—è BigQuery DataFrames, Snowpark –∏ PySpark, —É –∫–æ—Ç–æ—Ä—ã—Ö –µ—Å—Ç—å —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–µ API DataFrame.

–ü—Ä–∏ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ Python –º–æ–¥–µ–ª–∏ –≤—ã –±—É–¥–µ—Ç–µ –∑–∞–¥–∞–≤–∞—Ç—å—Å—è —Å–ª–µ–¥—É—é—â–∏–º–∏ –≤–æ–ø—Ä–æ—Å–∞–º–∏:

**–ü–æ—á–µ–º—É pandas?** &mdash; –≠—Ç–æ —Å–∞–º—ã–π —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–Ω—ã–π API –¥–ª—è DataFrame. –û–Ω —É–ø—Ä–æ—â–∞–µ—Ç –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ –≤—ã–±–æ—Ä–æ—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –∏ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫—É —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–π –ª–æ–∫–∞–ª—å–Ω–æ. –í—ã –º–æ–∂–µ—Ç–µ "–ø—Ä–æ–¥–≤–∏–≥–∞—Ç—å" —Å–≤–æ–π –∫–æ–¥ –∫–∞–∫ –µ—Å—Ç—å –≤ –º–æ–¥–µ–ª–∏ dbt –∏ –∑–∞–ø—É—Å–∫–∞—Ç—å –µ–≥–æ –≤ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–µ–Ω–Ω–æ–π —Å—Ä–µ–¥–µ –¥–ª—è –Ω–µ–±–æ–ª—å—à–∏—Ö –Ω–∞–±–æ—Ä–æ–≤ –¥–∞–Ω–Ω—ã—Ö.

**–ü–æ—á–µ–º—É _–Ω–µ_ pandas?** &mdash; –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å. pandas –≤—ã–ø–æ–ª–Ω—è–µ—Ç "–æ–¥–Ω–æ—É–∑–ª–æ–≤—ã–µ" —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–∏, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ –º–æ–≥—É—Ç –≤–æ—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –ø–∞—Ä–∞–ª–ª–µ–ª–∏–∑–º–æ–º –∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–º–∏ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è–º–∏, –ø—Ä–µ–¥–ª–∞–≥–∞–µ–º—ã–º–∏ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–º–∏ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞–º–∏ –¥–∞–Ω–Ω—ã—Ö. –≠—Ç–æ –±—ã—Å—Ç—Ä–æ —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –ø—Ä–æ–±–ª–µ–º–æ–π, –∫–æ–≥–¥–∞ –≤—ã —Ä–∞–±–æ—Ç–∞–µ—Ç–µ —Å –±–æ–ª—å—à–∏–º–∏ –Ω–∞–±–æ—Ä–∞–º–∏ –¥–∞–Ω–Ω—ã—Ö. –ù–µ–∫–æ—Ç–æ—Ä—ã–µ –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã –¥–∞–Ω–Ω—ã—Ö –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –¥–ª—è –∫–æ–¥–∞, –Ω–∞–ø–∏—Å–∞–Ω–Ω–æ–≥–æ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º API DataFrame pandas, –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞—è –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç—å –≤ –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω—ã—Ö —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞—Ö. –ù–∞–ø—Ä–∏–º–µ—Ä, [pandas –Ω–∞ PySpark](https://spark.apache.org/docs/latest/api/python/getting_started/quickstart_ps.html) –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç –ø–æ–¥–¥–µ—Ä–∂–∫—É 95% —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏ pandas, –∏—Å–ø–æ–ª—å–∑—É—è —Ç–æ—Ç –∂–µ API, –ø—Ä–∏ —ç—Ç–æ–º –≤—Å–µ –µ—â–µ –∏—Å–ø–æ–ª—å–∑—É—è –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—É—é –æ–±—Ä–∞–±–æ—Ç–∫—É.

:::note ‚ùì –í–æ–ø—Ä–æ—Å—ã dbt
- –ü—Ä–∏ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ –Ω–æ–≤–æ–π Python –º–æ–¥–µ–ª–∏ dbt, —Å–ª–µ–¥—É–µ—Ç –ª–∏ —Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞—Ç—å —Å–∏–Ω—Ç–∞–∫—Å–∏—Å –≤ —Å—Ç–∏–ª–µ pandas –¥–ª—è –±—ã—Å—Ç—Ä–æ–π –∏—Ç–µ—Ä–∞—Ü–∏–∏, –∞ –∑–∞—Ç–µ–º —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥?
- –ö–∞–∫–∏–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ —Å –æ—Ç–∫—Ä—ã—Ç—ã–º –∏—Å—Ö–æ–¥–Ω—ã–º –∫–æ–¥–æ–º –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—é—Ç —É–±–µ–¥–∏—Ç–µ–ª—å–Ω—ã–µ –∞–±—Å—Ç—Ä–∞–∫—Ü–∏–∏ –¥–ª—è —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –¥–≤–∏–∂–∫–æ–≤ –¥–∞–Ω–Ω—ã—Ö –∏ —Å–ø–µ—Ü–∏—Ñ–∏—á–µ—Å–∫–∏—Ö –¥–ª—è –ø–æ—Å—Ç–∞–≤—â–∏–∫–æ–≤ API?
- –î–æ–ª–∂–µ–Ω –ª–∏ dbt –ø—ã—Ç–∞—Ç—å—Å—è –∏–≥—Ä–∞—Ç—å –¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω—É—é —Ä–æ–ª—å –≤ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∞—Ü–∏–∏ —Å—Ä–µ–¥–∏ –Ω–∏—Ö?

üí¨ –û–±—Å—É–∂–¥–µ–Ω–∏–µ: ["Python –º–æ–¥–µ–ª–∏: –ø—Ä–æ–±–ª–µ–º–∞ pandas (–∏ –≤–æ–∑–º–æ–∂–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ)"](https://github.com/dbt-labs/dbt-core/discussions/5738)
:::

## –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è

Python –º–æ–¥–µ–ª–∏ –∏–º–µ—é—Ç –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏, –∫–æ—Ç–æ—Ä—ã—Ö –Ω–µ—Ç —É SQL –º–æ–¥–µ–ª–µ–π. –£ –Ω–∏—Ö —Ç–∞–∫–∂–µ –µ—Å—Ç—å –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –Ω–µ–¥–æ—Å—Ç–∞—Ç–∫–∏ –ø–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é —Å SQL –º–æ–¥–µ–ª—è–º–∏:

- **–í—Ä–µ–º—è –∏ —Å—Ç–æ–∏–º–æ—Å—Ç—å.** Python –º–æ–¥–µ–ª–∏ —Ä–∞–±–æ—Ç–∞—é—Ç –º–µ–¥–ª–µ–Ω–Ω–µ–µ, —á–µ–º SQL –º–æ–¥–µ–ª–∏, –∏ –æ–±–ª–∞—á–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã, –∫–æ—Ç–æ—Ä—ã–µ –∏—Ö –∑–∞–ø—É—Å–∫–∞—é—Ç, –º–æ–≥—É—Ç –±—ã—Ç—å –¥–æ—Ä–æ–∂–µ. –ó–∞–ø—É—Å–∫ Python —Ç—Ä–µ–±—É–µ—Ç –±–æ–ª–µ–µ –æ–±—â–∏—Ö –≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω—ã—Ö —Ä–µ—Å—É—Ä—Å–æ–≤. –≠—Ç–∏ –≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã –º–æ–≥—É—Ç –∏–Ω–æ–≥–¥–∞ –Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è –Ω–∞ –æ—Ç–¥–µ–ª—å–Ω–æ–π —Å–ª—É–∂–±–µ –∏–ª–∏ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ –æ—Ç –≤–∞—à–∏—Ö SQL –º–æ–¥–µ–ª–µ–π. **–û–¥–Ω–∞–∫–æ:** –ú—ã —Å—á–∏—Ç–∞–µ–º, —á—Ç–æ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ Python –º–æ–¥–µ–ª–µ–π —á–µ—Ä–µ–∑ dbt ‚Äî —Å –µ–¥–∏–Ω–æ–π –ª–∏–Ω–∏–µ–π, —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º –∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–µ–π ‚Äî —Å —á–µ–ª–æ–≤–µ—á–µ—Å–∫–æ–π —Ç–æ—á–∫–∏ –∑—Ä–µ–Ω–∏—è, **–∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ** –±—ã—Å—Ç—Ä–µ–µ –∏ –¥–µ—à–µ–≤–ª–µ. –ü–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é —Å —ç—Ç–∏–º, —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ –æ—Ç–¥–µ–ª—å–Ω–æ–π –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–ª—è –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏–∏ Python —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–π –≤ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–µ–Ω–Ω–æ–π —Å—Ä–µ–¥–µ –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å dbt –∑–∞–Ω–∏–º–∞–µ—Ç –≥–æ—Ä–∞–∑–¥–æ –±–æ–ª—å—à–µ –≤—Ä–µ–º–µ–Ω–∏ –∏ –¥–æ—Ä–æ–∂–µ.
- **–†–∞–∑–ª–∏—á–∏—è –≤ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–µ** –µ—â–µ –±–æ–ª–µ–µ –≤—ã—Ä–∞–∂–µ–Ω—ã. –ó–∞ —ç—Ç–∏ –≥–æ–¥—ã dbt —Å–¥–µ–ª–∞–ª –º–Ω–æ–≥–æ–µ, –∏—Å–ø–æ–ª—å–∑—É—è —à–∞–±–ª–æ–Ω—ã –¥–∏—Å–ø–µ—Ç—á–µ—Ä–∏–∑–∞—Ü–∏–∏ –∏ –ø–∞–∫–µ—Ç—ã, —Ç–∞–∫–∏–µ –∫–∞–∫ `dbt_utils`, —á—Ç–æ–±—ã –∞–±—Å—Ç—Ä–∞–≥–∏—Ä–æ–≤–∞—Ç—å —Ä–∞–∑–ª–∏—á–∏—è –≤ SQL –¥–∏–∞–ª–µ–∫—Ç–∞—Ö —Å—Ä–µ–¥–∏ –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö —Ö—Ä–∞–Ω–∏–ª–∏—â –¥–∞–Ω–Ω—ã—Ö. Python –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç **–≥–æ—Ä–∞–∑–¥–æ** –±–æ–ª–µ–µ —à–∏—Ä–æ–∫–æ–µ –ø–æ–ª–µ –¥–ª—è –∏–≥—Ä—ã. –ï—Å–ª–∏ –µ—Å—Ç—å –ø—è—Ç—å —Å–ø–æ—Å–æ–±–æ–≤ —Å–¥–µ–ª–∞—Ç—å —á—Ç–æ-—Ç–æ –≤ SQL, —Ç–æ –≤ Python –∏—Ö 500, –≤—Å–µ —Å —Ä–∞–∑–ª–∏—á–Ω–æ–π –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å—é –∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∞–º. –≠—Ç–∏ –≤–∞—Ä–∏–∞–Ω—Ç—ã –º–æ–≥—É—Ç –±—ã—Ç—å –æ—à–µ–ª–æ–º–ª—è—é—â–∏–º–∏. –ö–∞–∫ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—â–∏–µ dbt, –º—ã –±—É–¥–µ–º —É—á–∏—Ç—å—Å—è —É –ø–µ—Ä–µ–¥–æ–≤—ã—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤, —Ä–µ—à–∞—é—â–∏—Ö —ç—Ç—É –ø—Ä–æ–±–ª–µ–º—É, –∏ –¥–µ–ª–∏—Ç—å—Å—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è–º–∏ –ø–æ –º–µ—Ä–µ –∏—Ö —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏.
- **–≠—Ç–∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –æ—á–µ–Ω—å –Ω–æ–≤—ã–µ.** –ü–æ –º–µ—Ä–µ —Ç–æ–≥–æ, –∫–∞–∫ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞ –¥–∞–Ω–Ω—ã—Ö —Ä–∞–∑—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç –Ω–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏, –º—ã –æ–∂–∏–¥–∞–µ–º, —á—Ç–æ –æ–Ω–∏ –ø—Ä–µ–¥–ª–æ–∂–∞—Ç –±–æ–ª–µ–µ –¥–µ—à–µ–≤—ã–µ, –±—ã—Å—Ç—Ä—ã–µ –∏ –∏–Ω—Ç—É–∏—Ç–∏–≤–Ω–æ –ø–æ–Ω—è—Ç–Ω—ã–µ –º–µ—Ö–∞–Ω–∏–∑–º—ã –¥–ª—è —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è Python —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–π. **–ú—ã –æ—Å—Ç–∞–≤–ª—è–µ–º –∑–∞ —Å–æ–±–æ–π –ø—Ä–∞–≤–æ –∏–∑–º–µ–Ω–∏—Ç—å –æ—Å–Ω–æ–≤–Ω—É—é —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è Python –º–æ–¥–µ–ª–µ–π –≤ –±—É–¥—É—â–∏—Ö –≤—ã–ø—É—Å–∫–∞—Ö.** –ù–∞—à–∞ –ø—Ä–∏–≤–µ—Ä–∂–µ–Ω–Ω–æ—Å—Ç—å –≤–∞–º –∑–∞–∫–ª—é—á–∞–µ—Ç—Å—è –≤ –∫–æ–¥–µ –≤ –≤–∞—à–∏—Ö —Ñ–∞–π–ª–∞—Ö –º–æ–¥–µ–ª–∏ `.py`, —Å–ª–µ–¥—É—è –¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–º –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—è–º –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è–º, –∫–æ—Ç–æ—Ä—ã–µ –º—ã –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ–º –∑–¥–µ—Å—å.
- **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ø–æ–¥–¥–µ—Ä–∂–∫–∏ `print()`.** –ü–ª–∞—Ç—Ñ–æ—Ä–º–∞ –¥–∞–Ω–Ω—ã—Ö –∑–∞–ø—É—Å–∫–∞–µ—Ç –∏ –∫–æ–º–ø–∏–ª–∏—Ä—É–µ—Ç –≤–∞—à—É Python –º–æ–¥–µ–ª—å –±–µ–∑ –Ω–∞–¥–∑–æ—Ä–∞ dbt. –≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –æ–Ω–∞ –Ω–µ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç –≤—ã–≤–æ–¥ –∫–æ–º–∞–Ω–¥, —Ç–∞–∫–∏—Ö –∫–∞–∫ –≤—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è Python [`print()`](https://docs.python.org/3/library/functions.html#print) –≤ –ª–æ–≥–∞—Ö dbt.

- <Expandable alt_header="–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é print() –≤ Python –º–æ–¥–µ–ª—è—Ö">

    –°–ª–µ–¥—É—é—â–µ–µ –æ–±—ä—è—Å–Ω—è–µ—Ç –¥—Ä—É–≥–∏–µ –º–µ—Ç–æ–¥—ã, –∫–æ—Ç–æ—Ä—ã–µ –≤—ã –º–æ–∂–µ—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏, —Ç–∞–∫–∏–µ –∫–∞–∫ –∑–∞–ø–∏—Å—å —Å–æ–æ–±—â–µ–Ω–∏–π –≤ —Å—Ç–æ–ª–±–µ—Ü dataframe:
    
    - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ª–æ–≥–æ–≤ –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã: –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ª–æ–≥–∏ –≤–∞—à–µ–π –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏ –≤–∞—à–∏—Ö Python –º–æ–¥–µ–ª–µ–π.
    - –í–æ–∑–≤—Ä–∞—Ç –ª–æ–≥–æ–≤ –∫–∞–∫ dataframe: –°–æ–∑–¥–∞–π—Ç–µ dataframe, —Å–æ–¥–µ—Ä–∂–∞—â–∏–π –≤–∞—à–∏ –ª–æ–≥–∏, –∏ –ø–æ—Å—Ç—Ä–æ–π—Ç–µ –µ–≥–æ –≤ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ.
    - –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –ª–æ–∫–∞–ª—å–Ω–æ —Å DuckDB: –¢–µ—Å—Ç–∏—Ä—É–π—Ç–µ –∏ –æ—Ç–ª–∞–∂–∏–≤–∞–π—Ç–µ –≤–∞—à–∏ –º–æ–¥–µ–ª–∏ –ª–æ–∫–∞–ª—å–Ω–æ, –∏—Å–ø–æ–ª—å–∑—É—è DuckDB, –ø–µ—Ä–µ–¥ –∏—Ö —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ–º.
    
    –í–æ—Ç –ø—Ä–∏–º–µ—Ä –æ—Ç–ª–∞–¥–∫–∏ –≤ Python –º–æ–¥–µ–ª–∏:

    ```python
    def model(dbt, session):
        dbt.config(
            materialized = "table"
        )
    
        df = dbt.ref("my_source_table").df()
    
        # –û–¥–∏–Ω –∏–∑ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ –æ—Ç–ª–∞–¥–∫–∏: –∑–∞–ø–∏—Å—å —Å–æ–æ–±—â–µ–Ω–∏–π –≤–æ –≤—Ä–µ–º–µ–Ω–Ω—ã–π —Å—Ç–æ–ª–±–µ—Ü —Ç–∞–±–ª–∏—Ü—ã
        # –ü–ª—é—Å—ã: –≤–∏–¥–∏–º–æ—Å—Ç—å
        # –ú–∏–Ω—É—Å—ã: –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–µ—Ç, –µ—Å–ª–∏ —Ç–∞–±–ª–∏—Ü–∞ –Ω–µ —Å—Ç—Ä–æ–∏—Ç—Å—è –ø–æ –∫–∞–∫–æ–π-—Ç–æ –ø—Ä–∏—á–∏–Ω–µ
        msg = "—á—Ç–æ-—Ç–æ"
        df["debugging"] = f"–ú–æ–µ –æ—Ç–ª–∞–¥–æ—á–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –∑–¥–µ—Å—å: {msg}"
    
        return df
    ```
    </Expandable>

–í –∫–∞—á–µ—Å—Ç–≤–µ –æ–±—â–µ–≥–æ –ø—Ä–∞–≤–∏–ª–∞: –µ—Å–ª–∏ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –º–æ–∂–Ω–æ –æ–¥–∏–Ω–∞–∫–æ–≤–æ —Ö–æ—Ä–æ—à–æ –Ω–∞–ø–∏—Å–∞—Ç—å –∫–∞–∫ –Ω–∞ SQL, —Ç–∞–∫ –∏ –Ω–∞ Python, –º—ã —Å—á–∏—Ç–∞–µ–º, —á—Ç–æ —Ö–æ—Ä–æ—à–æ –Ω–∞–ø–∏—Å–∞–Ω–Ω—ã–π SQL –ø—Ä–µ–¥–ø–æ—á—Ç–∏—Ç–µ–ª—å–Ω–µ–µ. –û–Ω –±–æ–ª–µ–µ –¥–æ—Å—Ç—É–ø–µ–Ω –¥–ª—è –±–æ–ª—å—à–µ–≥–æ —á–∏—Å–ª–∞ –∫–æ–ª–ª–µ–≥, –∏ –Ω–∞ –Ω—ë–º –ø—Ä–æ—â–µ –ø–∏—Å–∞—Ç—å –∫–æ–¥, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω—ã–º –ø—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å –±–æ–ª—å—à–∏–º–∏ –æ–±—ä—ë–º–∞–º–∏ –¥–∞–Ω–Ω—ã—Ö. –ï—Å–ª–∏ –∂–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ _–Ω–µ–ª—å–∑—è_ –Ω–∞–ø–∏—Å–∞—Ç—å –Ω–∞ SQL, –∏–ª–∏ –≤ —Å–∏—Ç—É–∞—Ü–∏–∏, –∫–æ–≥–¥–∞ –¥–µ—Å—è—Ç—å —Å—Ç—Ä–æ–∫ —ç–ª–µ–≥–∞–Ω—Ç–Ω–æ–≥–æ –∏ —Ö–æ—Ä–æ—à–æ –ø—Ä–æ–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ Python –º–æ–≥—É—Ç –∑–∞–º–µ–Ω–∏—Ç—å —Ç—ã—Å—è—á—É —Å—Ç—Ä–æ–∫ —Ç—Ä—É–¥–Ω–æ—á–∏—Ç–∞–µ–º–æ–≥–æ Jinja-SQL, —Å—Ç–æ–∏—Ç –≤—ã–±—Ä–∞—Ç—å Python.
