---
title: –ö–∞–∫ –º—ã —Å—Ç–∏–ª–∏–∑—É–µ–º –Ω–∞—à Python
id: 3-how-we-style-our-python
---

## –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã Python

- üêç Python –∏–º–µ–µ—Ç –±–æ–ª–µ–µ –∑—Ä–µ–ª—É—é –∏ –Ω–∞–¥–µ–∂–Ω—É—é —ç–∫–æ—Å–∏—Å—Ç–µ–º—É –¥–ª—è —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∏ –ª–∏–Ω—Ç–∏–Ω–≥–∞ (—á—Ç–æ –æ–±–ª–µ–≥—á–µ–Ω–æ —Ç–µ–º —Ñ–∞–∫—Ç–æ–º, —á—Ç–æ —É –Ω–µ–≥–æ –Ω–µ—Ç –º–∏–ª–ª–∏–æ–Ω–∞ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –¥–∏–∞–ª–µ–∫—Ç–æ–≤). –ú—ã —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —ç—Ç–∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –¥–ª—è —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∏ –ª–∏–Ω—Ç–∏–Ω–≥–∞ –≤–∞—à–µ–≥–æ –∫–æ–¥–∞ –≤ –ø—Ä–µ–¥–ø–æ—á–∏—Ç–∞–µ–º–æ–º –≤–∞–º–∏ —Å—Ç–∏–ª–µ.

- üõ†Ô∏è –ù–∞—à–∏ —Ç–µ–∫—É—â–∏–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:

  - [black](https://pypi.org/project/black/) –¥–ª—è —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
  - [ruff](https://pypi.org/project/ruff/) –¥–ª—è –ª–∏–Ω—Ç–∏–Ω–≥–∞

  :::info
  ‚òÅÔ∏è dbt Cloud –ø–æ—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è —Å [–≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–º —Ñ–æ—Ä–º–∞—Ç–µ—Ä–æ–º black](https://docs.getdbt.com/docs/cloud/dbt-cloud-ide/lint-format), –∫–æ—Ç–æ—Ä—ã–π –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã–ø–æ–ª–Ω—è–µ—Ç –ª–∏–Ω—Ç–∏–Ω–≥ –∏ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–∞—à–µ–≥–æ SQL. –í–∞–º –Ω–µ –Ω—É–∂–Ω–æ –Ω–∏—á–µ–≥–æ –∑–∞–≥—Ä—É–∂–∞—Ç—å –∏–ª–∏ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—Ç—å, –ø—Ä–æ—Å—Ç–æ –Ω–∞–∂–º–∏—Ç–µ `Format` –≤ –º–æ–¥–µ–ª–∏ Python, –∏ –≤—ã –≥–æ—Ç–æ–≤—ã –∫ —Ä–∞–±–æ—Ç–µ!
  :::

## –ü—Ä–∏–º–µ—Ä Python

```python
import pandas as pd


def model(dbt, session):
    # —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –ø—Ä–æ–¥–æ–ª–∂–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –≤—Ä–µ–º–µ–Ω–∏, —Å—á–∏—Ç–∞–µ–º–æ–≥–æ –æ—Ç—Ç–æ–∫–æ–º
    pd.Timedelta(days=2)

    dbt.config(enabled=False, materialized="table", packages=["pandas==1.5.2"])

    orders_relation = dbt.ref("stg_orders")

    # –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –æ—Ç–Ω–æ—à–µ–Ω–∏–µ DuckDB Python –≤ DataFrame pandas
    orders_df = orders_relation.df()

    orders_df.sort_values(by="ordered_at", inplace=True)
    orders_df["previous_order_at"] = orders_df.groupby("customer_id")[
        "ordered_at"
    ].shift(1)
    orders_df["next_order_at"] = orders_df.groupby("customer_id")["ordered_at"].shift(
        -1
    )
    return orders_df
```