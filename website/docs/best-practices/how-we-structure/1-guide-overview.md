---
title: "Как мы структурируем наши проекты dbt"
id: 1-guide-overview
description: Узнайте, как мы структурируем наши проекты dbt.
displayText: Как мы структурируем наши проекты dbt
hoverSnippet: Узнайте, как мы структурируем наши проекты dbt.
---

## Почему структура важна?

Аналитическая инженерия, по своей сути, направлена на то, чтобы помочь группам людей совместно принимать более обоснованные решения в масштабах. У нас есть [ограниченные ресурсы для принятия решений](https://en.wikipedia.org/wiki/Decision_fatigue). Мы также, как кооперативный социальный вид, полагаемся на [системы и шаблоны для оптимизации сотрудничества](https://en.wikipedia.org/wiki/Pattern_language) с другими. Эта комбинация черт означает, что для совместных проектов крайне важно установить последовательные и понятные нормы, чтобы ограниченные ресурсы вашей команды для принятия решений могли быть потрачены на уникальные и сложные проблемы, а не на то, где должны находиться папки или как называть файлы.

Создание отличного проекта dbt — это по своей сути совместное начинание, объединяющее знания в области предметной области из каждого отдела для отображения целей и нарративов всей компании. Поэтому особенно важно установить широкий и глубокий набор шаблонов, чтобы как можно больше людей могли использовать свои конкретные знания положительным образом и чтобы проект оставался доступным и поддерживаемым по мере роста вашей организации.

Известно, что Стив Джобс [носил один и тот же наряд каждый день](https://images.squarespace-cdn.com/content/v1/5453c539e4b02ab5398ffc8f/1580381503218-E56FQDNFL1P4OBLQWHWW/ke17ZwdGBToddI8pDm48kJKedFpub2aPqa33K4gNUDwUqsxRUqqbr1mOJYKfIPR7LoDQ9mXPOjoJoqy81S2I8N_N4V1vUb5AoIIIbLZhVYxCRW4BPu10St3TBAUQYVKcxb5ZTIyC_D49_DDQq2Sj8YVGtM7O1i4h5tvKa2lazN4nGUQWMS_WcPM-ztWbVr-c/steve_jobs_outfit.jpg), чтобы уменьшить усталость от принятия решений. Вы можете рассматривать этот гид аналогично, как черный водолазку и кроссовки New Balance для проекта dbt вашей компании. Мощный наряд проекта dbt, или, точнее, его структура, состоит не из ткани, а из файлов, папок, соглашений о наименовании и программных шаблонов. То, как вы маркируете вещи, группируете их, разделяете или объединяете — система, которую вы используете для организации [преобразований данных](https://www.getdbt.com/analytics-engineering/transformation/) в вашем проекте dbt — это и есть структура вашего проекта.

Этот гид — всего лишь отправная точка. Вы можете решить, что предпочитаете Беркентоки или фиолетовый худи для вашего проекта вместо минимализма в стиле Джобса. Это нормально. Важно, чтобы вы обдумали причины этих изменений в вашей организации, явно заявили о них в тщательной, доступной форме для всех участников и, прежде всего, _сохраняли последовательность_.

Однако одно основополагающее правило, которое применимо ко всем проектам dbt, — это необходимость установить согласованную арку, перемещающую данные от _source-conformed_ к _business-conformed_. Данные, соответствующие источнику, формируются внешними системами, находящимися вне нашего контроля, в то время как данные, соответствующие бизнесу, формируются потребностями, концепциями и определениями, которые мы создаем. Независимо от того, какие шаблоны или соглашения вы определяете в своем проекте, этот процесс остается основной целью слоя преобразования и dbt как вашего инструмента в этом процессе. Этот гид является обновлением знакового поста в области аналитической инженерии [с тем же названием](https://discourse.getdbt.com/t/how-we-structure-our-dbt-projects/355) от великой Клэр Кэрролл, и хотя некоторые детали изменились со временем (как и ожидалось в том посте), эта основополагающая траектория остается верной. В дальнейшем этот гид будет итеративно обновляться по мере появления новых инструментов, расширяющих наши взгляды, новых опытов, уточняющих наше видение, и новых голосов, укрепляющих наши перспективы, но всегда в служении этой цели.

### Цели обучения

У этого гида три основные цели:

- Полностью охватить наши самые актуальные рекомендации по структуре типичных проектов dbt
- Проиллюстрировать эти рекомендации с помощью исчерпывающих примеров
- На каждом этапе объяснить _почему_ мы рекомендуем тот или иной подход, чтобы вы могли решить, когда и где отклоняться от этих рекомендаций, чтобы лучше соответствовать уникальным потребностям вашей организации

Вы должны уйти от этого гида с более глубоким пониманием того, как компоненты проекта dbt сочетаются друг с другом, так что цели и принципы аналитической инженерии станут более ясными и интуитивными.

Подходя к нашей структуре целенаправленно, мы получим лучшее понимание основополагающих идеалов, таких как перемещение наших данных от широкого спектра более узких моделей, соответствующих источнику, которые предоставляют наши системы, к более узкому набору более широких, богатых моделей, соответствующих бизнесу, которые мы создаем. По мере продвижения по этой арке мы поймем, как укладка наших преобразований в оптимизированные, модульные слои позволяет нам применять каждое преобразование только в одном месте. С дисциплинированным подходом к файлам, папкам и материализациям, которые составляют нашу структуру, мы обнаружим, что можем создавать четкие истории не только через наши данные, но и через нашу кодовую базу и артефакты, которые она генерирует в нашем хранилище.

Наша надежда заключается в том, что, углубив ваше понимание связей между этими шаблонами и принципами, из которых они исходят, вы сможете адаптировать их под свои конкретные нужды и создать индивидуальную документацию для вашей команды.

:::info Пример проекта.
Этот гид проходит через наши рекомендации, используя очень простой проект dbt — аналогичный тому, который использовался в руководстве по началу работы и многих других демонстрациях — от вымышленной компании под названием Jaffle Shop. Вы можете прочитать больше о [jaffles](https://en.wiktionary.org/wiki/jaffle), если хотите (они _реальны_), но этот контекст не важен для понимания структуры. Мы призываем вас следовать за нами, пробовать, вносить изменения и делать заметки о том, что работает или не работает для вас на этом пути.
:::

Мы получим более глубокое понимание нашего проекта, по мере того как будем двигаться по гиду, но на данный момент нам просто нужно знать, что Jaffle Shop — это ресторан, продающий jaffles, который имеет два основных источника данных:

- Реплика нашей транзакционной базы данных, называемой `jaffle_shop`, с основными сущностями, такими как заказы и клиенты.
- Синхронизированные данные от [Stripe](https://stripe.com/), которые мы используем для обработки платежей.

### Обзор структуры гида

Мы пройдем через наши темы в том же порядке, в котором наши данные будут проходить через преобразование:

1. Углубимся в то, как мы структурируем файлы, папки и модели для наших трех основных слоев в директории `models`, которые строятся друг на друге:
   1. **Staging** — создание наших атомов, наших начальных модульных строительных блоков, из исходных данных
   2. **Intermediate** — укладка слоев логики с четкими и конкретными целями для подготовки наших моделей staging к объединению в сущности, которые мы хотим
   3. **Marts** — объединение наших модульных частей в широкое, богатое представление о сущностях, которые важны для нашей организации
2. Исследуем, как эти слои вписываются в остальную часть проекта:
   1. Обзор общей структуры в полном объеме
   2. Углубленное изучение конфигурации YAML
   3. Обсуждение того, как использовать другие папки в проекте dbt: `tests`, `seeds` и `analyses`

Ниже приведено полное дерево файлов проекта, с которым мы будем работать. Не беспокойтесь, если это выглядит как много информации, чтобы воспринять сразу — это просто для того, чтобы дать вам полное представление о том, к чему мы стремимся. Мы сосредоточимся на каждом из разделов по одному, когда будем разбирать структуру проекта.

```shell
jaffle_shop
├── README.md
├── analyses
├── seeds
│   └── employees.csv
├── dbt_project.yml
├── macros
│   └── cents_to_dollars.sql
├── models
│   ├── intermediate
│   │   └── finance
│   │       ├── _int_finance__models.yml
│   │       └── int_payments_pivoted_to_orders.sql
│   ├── marts
│   │   ├── finance
│   │   │   ├── _finance__models.yml
│   │   │   ├── orders.sql
│   │   │   └── payments.sql
│   │   └── marketing
│   │       ├── _marketing__models.yml
│   │       └── customers.sql
│   ├── staging
│   │   ├── jaffle_shop
│   │   │   ├── _jaffle_shop__docs.md
│   │   │   ├── _jaffle_shop__models.yml
│   │   │   ├── _jaffle_shop__sources.yml
│   │   │   ├── base
│   │   │   │   ├── base_jaffle_shop__customers.sql
│   │   │   │   └── base_jaffle_shop__deleted_customers.sql
│   │   │   ├── stg_jaffle_shop__customers.sql
│   │   │   └── stg_jaffle_shop__orders.sql
│   │   └── stripe
│   │       ├── _stripe__models.yml
│   │       ├── _stripe__sources.yml
│   │       └── stg_stripe__payments.sql
│   └── utilities
│       └── all_dates.sql
├── packages.yml
├── snapshots
└── tests
    └── assert_positive_value_for_total_amount.sql
```