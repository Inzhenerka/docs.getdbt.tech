---
id: self-join
title: SQL –°–ê–ú–û–°–û–ï–î–ò–ù–ï–ù–ò–Ø
description: –°–∞–º–æ—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –ø–æ–∑–≤–æ–ª—è–µ—Ç —Å–æ–µ–¥–∏–Ω–∏—Ç—å –Ω–∞–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö —Å —Å–∞–º–∏–º —Å–æ–±–æ–π. –û–±—ã—á–Ω—ã–π —Å–ª—É—á–∞–π –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Å–∞–º–æ—Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è ‚Äî —ç—Ç–æ –∫–æ–≥–¥–∞ —Ç–∞–±–ª–∏—Ü–∞ —Å–æ–¥–µ—Ä–∂–∏—Ç –≤–Ω–µ—à–Ω–∏–π –∫–ª—é—á –∫ –ø–µ—Ä–≤–∏—á–Ω–æ–º—É –∫–ª—é—á—É —Ç–æ–π –∂–µ —Ç–∞–±–ª–∏—Ü—ã.
slug: /sql-reference/self-join
---

<head>
    <title>–†–∞–±–æ—Ç–∞ —Å —Å–∞–º–æ—Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è–º–∏ –≤ SQL</title>
</head>

–°–∞–º–æ–µ –ø—Ä–æ—Å—Ç–æ–µ –∏ –≤ —Ç–æ –∂–µ –≤—Ä–µ–º—è —Å–∞–º–æ–µ –∑–∞–ø—É—Ç–∞–Ω–Ω–æ–µ –∏–∑ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π: —Å–∞–º–æ—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ. –ü—Ä–æ—â–µ –≥–æ–≤–æ—Ä—è, —Å–∞–º–æ—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –ø–æ–∑–≤–æ–ª—è–µ—Ç —Å–æ–µ–¥–∏–Ω–∏—Ç—å –Ω–∞–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö —Å —Å–∞–º–∏–º —Å–æ–±–æ–π.

–ï—Å–ª–∏ –≤—ã –Ω–æ–≤–∏—á–æ–∫ –≤ —Ä–∞–±–æ—Ç–µ —Å –¥–∞–Ω–Ω—ã–º–∏ –∏–ª–∏ SQL, –≤—ã –º–æ–∂–µ—Ç–µ –∑–∞–¥–∞—Ç—å—Å—è –≤–æ–ø—Ä–æ—Å–æ–º: –∑–∞—á–µ–º —ç—Ç–æ –Ω—É–∂–Ω–æ? –†–∞–∑–≤–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è –Ω–µ –¥–æ–ª–∂–Ω—ã –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç—å –º–µ–∂–¥—É –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ *—Ä–∞–∑–Ω—ã–º–∏* —Å—É—â–Ω–æ—Å—Ç—è–º–∏?

–ë–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π, –∫–æ—Ç–æ—Ä—ã–µ –≤—ã —É–≤–∏–¥–∏—Ç–µ –≤ –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–æ–π —Ä–∞–±–æ—Ç–µ –∏ –ø—Ä–æ–µ–∫—Ç–∞—Ö dbt, –≤–µ—Ä–æ—è—Ç–Ω–æ, –±—É–¥—É—Ç –ª–µ–≤—ã–º–∏ –∏ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–º–∏ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è–º–∏, –Ω–æ –≤—Ä–µ–º—è –æ—Ç –≤—Ä–µ–º–µ–Ω–∏, –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–æ–≥–æ, –∫–∞–∫ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∞ –∏—Å—Ö–æ–¥–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞, –≤–∞–º –º–æ–∂–µ—Ç –ø–æ–Ω–∞–¥–æ–±–∏—Ç—å—Å—è —Å–∞–º–æ—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ. –û–¥–∏–Ω –∏–∑ —Å–∞–º—ã—Ö —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–Ω—ã—Ö —Å–ª—É—á–∞–µ–≤ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Å–∞–º–æ—Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è ‚Äî —ç—Ç–æ –∫–æ–≥–¥–∞ —Ç–∞–±–ª–∏—Ü–∞ —Å–æ–¥–µ—Ä–∂–∏—Ç –≤–Ω–µ—à–Ω–∏–π –∫–ª—é—á –∫ <Term id="primary-key" /> —Ç–æ–π –∂–µ —Ç–∞–±–ª–∏—Ü—ã.

–ù–µ –ø–µ—Ä–µ–∂–∏–≤–∞–π—Ç–µ, –µ—Å–ª–∏ —ç—Ç–æ –Ω–∏—á–µ–≥–æ –Ω–µ –ø—Ä–æ—è—Å–Ω–∏–ª–æ ‚Äî –ø–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ —ç—Ç—É —Å—Ç—Ä–∞–Ω–∏—Ü—É, —á—Ç–æ–±—ã –ª—É—á—à–µ –ø–æ–Ω—è—Ç—å, –∫–∞–∫ –∏ –≥–¥–µ –≤—ã –º–æ–∂–µ—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–∞–º–æ—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –≤ —Å–≤–æ–µ–π –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–æ–π –∏–Ω–∂–µ–Ω–µ—Ä–Ω–æ–π —Ä–∞–±–æ—Ç–µ.

## –ö–∞–∫ —Å–æ–∑–¥–∞—Ç—å —Å–∞–º–æ—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ

–ó–¥–µ—Å—å –Ω–µ—Ç –∑–∞–±–∞–≤–Ω—ã—Ö –¥–∏–∞–≥—Ä–∞–º–º –í–µ–Ω–Ω–∞ ‚Äî –Ω–∞ —Å–∞–º–æ–º –¥–µ–ª–µ, –¥–ª—è —Å–∞–º–æ—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π –Ω–µ—Ç —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ–≥–æ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–∞. –ß—Ç–æ–±—ã —Å–æ–∑–¥–∞—Ç—å —Å–∞–º–æ—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ, –≤—ã –±—É–¥–µ—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ–±—ã—á–Ω—ã–π —Å–∏–Ω—Ç–∞–∫—Å–∏—Å —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è, –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω–æ–µ –æ—Ç–ª–∏—á–∏–µ –≤ —Ç–æ–º, —á—Ç–æ –æ–±—ä–µ–∫—Ç—ã —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è *–æ–¥–∏–Ω–∞–∫–æ–≤—ã*:

```
select
	<fields>
from <table_1> as t1
[<join_type>] join <table_2> as t2
on t1.id = t2.id
```

–ü–æ—Å–∫–æ–ª—å–∫—É –≤—ã –º–æ–∂–µ—Ç–µ –≤—ã–±—Ä–∞—Ç—å —Ç–∏–ø —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è –¥–ª—è —Å–∞–º–æ—Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è, –≤—ã –º–æ–∂–µ—Ç–µ —É–∫–∞–∑–∞—Ç—å, —Ö–æ—Ç–∏—Ç–µ –ª–∏ –≤—ã –≤—ã–ø–æ–ª–Ω–∏—Ç—å [–ª–µ–≤–æ–µ](/sql-reference/left-join), [–≤–Ω–µ—à–Ω–µ–µ](/sql-reference/outer-join), [–≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–µ](/sql-reference/inner-join), [–ø–µ—Ä–µ–∫—Ä–µ—Å—Ç–Ω–æ–µ](/sql-reference/cross-join) –∏–ª–∏ [–ø—Ä–∞–≤–æ–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ](/sql-reference/right-join) –≤ –æ–ø–µ—Ä–∞—Ç–æ—Ä–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è.

### –ü—Ä–∏–º–µ—Ä SQL —Å–∞–º–æ—Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è

–ü—Ä–µ–¥–ø–æ–ª–æ–∂–∏–º, —É –Ω–∞—Å –µ—Å—Ç—å —Ç–∞–±–ª–∏—Ü–∞ `products`, –∫–æ—Ç–æ—Ä–∞—è –≤—ã–≥–ª—è–¥–∏—Ç —Å–ª–µ–¥—É—é—â–∏–º –æ–±—Ä–∞–∑–æ–º, –≥–¥–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –∫–∞–∫ –ø–µ—Ä–≤–∏—á–Ω—ã–π –∫–ª—é—á (`sku_id`), —Ç–∞–∫ –∏ –≤–Ω–µ—à–Ω–∏–π –∫–ª—é—á (`parent_id`) –∫ —ç—Ç–æ–º—É –ø–µ—Ä–≤–∏—á–Ω–æ–º—É –∫–ª—é—á—É:

| **sku_id** | **sku_name** | **parent_id** |
|:---:|:---:|:---:|
| 1 | Lilieth Bed | 4 |
| 2 | Holloway Desk | 3 |
| 3 | Basic Desk | null |
| 4 | Basic Bed | null |

–ò —ç—Ç–æ—Ç –∑–∞–ø—Ä–æ—Å, –∏—Å–ø–æ–ª—å–∑—É—é—â–∏–π —Å–∞–º–æ—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –¥–ª—è –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è `parent_name` –∫ sku:

```sql
select
   products.sku_id,
   products.sku_name,
   products.parent_id,
   parents.sku_name as parent_name
from {{ ref('products') }} as products
left join {{ ref('products') }} as parents
on products.parent_id = parents.sku_id
```

–≠—Ç–æ—Ç –∑–∞–ø—Ä–æ—Å, –∏—Å–ø–æ–ª—å–∑—É—é—â–∏–π —Å–∞–º–æ—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ, –¥–æ–±–∞–≤–ª—è–µ—Ç `parent_name` –∫ sku, —É –∫–æ—Ç–æ—Ä—ã—Ö –µ—Å—Ç—å –Ω–µ–Ω—É–ª–µ–≤—ã–µ `parent_ids`:

| sku_id | sku_name | parent_id | parent_name |
|:---:|:---:|:---:|:---:|
| 1 | Lilieth Bed | 4 | Basic Bed |
| 2 | Holloway Desk | 3 | Basic Bed |
| 3 | Basic Desk | null | null |
| 4 | Basic Bed | null | null |

## –°–ª—É—á–∞–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è SQL —Å–∞–º–æ—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π

–û–ø—è—Ç—å –∂–µ, —Å–∞–º–æ—Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è, –≤–µ—Ä–æ—è—Ç–Ω–æ, —Ä–µ–¥–∫–∏ –≤ –≤–∞—à–µ–º –ø—Ä–æ–µ–∫—Ç–µ dbt –∏ —á–∞—â–µ –≤—Å–µ–≥–æ –±—É–¥—É—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –≤ —Ç–∞–±–ª–∏—Ü–∞—Ö, –∫–æ—Ç–æ—Ä—ã–µ —Å–æ–¥–µ—Ä–∂–∞—Ç –∏–µ—Ä–∞—Ä—Ö–∏—á–µ—Å–∫—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É, –Ω–∞–ø—Ä–∏–º–µ—Ä, —Å–æ—Å—Ç–æ—è—â–∏—Ö –∏–∑ —Å—Ç–æ–ª–±—Ü–∞, –∫–æ—Ç–æ—Ä—ã–π —è–≤–ª—è–µ—Ç—Å—è –≤–Ω–µ—à–Ω–∏–º –∫–ª—é—á–æ–º –∫ –ø–µ—Ä–≤–∏—á–Ω–æ–º—É –∫–ª—é—á—É —Ç–æ–π –∂–µ —Ç–∞–±–ª–∏—Ü—ã. –ï—Å–ª–∏ —É –≤–∞—Å –µ—Å—Ç—å —Å–ª—É—á–∞–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Å–∞–º–æ—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π, —Ç–∞–∫–∏–µ –∫–∞–∫ –≤ –ø—Ä–∏–≤–µ–¥–µ–Ω–Ω–æ–º –≤—ã—à–µ –ø—Ä–∏–º–µ—Ä–µ, –≤—ã –æ–±—ã—á–Ω–æ –∑–∞—Ö–æ—Ç–∏—Ç–µ –≤—ã–ø–æ–ª–Ω–∏—Ç—å —ç—Ç–æ —Å–∞–º–æ—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –Ω–∞ —Ä–∞–Ω–Ω–∏—Ö —ç—Ç–∞–ø–∞—Ö –≤ –≤–∞—à–µ–º <Term id="dag" />, –Ω–∞–ø—Ä–∏–º–µ—Ä, –≤ [—Å—Ç–∞–¥–∏–∏](/best-practices/how-we-structure/2-staging) –∏–ª–∏ [–ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω–æ–π](/best-practices/how-we-structure/3-intermediate) –º–æ–¥–µ–ª–∏; –µ—Å–ª–∏ –≤–∞—à–∞ —Å—ã—Ä–∞—è, –Ω–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ –±—É–¥–µ—Ç –Ω—É–∂–¥–∞—Ç—å—Å—è –≤ –¥–æ—Å—Ç—É–ø–µ –¥–∞–ª—å—à–µ –ø–æ –ø–æ—Ç–æ–∫—É –±–µ–∑ —Å–∞–º–æ—Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è, —ç—Ç–æ —Å–∞–º–æ—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –¥–æ–ª–∂–Ω–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç—å –≤ –º–æ–¥—É–ª—å–Ω–æ–π –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω–æ–π –º–æ–¥–µ–ª–∏.

–í—ã —Ç–∞–∫–∂–µ –º–æ–∂–µ—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–∞–º–æ—Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –¥–µ–∫–∞—Ä—Ç–æ–≤–∞ –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è (—Ç–∞–∫–∂–µ –∏–∑–≤–µ—Å—Ç–Ω–æ–≥–æ –∫–∞–∫ –ø–µ—Ä–µ–∫—Ä–µ—Å—Ç–Ω–æ–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ) —Ç–∞–±–ª–∏—Ü—ã —Å —Å–∞–º–æ–π —Å–æ–±–æ–π. –û–ø—è—Ç—å –∂–µ, —ç—Ç–æ —Ä–µ–¥–∫–∏–µ —Å–ª—É—á–∞–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è, –Ω–æ –æ–Ω–∏ –≤—Å–µ –∂–µ –¥–æ—Å—Ç—É–ø–Ω—ã, –µ—Å–ª–∏ –≤–∞–º —ç—Ç–æ –Ω—É–∂–Ω–æ üòâ