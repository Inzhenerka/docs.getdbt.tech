---
id: inner-join
title: SQL ВНУТРЕННИЕ СОЕДИНЕНИЯ
description: Внутреннее соединение между двумя объектами базы данных возвращает все строки, у которых совпадают ключи соединения; любые ключи, которые не совпадают, исключаются из результата запроса.
slug: /sql-reference/inner-join
---

<head>
    <title>Работа с внутренними соединениями в SQL</title>
</head>

Самое простое и удобное из SQL-соединений: скромное внутреннее соединение. Как и предполагает его название, внутреннее соединение между двумя объектами базы данных возвращает все строки, у которых совпадают ключи соединения; любые ключи, которые не совпадают, исключаются из результата запроса.

## Как создать внутреннее соединение

Как и для всех соединений, вам нужны некоторые объекты базы данных (то есть <Term id="table">таблицы</Term>/<Term id="view">представления</Term>), ключи для соединения и [оператор select](/sql-reference/select) для выполнения внутреннего соединения:

```
select
    <fields>
from <table_1> as t1
inner join <table_2> as t2
on t1.id = t2.id 
```

В приведенном выше примере используется только одно поле из каждой таблицы для соединения их вместе; если вы соединяете два объекта базы данных, которые требуют нескольких полей, вы можете использовать операторы AND/OR, а еще лучше — <Term id="surrogate-key">суррогатные ключи</Term>. Вы также можете добавить [WHERE](/sql-reference/where), [GROUP BY](/sql-reference/group-by), [ORDER BY](/sql-reference/order-by), [HAVING](/sql-reference/having) и другие операторы после ваших соединений для создания фильтрации, сортировки и выполнения агрегирования.

Как и в любом запросе, вы можете выполнять столько соединений, сколько хотите, в одном запросе. Общий совет: старайтесь поддерживать модели данных <Term id="dry">модульными</Term>, регулярно проводя <Term id="dag" /> аудиты. Если вы соединяете определенные таблицы выше по потоку, нужны ли эти отдельные таблицы снова ниже по потоку? Если ваш запрос включает несколько соединений и сложную логику и предназначен для конечных пользователей бизнеса, убедитесь, что вы используете таблицы или [инкрементные материализации](https://docs.getdbt.com/docs/build/incremental-models).

### Пример SQL внутреннего соединения

Таблица A `car_type`

| user_id | car_type |
|:---:|:---:|
| 1 | van |
| 2 | sedan |
| 3 | truck |

Таблица B `car_color`

| user_id | car_color |
|:---:|:---:|
| 1 | red |
| 3 | green |
| 4 | yellow |

```sql
select
   car_type.user_id as user_id,
   car_type.car_type as type,
   car_color.car_color as color
from {{ ref('car_type') }} as car_type
inner join {{ ref('car_color') }} as car_color
on car_type.user_id = car_color.user_id
```

Этот простой запрос вернет все строки, у которых одинаковый `user_id` в обеих таблицах A и B:

| user_id | type | color |
|:---:|:---:|:---:|
| 1 | van | red |
| 3 | truck | green |

Поскольку в Таблице A нет `user_id` = 4 и в Таблице B нет `user_id` = 2, строки с id 2 и 4 (из любой таблицы) исключаются из результатов запроса внутреннего соединения.

## Сценарии использования SQL внутреннего соединения

Существует, вероятно, бесчисленное множество сценариев, когда вам нужно будет выполнить внутреннее соединение нескольких таблиц — возможно, у вас есть хорошо структурированные таблицы с одинаковыми <Term id="primary-key">первичными ключами</Term>, которые на самом деле должны быть одной более крупной и широкой таблицей, или вы соединяете две таблицы и не хотите, чтобы в них были пустые или отсутствующие значения столбцов, если бы вы использовали левое или правое соединение — это все зависит от ваших исходных данных и конечных сценариев использования. В тех случаях, когда внутренние соединения не должны использоваться, это [модели промежуточной обработки](/best-practices/how-we-structure/2-staging), которые используются для очистки и подготовки сырых исходных данных для аналитических нужд. Любые соединения в ваших проектах dbt должны происходить ниже по потоку в [промежуточных](/best-practices/how-we-structure/3-intermediate) и [маркетинговых моделях](/best-practices/how-we-structure/4-marts), чтобы улучшить модульность и чистоту DAG.