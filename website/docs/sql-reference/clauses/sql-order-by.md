---
id: order-by
title: SQL ORDER BY
description: Прочитайте это руководство, чтобы узнать о SQL операторе ORDER BY в dbt.
slug: /sql-reference/order-by
---

<head>
    <title>Работа с оператором SQL ORDER BY</title>
</head>

Оператор ORDER BY позволяет вам указать порядок строк в результате запроса. На практике вы используете оператор ORDER BY, чтобы указать, по какому полю(ям) вы хотите отсортировать данные и в каком порядке (по возрастанию или убыванию). Это полезно при проведении разовых анализов и для создания соответствующих значений столбцов для разделенных строк в оконных функциях.

## Как использовать оператор SQL ORDER BY

Операторы ORDER BY имеют множество применений в аналитической работе, но чаще всего их используют для:
- Сортировки результата запроса или подзапроса по столбцу или группе столбцов
- Соответствующей сортировки подмножества строк в оконной функции

Чтобы использовать оператор ORDER BY в запросе или модели, используйте следующий синтаксис:

```sql
select
	column_1,
	column_2
from source_table
order by <field(s)> <asc/desc> -- следует после операторов FROM, WHERE и GROUP BY
```
Вы можете отсортировать результат запроса по нескольким столбцам, указав их имена или номера в операторе select (например, `order by column_2 == order by 2`). Вы также можете указать тип сортировки (по возрастанию или убыванию), чтобы получить желаемый порядок строк.

Давайте рассмотрим практический пример использования ORDER BY.

### Пример ORDER BY

```sql
select
	date_trunc('month', order_date) as order_month,
	round(avg(amount)) as avg_order_amount
from {{ ref('orders') }}
group by 1
order by 1 desc
```

Этот запрос, использующий таблицу `orders` из [Jaffle Shop](https://github.com/dbt-labs/jaffle_shop), вернет округленную сумму заказов за каждый месяц заказа в порядке убывания:

| order_month | avg_order_amount |
|:---:|:---:|
| 2018-04-01 | 17 |
| 2018-03-01 | 18 |
| 2018-02-01 | 15 |
| 2018-01-01 | 17 |

## Синтаксис SQL ORDER BY в Snowflake, Databricks, BigQuery и Redshift

Поскольку оператор ORDER BY является основополагающим в SQL, все хранилища данных, включая Snowflake, Databricks, Google BigQuery и Amazon Redshift, поддерживают возможность добавления операторов ORDER BY в запросы и оконные функции.

## Сценарии использования ORDER BY

Чаще всего оператор ORDER BY используется в аналитической работе для:
- Анализа данных как для первоначального изучения сырых источников данных, так и для разовых запросов к [набору данных mart](/best-practices/how-we-structure/4-marts)
- Определения топ-5/10/50/100 наборов данных при использовании в паре с [LIMIT](/sql-reference/limit)
- (Для Snowflake) Оптимизации производительности больших инкрементальных моделей, которые используют как `cluster_by` [конфигурацию](https://docs.getdbt.com/reference/resource-configs/snowflake-configs#using-cluster_by), так и оператор ORDER BY
- Контроля порядка разделов оконных функций (например, `row_number() over (partition by user_id order by updated_at)`)

Это не исчерпывающий список того, где ваша команда может использовать оператор ORDER BY в ваших моделях dbt, разовых запросах и логике BI-инструментов, но он содержит некоторые распространенные сценарии, с которыми сталкиваются аналитические инженеры в повседневной работе.