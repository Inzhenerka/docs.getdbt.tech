---
title: "Ошибки: целевой снимок не является таблицей снимков"
description: "Отладка: целевой снимок не является таблицей снимков"
sidebar_label: "Целевой снимок не является таблицей снимков"
id: snapshot-target-is-not-a-snapshot-table
---

Если вы видите следующую ошибку при выполнении команды снимка:

> Целевой снимок не является таблицей снимков (отсутствуют `dbt_scd_id`, `dbt_valid_from`, `dbt_valid_to`)

Убедитесь, что вы случайно не настроили свой снимок так, чтобы он вел себя как материализация таблицы, установив его конфигурацию `materialized` в значение `table`. До версии dbt 1.4 было возможно создать снимок таким образом:

```sql
{% snapshot snappy %}
  {{ config(materialized = 'table', ...) }}
  ...
{% endsnapshot %}
```

dbt обрабатывает снимки как таблицы (выдавая команды `create or replace table ...`) **тихо**, вместо того чтобы фактически создавать снимки данных (SCD2 через команды `insert` / `merge`). При обновлении до версий dbt 1.4 и выше, dbt теперь выдает ошибку разбора (вместо тихого обращения со снимками как с таблицами), которая гласит:

```
Снимок должен иметь значение materialized 'snapshot'
```

Это говорит вам о том, что необходимо изменить конфигурацию `materialized` на `snapshot`. Но когда вы вносите это изменение, вы можете столкнуться с сообщением об ошибке, в котором говорится, что отсутствуют определенные поля, такие как `dbt_scd_id`. Эта ошибка возникает потому, что ранее, когда dbt обрабатывал снимки как таблицы, он не включал необходимые [мета-поля снимка](/docs/build/snapshots#snapshot-meta-fields) в вашу целевую таблицу. Поскольку эти мета-поля не существуют, dbt правильно определяет, что вы пытаетесь создать снимок в таблице, которая на самом деле не является снимком.

Когда это происходит, вам нужно начать с нуля — заново создать снимок ваших исходных данных, как если бы это было в первый раз, удалив ваш "снимок", который не является настоящей таблицей снимков. Затем dbt snapshot создаст новый снимок и вставит мета-поля снимка, как и ожидалось.